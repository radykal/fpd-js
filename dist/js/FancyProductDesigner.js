/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={106:()=>{var t;fabric.Canvas.prototype.historyProcessing=!0,fabric.Canvas.prototype.initialize=(t=fabric.Canvas.prototype.initialize,function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._historyInit(),this}),fabric.Canvas.prototype.dispose=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._historyDispose(),this}}(fabric.Canvas.prototype.dispose),fabric.Canvas.prototype._historyNext=function(){let t={version:fabric.version,objects:this.getElementsJSON(!1,!1)};return t.objects.forEach((t=>{t.curved&&delete t.path})),JSON.stringify(t)},fabric.Canvas.prototype._historyEvents=function(){return{elementAdd:this.historySaveAction,elementRemove:this.historySaveAction,"object:modified":this.historySaveAction}},fabric.Canvas.prototype._historyInit=function(){this.historyUndo=[],this.historyRedo=[],this.historyNextState=this._historyNext(),this.on(this._historyEvents())},fabric.Canvas.prototype._historyDispose=function(){this.off(this._historyEvents())},fabric.Canvas.prototype.historySaveAction=function(){if(this.historyProcessing)return;const t=this.historyNextState;this.isCustomized=this.initialElementsLoaded,this.historyUndo.push(t),this.historyNextState=this._historyNext(),this.fire("history:append",{json:t})},fabric.Canvas.prototype.undo=function(t){this.historyProcessing=!0,this.deselectElement();const e=this.historyUndo.pop();e?(this.historyRedo.push(this._historyNext()),this.historyNextState=e,this._loadHistory(e,"history:undo",t)):this.historyProcessing=!1},fabric.Canvas.prototype.redo=function(t){this.historyProcessing=!0,this.deselectElement();const e=this.historyRedo.pop();e?(this.historyUndo.push(this._historyNext()),this.historyNextState=e,this._loadHistory(e,"history:redo",t)):this.historyProcessing=!1},fabric.Canvas.prototype._loadHistory=function(t,e,i){"string"==typeof t&&(t=JSON.parse(t)),this.clear(),this.addElements(t.objects,(()=>{this.fire(e),this.historyProcessing=!1,i&&"function"==typeof i&&i()}))},fabric.Canvas.prototype.clearHistory=function(){this.historyUndo=[],this.historyRedo=[],this.fire("history:clear")},fabric.Canvas.prototype.onHistory=function(){this.historyProcessing=!1,this.historySaveAction()},fabric.Canvas.prototype.offHistory=function(){this.historyProcessing=!0}},653:()=>{function t(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function e(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function i(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var n=new WeakSet,s=new WeakSet;class r extends HTMLElement{constructor(){super(),t(this,s),t(this,n),e(this,"min",0),e(this,"max",10),e(this,"value",0),e(this,"step",1),e(this,"inputElem",null)}connectedCallback(){this.inputElem=document.createElement("input"),this.inputElem.type="range",this.inputElem.value=this.getAttribute("value"),this.inputElem.min=this.getAttribute("min"),this.inputElem.max=this.getAttribute("max"),this.inputElem.step=this.getAttribute("step"),this.append(this.inputElem),this.inputElem.addEventListener("input",i(this,n,a).bind(this)),i(this,s,o).call(this)}static get observedAttributes(){return["value","step","min","max"]}attributeChangedCallback(t,e,n){this.inputElem&&(this.inputElem[t]=n,i(this,s,o).call(this))}}function a(t){i(this,s,o).call(this),this.onInput&&this.onInput(t);const e=new CustomEvent("onInput",{detail:Number(this.inputElem.value)});this.dispatchEvent(e)}function o(){this.inputElem.style.setProperty("--value",this.inputElem.value),this.inputElem.style.setProperty("--min",this.inputElem.min),this.inputElem.style.setProperty("--max",this.inputElem.max)}customElements.define("fpd-range-slider",r)},148:function(t){!function(e,i,n){"use strict";t.exports=function(t){var e="$areaSortable",i="rect",n="scroll",s="style",r="margin",a="padding",o="left",l="right",c="width",h="top",d="bottom",u="height",f="nextElementSibling",p="previousElementSibling",g="scrollTop",m="scrollLeft",v=1,b=2,y=v+b,x=Math,w=String,C=parseInt,S=Object.prototype.hasOwnProperty,T=Object.prototype.toString,E=/^\s+|\s+$/g,A=/mousedown|pointerdown/,I=w.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(E,"")},O=null;function k(t,e){return 0>t?-1:0<t?1:e||0}function M(t){return"function"==typeof t}function P(t){return"[object String]"===T.call(t)}function _(){var t=!1,e={};try{Object.defineProperty(e,"passive",{get:function(){return t=!0,!1}}),window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){t=!1}return t}function D(t,e,i,n){null==O&&(O=_()),t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i,O?n:"object"==typeof n?!!n.capture:!!n)}function L(t,e,i,n){null==O&&(O=_()),t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener(e,i,O?n:"object"==typeof n?!!n.capture:!!n)}function B(t,e){return t.classList?t.classList.contains(e):-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function j(t,e){t.classList?t.classList.add(e):B(t,e)||(t.className=""===t.className?e:t.className+" "+e)}function F(t,e){t.classList?t.classList.remove(e):t.className=I((" "+t.className+" ").replace(" "+e+" "," "))}function R(t,e){return 0!==t[e]||(t[e]=1,1===t[e]&&(t[e]=0,!0))}function N(t){return(M(window.getComputedStyle)?window.getComputedStyle(t,null):t.currentStyle)||{}}function H(t,e,i){return t.elementsFromPoint(e,i)}function z(t,e){return e.reduce((function(e,i){return e[i]=t[s].getPropertyValue(i),e}),{})}function W(t,i,n){n=n||t[e][s],i.forEach((function(e){S.call(n,e)&&""!==n[e]?t[s][e]=n[e]:t[s].removeProperty(e)}))}function V(t,i,n){if(0<i){t[e]&&t[e].animation&&t[e].animation.stop();var r="transform "+w(i)+"ms",a="translate3d(0,0,0)",l=null,c=function i(){l&&clearTimeout(l),l=null,t[e]&&t[e].animation&&i===t[e].animation.stop&&(t[e].animation=null),t[s].transform===a&&t[s].transition===r&&(t[s].transition="none",t[s].transform="none")};t[s].transition="none",t[s].transform="translate3d("+w(-(n[o]||0))+"px,"+w(-(n[h]||0))+"px,0)",function(t){t.offsetWidth}(t),t[s].transform=a,t[s].transition=r,l=setTimeout(c,i),t[e].animation={stop:c}}return t}function U(t,n,s,r,a){var o=t[e].r,l=n[e][i];return x.max(0,x.min(1,x.max(0,x.min(o[r]+o[a],l[r]-s[r]+l[a])-x.max(o[r],l[r]-s[r]))/x.min(o[a],l[a])))}function Y(t,n,s,r,a){var l,d,f=t[e].r,p=n[e][i];return l=x.max(0,x.min(f[o]+f[c],p[o]-s[o]+p[c])-x.max(f[o],p[o]-s[o])),d=x.max(0,x.min(f[h]+f[u],p[h]-s[h]+p[u])-x.max(f[h],p[h]-s[h])),x.max(0,x.min(1,l*d/(x.min(f[c],p[c])*x.min(f[u],p[u]))))}function G(t,S){var T,E,I,O,_,G,q,X,Z,J,Q,K,$,tt,et,it,nt,st,rt,at,ot,lt,ct,ht,dt,ut,ft,pt,gt=!1,mt=!1,vt=!1,bt=!1,yt=null,xt=null,wt=!1,Ct=b===S?c:u,St=b===S?o:h,Tt=o===St?l:d,Et=function(){T=null,E=null,I=null,O=null,_=null,G=null,Z=null,J=null,Q=null,q=null,X=null,pt=null,dt=!1,ht=0},At=function(){vt&&(xt&&(clearInterval(xt),xt=null),bt?(L(pt,"touchmove",_t,!1),L(pt,"touchend",Lt,!1),L(pt,"touchcancel",Lt,!1)):(L(pt,"mousemove",_t,!1),L(pt,"mouseup",Lt,!1)),yt&&(clearInterval(yt),yt=null),T&&T.parentNode&&(T.parentNode.removeChild(T),T[e]=null),F(Q,t.options.activeArea||"dnd-sortable-area"),W(Q,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"],Q[e].style),O&&F(O,t.options.closestItem||"dnd-sortable-closest"),F(E,t.options.activeItem||"dnd-sortable-dragged"),q.forEach((function(t){W(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),t[e]=null})),Q[e]=null,J&&(J[e]=null),vt=!1)},It=function(i,n,s){0>s?(_===n&&(_=i),G===i&&(G=T[p]),Q.insertBefore(i,n)):0<s&&(_===i&&(_=i[f]),n[f]?Q.insertBefore(i,n[f]):(Q.appendChild(i),G=i)),i[e].index=n[e].index,Q.insertBefore(T,i),M(t.options.onChange)&&t.options.onChange(i)};ut=y===S?function(t,g,m,v){var b,y,C,S=g;if(wt){if(0>m){for(C=t[f],It(t,g,m),t[e].prev.line=t[e].line,t[e].prev[h]=t[e][i][h],t[e].prev[o]=t[e][i][o],t[e].line=g[e].line,t[e][i][h]=g[e][i][h],t[e][i][o]=g[e][i][o],T[s][h]=w(t[e][i][h]-Q[e][i][h]+Q[e][n][h])+"px",T[s][o]=w(t[e][i][o]-Q[e][i][o]+Q[e][n][o])+"px";(y=g[f])&&y!==C;)g[e].animation&&g[e].animation.stop(),g[e].index++,g[e].prev.line=g[e].line,g[e].prev[h]=g[e][i][h],g[e].prev[o]=g[e][i][o],g[e].line=y[e].line,g[e][i][h]=y[e][i][h],g[e][i][o]=y[e][i][o],g[s][h]=w(g[e][i][h]-Q[e][i][h]+Q[e][n][h]-g[e][r][h])+"px",g[s][o]=w(g[e][i][o]-Q[e][i][o]+Q[e][n][o]-g[e][r][o])+"px",g=y;g[e].animation&&g[e].animation.stop(),g[e].index++,g[e].prev.line=g[e].line,g[e].prev[h]=g[e][i][h],g[e].prev[o]=g[e][i][o],g[e].line=t[e].prev.line,g[e][i][h]=t[e].prev[h],g[e][i][o]=t[e].prev[o],g[s][h]=w(g[e][i][h]-Q[e][i][h]+Q[e][n][h]-g[e][r][h])+"px",g[s][o]=w(g[e][i][o]-Q[e][i][o]+Q[e][n][o]-g[e][r][o])+"px"}else if(0<m){C=t[f],It(t,g,m),g=C,(y=t)[e].prev.line=y[e].line,y[e].prev[h]=y[e][i][h],y[e].prev[o]=y[e][i][o];do{g[e].animation&&g[e].animation.stop(),g[e].index--,g[e].prev.line=g[e].line,g[e].prev[h]=g[e][i][h],g[e].prev[o]=g[e][i][o],g[e].line=y[e].prev.line,g[e][i][h]=y[e].prev[h],g[e][i][o]=y[e].prev[o],g[s][h]=w(g[e][i][h]-Q[e][i][h]+Q[e][n][h]-g[e][r][h])+"px",g[s][o]=w(g[e][i][o]-Q[e][i][o]+Q[e][n][o]-g[e][r][o])+"px",y=g,g=g[f]}while(g&&g!==T);t[e].line=y[e].prev.line,t[e][i][h]=y[e].prev[h],t[e][i][o]=y[e].prev[o],T[s][h]=w(t[e][i][h]-Q[e][i][h]+Q[e][n][h])+"px",T[s][o]=w(t[e][i][o]-Q[e][i][o]+Q[e][n][o])+"px"}V(S,v,{top:S[e][i][h]-S[e].prev[h],left:S[e][i][o]-S[e].prev[o]})}else 0>m?(y=T[p],C=g[p]||g,It(t,g,m)):0<m&&(y=t[f],C=T[p]||t[f],It(t,g,m)),function(t,i,n,s){for(t=t[0>n?f:p];t;){if(t!==s&&(t[e].index+=0>n?1:-1),t===i)return;t=t[0>n?f:p]}}(t,y,m,T),function(t,o,l,c,h,d,u,p,g){for(var m,v=0;t;)t!==h&&(t[e]&&t[e].animation&&t[e].animation.stop(),m=t[e][r][u]+t[e][i][p]+t[e][r][g],0<v&&l[e][a][u]+v+m+l[e][a][g]>l[e][i][p]&&(o++,v=0),t[e].line=o,t[e].prev[u]=t[e][i][u],t[e][i][u]=l[e][i][u]-l[e][n][u]+l[e][a][u]+v+t[e][r][u],(t===c?h:t)[s][u]=w(t[e][i][u]-l[e][i][u]+l[e][n][u]-(t===c?0:t[e][r][u]))+"px",v+=m),t=t[f]}(C=function(t,i){for(var n;(n=t[p])&&n[e]&&n[e].line>=i;)t=n;return t}(C,b=C[e].line),b,Q,t,T,0,o,c,l),function(t,a,o,l,c,h,d,u,p){for(var g,m,v,b=t,y=t[e].line,C=0;t;)t!==c&&(g=t[e].line,v=t[e][r][d]+t[e][i][u]+t[e][r][p],g===y?C=x.max(C,v):(a[g]=a[y]+C,y=g,C=v)),t=t[f];for(0<C&&(a[y+1]=a[y]+C),t=b;t;)t!==c&&(m=a[g=t[e].line],t[e].prev[d]=t[e][i][d],"bottom"===t[e].$.verticalAlign?t[e][i][d]=o[e][i][d]-o[e][n][d]+a[g+1]-t[e][i][u]-t[e][r][p]:t[e][i][d]=o[e][i][d]-o[e][n][d]+m+t[e][r][d],(t===l?c:t)[s][d]=w(t[e][i][d]-(t===l?0:t[e][r][d])-o[e][i][d]+o[e][n][d])+"px"),t=t[f]}(C,X,Q,t,T,0,h,u,d),V(S,v,{top:S[e][i][h]-S[e].prev[h],left:S[e][i][o]-S[e].prev[o]})}:function(t,a,o,l){var c,h,d,u=a,p=0,g=0;if(0>o){for(h=t[f],It(t,a,o),t[e].prev[St]=t[e][i][St],g=t[e][r][St]-a[e][r][St],t[e][i][St]=a[e][i][St]+g,T[s][St]=w(t[e][i][St]-Q[e][i][St]+Q[e][n][St])+"px",p=t[e][i][Ct]-a[e][i][Ct],g+=t[e][r][Tt]-a[e][r][Tt];(c=a[f])&&c!==h;)a[e].animation&&a[e].animation.stop(),a[e].index++,a[e].prev[St]=a[e][i][St],g+=a[e][r][St]-c[e][r][St],a[e][i][St]=c[e][i][St]+p+g,g+=a[e][r][Tt]-c[e][r][Tt],a[s][St]=w(a[e][i][St]-Q[e][i][St]+Q[e][n][St]-a[e][r][St])+"px",p+=a[e][i][Ct]-c[e][i][Ct],a=c;a[e].animation&&a[e].animation.stop(),a[e].index++,a[e].prev[St]=a[e][i][St],a[e][i][St]=t[e].prev[St]+p+g-t[e][r][St]+a[e][r][St],a[s][St]=w(a[e][i][St]-Q[e][i][St]+Q[e][n][St]-a[e][r][St])+"px"}else if(0<o){h=t[f],It(t,a,o),a=h,g=0,p=0,(c=t)[e].prev[St]=c[e][i][St];do{a[e].animation&&a[e].animation.stop(),a[e].index--,a[e].prev[St]=a[e][i][St],g+=a[e][r][St]-c[e][r][St],a[e][i][St]=c[e].prev[St]+p+g,a[s][St]=w(a[e][i][St]-Q[e][i][St]+Q[e][n][St]-a[e][r][St])+"px",p+=-(c[e][i][Ct]-a[e][i][Ct]),g+=a[e][r][Tt]-c[e][r][Tt],c=a,a=a[f]}while(a&&a!==T);t[e][i][St]=c[e].prev[St]+p+g-c[e][r][St]+t[e][r][St],T[s][St]=w(t[e][i][St]-Q[e][i][St]+Q[e][n][St])+"px"}(d={})[St]=u[e][i][St]-u[e].prev[St],V(u,l,d)},ft=y===S?Y:U;var Ot,kt,Mt,Pt=function(f){mt&&!vt&&t.options.container&&(A.test(f.type)&&0!==f.button||(Et(),(I=f.target)&&B(I,t.options.handle||"dnd-sortable-handle")&&(E=function(t,e){if(t.closest)return t.closest("."+e);for(;t;){if(B(t,e))return t;t=t.parentNode}}(I,t.options.item||"dnd-sortable-item"))?!(Q=E.parentNode)||P(t.options.container)&&Q.id!==t.options.container||!P(t.options.container)&&Q!==t.options.container?Et():(M(t.options.onStart)&&t.options.onStart(E),!M(t.options.itemFilter)||(E=t.options.itemFilter(E))?(vt=!0,pt=E.ownerDocument||document,f.preventDefault&&f.preventDefault(),f.stopPropagation&&f.stopPropagation(),f.stopImmediatePropagation&&f.stopImmediatePropagation(),bt=f.touches&&f.touches.length,function(){var f=0,p=0,y=o,A=c,I=l,O=(Q.tagName||"").toLowerCase();if(Z=function(t){return t.scrollingElement||t.documentElement||t.body}(pt),J=null,t.options.autoscroll)for(J=Q;J&&!(Z===J||b!==S&&J.scrollHeight>J.clientHeight&&R(J,g)||v!==S&&J.scrollWidth>J.clientWidth&&R(J,m));)J=J.parentNode;Q[e]={rect:Q.getBoundingClientRect(),scroll:{top:Q[g]||0,left:Q[m]||0,width:Q.scrollWidth,height:Q.scrollHeight,top0:Q[g]||0,left0:Q[m]||0},$:N(Q),style:z(Q,["width","height","max-width","max-height","box-sizing","padding-left","padding-top","padding-right","padding-bottom"])},Q[e][a]={left:C(Q[e].$.paddingLeft)||0,right:C(Q[e].$.paddingRight)||0},J&&J!==Q&&(J[e]={rect:J.getBoundingClientRect(),scroll:{top:J[g]||0,left:J[m]||0,width:J.scrollWidth,height:J.scrollHeight,top0:J[g]||0,left0:J[m]||0}}),(q=[].map.call(Q.children,(function(t,n){var s,l=t.getBoundingClientRect(),d=N(t);return t[e]={index:n,line:0,prev:{},rect:{top:l[h],left:l[o],width:l[c],height:l[u]},r:{top:l[h],left:l[o],width:l[c],height:l[u]},margin:{top:C(d.marginTop)||0,right:C(d.marginRight)||0,bottom:C(d.marginBottom)||0,left:C(d.marginLeft)||0},$:d,style:z(t,["position","box-sizing","overflow","top","left","width","height","transform","transition"]),animation:null},s=t[e][r][y]+t[e][i][A]+t[e][r][I],0<p&&Q[e][a][y]+p+s+Q[e][a][I]>Q[e][i][A]&&(f++,p=0),t[e].line=f,p+=s,t}))).length&&(_=q[0],G=q[q.length-1]),y=h,A=u,I=d,X=new Array(q.length),q.forEach((function(t){var s=t[e].line,a=t[e][i][y]-t[e][r][y]-Q[e][i][y]+Q[e][n][y];X[s]=null==X[s]?a:x.min(a,X[s])})),j(Q,t.options.activeArea||"dnd-sortable-area"),Q[s].boxSizing="border-box",Q[s][c]=w(Q[e][i][c])+"px",Q[s][u]=w(Q[e][i][u])+"px",Q[s].maxWidth=w(Q[e][i][c])+"px",Q[s].maxHeight=w(Q[e][i][u])+"px",E.draggable=!1,j(E,t.options.activeItem||"dnd-sortable-dragged"),wt=!0,q.forEach((function(t){var a=q[0];t[s].position="absolute",t[s].boxSizing="border-box",t[s].overflow="hidden",t[s][h]=w(t[e][i][h]-Q[e][i][h]+Q[e][n][h]-t[e][r][h])+"px",t[s][o]=w(t[e][i][o]-Q[e][i][o]+Q[e][n][o]-t[e][r][o])+"px",t[s][c]=w(t[e][i][c])+"px",t[s][u]=w(t[e][i][u])+"px",t[e][i][c]===a[e][i][c]&&t[e][i][u]===a[e][i][u]&&t[e][r][h]===a[e][r][h]&&t[e][r][d]===a[e][r][d]&&t[e][r][o]===a[e][r][o]&&t[e][r][l]===a[e][r][l]||(wt=!1)})),j(T=pt.createElement("ul"===O||"ol"===O?"li":"tr"===O?"td":"tbody"===O||"thead"===O||"tfoot"===O||"table"===O?"tr":"span"),t.options.placeholder||"dnd-sortable-placeholder"),T[s].position="absolute",T[s].display="block",T[s].boxSizing="border-box",T[s].margin="0",Q===J&&(Q[s].paddingLeft=w(Q[e][n][c]-Q[e][i][c])+"px",Q[s].paddingTop=w(Q[e][n][u]-Q[e][i][u])+"px",Q[s].paddingRight="0px",Q[s].paddingBottom="0px",Q[m]=Q[e][n][o],Q[g]=Q[e][n][h]),bt?(D(pt,"touchmove",_t,!1),D(pt,"touchend",Lt,!1),D(pt,"touchcancel",Lt,!1)):(D(pt,"mousemove",_t,!1),D(pt,"mouseup",Lt,!1)),yt=setInterval(Dt,60)}(),at=tt=bt?f.touches[0].clientX:f.clientX,ot=et=bt?f.touches[0].clientY:f.clientY,K=tt,$=et,it=0,nt=0,st=0,rt=0,Q.insertBefore(T,E),T[s][c]=w(E[e][i][c])+"px",T[s][u]=w(E[e][i][u])+"px",T[s][h]=w(E[e][i][h]-Q[e][i][h]+Q[e][n][h])+"px",T[s][o]=w(E[e][i][o]-Q[e][i][o]+Q[e][n][o])+"px",b!==S&&(E[s][h]=w(et-$+E[e][i][h]-Q[e][i][h]+Q[e][n][h]-E[e][r][h])+"px"),v!==S&&(E[s][o]=w(tt-K+E[e][i][o]-Q[e][i][o]+Q[e][n][o]-E[e][r][o])+"px")):Et()):Et()))},_t=(Ot=function(t){at=bt?t.touches[0].clientX:t.clientX,ot=bt?t.touches[0].clientY:t.clientY},kt=60,Mt=!1,function(){Mt||(Ot.apply(this,arguments),Mt=!0,setTimeout((function(){Mt=!1}),kt))}),Dt=function(){var a,f,p,C,A,I,M,P,D,L,B,R,N,z,W,V=0,Y=h,q=u,X=o,gt=c,mt=0,vt=0,bt=!1,yt=!1;v===S&&(X=h,gt=u),C=(p=at)-tt,A=(f=ot)-et,it=0===it?C:it,nt=0===nt?A:nt,st=0!==C?k(C):0!==it?k(it):st,rt=0!==A?k(A):0!==nt?k(nt):rt,tt=p,et=f,lt=function(t,i){return i?{top:i[g]-i[e][n].top0||0,left:i[m]-i[e][n].left0||0}:{top:0,left:0}}(0,J),b!==S&&(E[e].r[h]=et-$+E[e][i][h],E[s][h]=w(E[e].r[h]-Q[e][i][h]+Q[e][n][h]-E[e][r][h]+lt[h])+"px",yt=0>A*nt),v!==S&&(E[e].r[o]=tt-K+E[e][i][o],E[s][o]=w(E[e].r[o]-Q[e][i][o]+Q[e][n][o]-E[e][r][o]+lt[o])+"px",bt=0>C*it),t.options.autoscroll&&J&&(!xt||bt||yt)&&(xt&&(clearInterval(xt),xt=null),Z===J?(L=J[e][i][c],B=0,R=J[e][i][u],N=0,z=1.5,W=1.5):(L=J[e][i][l],B=J[e][i][o],R=J[e][i][d],N=J[e][i][h],z=1.2,W=1.2),v!==S&&(0<st&&J[m]+J[e][i][c]<J[e][n][c]&&E[e].r[o]+E[e].r[c]>=L||0>st&&0<J[m]&&E[e].r[o]<=B)&&(mt=x.round(st*z*E[e].r[c])),b!==S&&(0<rt&&J[g]+J[e][i][u]<J[e][n][u]&&E[e].r[h]+E[e].r[u]>=R||0>rt&&0<J[g]&&E[e].r[h]<=N)&&(vt=x.round(rt*W*E[e].r[u])),(mt||vt)&&(xt=function(t,s,r,a){var o=J[g]||0,l=J[m]||0,h=0,d=t/(r||a),f=s/(r||a);return setInterval((function(){h+=a,o+=f*a,l+=d*a,J[g]=x.min(x.max(0,o),J[e][n][u]-J[e][i][u]),J[m]=x.min(x.max(0,l),J[e][n][c]-J[e][i][c]),xt&&h>=r&&(clearInterval(xt),xt=null)}),a)}(x.abs(mt)>x.abs(vt)?mt:0,x.abs(vt)>=x.abs(mt)?vt:0,t.options.scrollAnimationMs||0,16.666666666666668))),it=C,nt=A,M=E[e].r[o]+E[e].r[c]/2,P=E[e].r[h]+E[e].r[u]/2,D=E[e].r[X],a=function(t){for(var e=1,i=arguments,n=i.length;e<n;++e)t.push.apply(t,i[e]);return t}(H(pt,p,f),v===S?[]:H(pt,E[e].r[o]+2,P),v===S?[]:H(pt,E[e].r[o]+E[e].r[c]-2,P),b===S?[]:H(pt,M,E[e].r[h]+2),b===S?[]:H(pt,M,E[e].r[h]+E[e].r[u]-2)).reduce((function(t,e){if(e!==E&&e!==T&&e.parentNode===Q){var i=ft(E,e,lt,St,Ct);i>V&&(V=i,t=e)}return t}),null),y===S?(!a&&E!==_&&0<=_[e][i][X]-lt[X]-(D+E[e][i][gt])&&_[e][i][X]-lt[X]-(D+E[e][i][gt])<25&&.7<(V=U(E,_,lt,Y,q))&&(a=_),!a&&E!==G&&0<=D-(G[e][i][X]-lt[X]+G[e][i][gt])&&D-(G[e][i][X]-lt[X]+G[e][i][gt])<25&&.7<(V=U(E,G,lt,Y,q))&&(a=G),I=a?a[e].index-E[e].index:x.abs(rt)>=x.abs(st)?rt:st):(!a&&E!==_&&_[e][i][X]-lt[X]>D+E[e][i][gt]&&(a=_),!a&&E!==G&&D>G[e][i][X]-lt[X]+G[e][i][gt]&&(a=G),I=b===S?st:rt),O&&(0>ct&&0<I&&ht<.5||0<ct&&0>I&&ht<.5||a&&O!==a&&ht<V||!ft(E,O,lt,St,Ct))&&(F(O,t.options.closestItem||"dnd-sortable-closest"),ht=0,O=null),!O&&a&&V&&(O=a,ct=0<I?1:-1,ht=V,dt=!1),O&&((V=V||ft(E,O,lt,St,Ct))?(ht=V,V>.2?(j(O,t.options.closestItem||"dnd-sortable-closest"),V>.5&&!dt&&(K-=E[e][i][o],$-=E[e][i][h],dt=!0,ut(E,O,ct,t.options.animationMs||0),K+=E[e][i][o],$+=E[e][i][h])):F(O,t.options.closestItem||"dnd-sortable-closest")):(F(O,t.options.closestItem||"dnd-sortable-closest"),ht=0,O=null))},Lt=function(e){var i=E;At(),Et(),M(t.options.onEnd)&&t.options.onEnd(i)};t.start=t.options.callable?function(){mt||(gt=!1,mt=!0,t.handle=Pt)}:function(){mt||(mt=!0,gt||(gt=!0,D(document,"touchstart",Pt,{capture:!0,passive:!1}),D(document,"mousedown",Pt,{capture:!0,passive:!1})))},t.stop=function(){t.handle=null,mt=!1,gt&&(L(document,"touchstart",Pt,{capture:!0,passive:!1}),L(document,"mousedown",Pt,{capture:!0,passive:!1}),gt=!1),At(),Et()}}function q(t,e){var i=this;if(!(i instanceof q))return new q(t,e);switch(i.options=e||{},(t=w(t)).toLowerCase()){case"unrestricted":G(i,y);break;case"horizontal":G(i,b);break;case"vertical":G(i,v);break;default:throw new TypeError("AreaSortable invalid sort mode:"+t)}i.start()}return window.Element&&!S.call(window.Element.prototype,e)&&(window.Element.prototype[e]=null),q.VERSION="1.2.2",q.prototype={constructor:q,options:null,start:null,handle:null,stop:null,dispose:function(){var t=this;return t.stop&&t.stop(),t.options=null,t.start=null,t.handle=null,t.stop=null,t}},q}()}("undefined"!=typeof self&&self)},729:function(t,e){var i,n;void 0===(n="function"==typeof(i=function(){return function t(e,i,n){var s,r,a=window,o="application/octet-stream",l=n||o,c=e,h=!i&&!n&&c,d=document.createElement("a"),u=function(t){return String(t)},f=a.Blob||a.MozBlob||a.WebKitBlob||u,p=i||"download";if(f=f.call?f.bind(a):Blob,"true"===String(this)&&(l=(c=[c,l])[0],c=c[1]),h&&h.length<2048&&(p=h.split("/").pop().split("?")[0],d.href=h,-1!==d.href.indexOf(h))){var g=new XMLHttpRequest;return g.open("GET",h,!0),g.responseType="blob",g.onload=function(e){t(e.target.response,p,o)},setTimeout((function(){g.send()}),0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&f!==u))return navigator.msSaveBlob?navigator.msSaveBlob(y(c),p):x(c);l=(c=y(c)).type||o}else if(/([\x80-\xff])/.test(c)){for(var m=0,v=new Uint8Array(c.length),b=v.length;m<b;++m)v[m]=c.charCodeAt(m);c=new f([v],{type:l})}function y(t){for(var e=t.split(/[:;,]/),i=e[1],n=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),s=n.length,r=0,a=new Uint8Array(s);r<s;++r)a[r]=n.charCodeAt(r);return new f([a],{type:i})}function x(t,e){if("download"in d)return d.href=t,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){a.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,o)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var i=document.createElement("iframe");document.body.appendChild(i),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,o)),i.src=t,setTimeout((function(){document.body.removeChild(i)}),333)}if(s=c instanceof f?c:new f([c],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(s,p);if(a.URL)x(a.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===u)try{return x("data:"+l+";base64,"+a.btoa(s))}catch(t){return x("data:"+l+","+encodeURIComponent(s))}(r=new FileReader).onload=function(t){x(this.result)},r.readAsDataURL(s)}return!0}})?i.apply(e,[]):i)||(t.exports=n)},777:(t,e,i)=>{var n,s,r,a,o,l,c,h,d,u,f,p,g,m,v,b,y,x,w,C,S,T,E=E||{version:"5.3.0"};if(e.fabric=E,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?E.document=document:E.document=document.implementation.createHTMLDocument(""),E.window=window;else{var A=new(i(960).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;E.document=A.document,E.jsdomImplForWrapper=i(759).implForWrapper,E.nodeCanvas=i(272).Canvas,E.window=A,DOMParser=E.window.DOMParser}function I(t,e){var i=t.canvas,n=e.targetCanvas,s=n.getContext("2d");s.translate(0,n.height),s.scale(1,-1);var r=i.height-n.height;s.drawImage(i,0,r,n.width,n.height,0,0,n.width,n.height)}function O(t,e){var i=e.targetCanvas.getContext("2d"),n=e.destinationWidth,s=e.destinationHeight,r=n*s*4,a=new Uint8Array(this.imageBuffer,0,r),o=new Uint8ClampedArray(this.imageBuffer,0,r);t.readPixels(0,0,n,s,t.RGBA,t.UNSIGNED_BYTE,a);var l=new ImageData(o,n,s);i.putImageData(l,0,0)}E.isTouchSupported="ontouchstart"in E.window||"ontouchstart"in E.document||E.window&&E.window.navigator&&E.window.navigator.maxTouchPoints>0,E.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,E.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],E.DPI=96,E.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",E.commaWsp="(?:\\s+,?\\s*|,\\s*)",E.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,E.reNonWord=/[ \n\.,;!\?\-]/,E.fontPaths={},E.iMatrix=[1,0,0,1,0,0],E.svgNS="http://www.w3.org/2000/svg",E.perfLimitSizeTotal=2097152,E.maxCacheSideLimit=4096,E.minCacheSideLimit=256,E.charWidthsCache={},E.textureSize=2048,E.disableStyleCopyPaste=!1,E.enableGLFiltering=!0,E.devicePixelRatio=E.window.devicePixelRatio||E.window.webkitDevicePixelRatio||E.window.mozDevicePixelRatio||1,E.browserShadowBlurConstant=1,E.arcToSegmentsCache={},E.boundsOfCurveCache={},E.cachesBoundsOfCurve=!0,E.forceGLPutImageData=!1,E.initFilterBackend=function(){return E.enableGLFiltering&&E.isWebglSupported&&E.isWebglSupported(E.textureSize)?(console.log("max texture size: "+E.maxTextureSize),new E.WebglFilterBackend({tileSize:E.textureSize})):E.Canvas2dFilterBackend?new E.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=E),function(){function t(t,e){if(this.__eventListeners[t]){var i=this.__eventListeners[t];e?i[i.indexOf(e)]=!1:E.util.array.fill(i,!1)}}function e(t,e){var i=function(){e.apply(this,arguments),this.off(t,i)}.bind(this);this.on(t,i)}E.Observable={fire:function(t,e){if(!this.__eventListeners)return this;var i=this.__eventListeners[t];if(!i)return this;for(var n=0,s=i.length;n<s;n++)i[n]&&i[n].call(this,e||{});return this.__eventListeners[t]=i.filter((function(t){return!1!==t})),this},on:function(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this},once:function(t,i){if(1===arguments.length)for(var n in t)e.call(this,n,t[n]);else e.call(this,t,i);return this},off:function(e,i){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof arguments[0])for(var n in e)t.call(this,n,e[n]);else t.call(this,e,i);return this}}}(),E.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,i){var n=this._objects;return i?n[e]=t:n.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,i=!1,n=0,s=arguments.length;n<s;n++)-1!==(t=e.indexOf(arguments[n]))&&(i=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[n]));return this.renderOnAddRemove&&i&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),n=0,s=i.length;n<s;n++)t.call(e,i[n],n,i);return this},getObjects:function(t){return void 0===t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1||!!e&&this._objects.some((function(e){return"function"==typeof e.contains&&e.contains(t,!0)}))},complexity:function(){return this._objects.reduce((function(t,e){return t+(e.complexity?e.complexity():0)}),0)}},E.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof E.Gradient||this.set(e,new E.Gradient(t))},_initPattern:function(t,e,i){!t||!t.source||t instanceof E.Pattern?i&&i():this.set(e,new E.Pattern(t,i))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},n=e,s=Math.sqrt,r=Math.atan2,a=Math.pow,o=Math.PI/180,l=Math.PI/2,E.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/l){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/l){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*o},radiansToDegrees:function(t){return t/o},rotatePoint:function(t,e,i){var n=new E.Point(t.x-e.x,t.y-e.y),s=E.util.rotateVector(n,i);return new E.Point(s.x,s.y).addEquals(e)},rotateVector:function(t,e){var i=E.util.sin(e),n=E.util.cos(e);return{x:t.x*n-t.y*i,y:t.x*i+t.y*n}},createVector:function(t,e){return new E.Point(e.x-t.x,e.y-t.y)},calcAngleBetweenVectors:function(t,e){return Math.acos((t.x*e.x+t.y*e.y)/(Math.hypot(t.x,t.y)*Math.hypot(e.x,e.y)))},getHatVector:function(t){return new E.Point(t.x,t.y).multiply(1/Math.hypot(t.x,t.y))},getBisector:function(t,e,i){var n=E.util.createVector(t,e),s=E.util.createVector(t,i),r=E.util.calcAngleBetweenVectors(n,s),a=r*(0===E.util.calcAngleBetweenVectors(E.util.rotateVector(n,r),s)?1:-1)/2;return{vector:E.util.getHatVector(E.util.rotateVector(n,a)),angle:r}},projectStrokeOnPoints:function(t,e,i){var n=[],s=e.strokeWidth/2,r=e.strokeUniform?new E.Point(1/e.scaleX,1/e.scaleY):new E.Point(1,1),a=function(t){var e=s/Math.hypot(t.x,t.y);return new E.Point(t.x*e*r.x,t.y*e*r.y)};return t.length<=1||t.forEach((function(o,l){var c,h,d=new E.Point(o.x,o.y);0===l?(h=t[l+1],c=i?a(E.util.createVector(h,d)).addEquals(d):t[t.length-1]):l===t.length-1?(c=t[l-1],h=i?a(E.util.createVector(c,d)).addEquals(d):t[0]):(c=t[l-1],h=t[l+1]);var u,f,p=E.util.getBisector(d,c,h),g=p.vector,m=p.angle;if("miter"===e.strokeLineJoin&&(u=-s/Math.sin(m/2),f=new E.Point(g.x*u*r.x,g.y*u*r.y),Math.hypot(f.x,f.y)/s<=e.strokeMiterLimit))return n.push(d.add(f)),void n.push(d.subtract(f));u=-s*Math.SQRT2,f=new E.Point(g.x*u*r.x,g.y*u*r.y),n.push(d.add(f)),n.push(d.subtract(f))})),n},transformPoint:function(t,e,i){return i?new E.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new E.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var i=0;i<t.length;i++)t[i]=E.util.transformPoint(t[i],e);var n=[t[0].x,t[1].x,t[2].x,t[3].x],s=E.util.array.min(n),r=E.util.array.max(n)-s,a=[t[0].y,t[1].y,t[2].y,t[3].y],o=E.util.array.min(a);return{left:s,top:o,width:r,height:E.util.array.max(a)-o}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),i=[e*t[3],-e*t[1],-e*t[2],e*t[0]],n=E.util.transformPoint({x:t[4],y:t[5]},i,!0);return i[4]=-n.x,i[5]=-n.y,i},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),n=parseFloat(t);switch(e||(e=E.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return n*E.DPI/25.4;case"cm":return n*E.DPI/2.54;case"in":return n*E.DPI;case"pt":return n*E.DPI/72;case"pc":return n*E.DPI/72*12;case"em":return n*e;default:return n}},falseFunction:function(){return!1},getKlass:function(t,e){return t=E.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),E.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return E;var e,i=t.split("."),s=i.length,r=n||E.window;for(e=0;e<s;++e)r=r[i[e]];return r},loadImage:function(t,e,i,n){if(t){var s=E.util.createImage(),r=function(){e&&e.call(i,s,!1),s=s.onload=s.onerror=null};s.onload=r,s.onerror=function(){E.log("Error loading "+s.src),e&&e.call(i,null,!0),s=s.onload=s.onerror=null},0!==t.indexOf("data")&&null!=n&&(s.crossOrigin=n),"data:image/svg"===t.substring(0,14)&&(s.onload=null,E.util.loadImageInDom(s,r)),s.src=t}else e&&e.call(i,t)},loadImageInDom:function(t,e){var i=E.document.createElement("div");i.style.width=i.style.height="1px",i.style.left=i.style.top="-100%",i.style.position="absolute",i.appendChild(t),E.document.querySelector("body").appendChild(i),t.onload=function(){e(),i.parentNode.removeChild(i),i=null}},enlivenObjects:function(t,e,i,n){var s=[],r=0,a=(t=t||[]).length;function o(){++r===a&&e&&e(s.filter((function(t){return t})))}a?t.forEach((function(t,e){t&&t.type?E.util.getKlass(t.type,i).fromObject(t,(function(i,r){r||(s[e]=i),n&&n(t,i,r),o()})):o()})):e&&e(s)},enlivenObjectEnlivables:function(t,e,i){var n=E.Object.ENLIVEN_PROPS.filter((function(e){return!!t[e]}));E.util.enlivenObjects(n.map((function(e){return t[e]})),(function(t){var s={};n.forEach((function(i,n){s[i]=t[n],e&&(e[i]=t[n])})),i&&i(s)}))},enlivenPatterns:function(t,e){function i(){++s===r&&e&&e(n)}var n=[],s=0,r=(t=t||[]).length;r?t.forEach((function(t,e){t&&t.source?new E.Pattern(t,(function(t){n[e]=t,i()})):(n[e]=t,i())})):e&&e(n)},groupSVGElements:function(t,e,i){var n;return t&&1===t.length?(void 0!==i&&(t[0].sourcePath=i),t[0]):(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),n=new E.Group(t,e),void 0!==i&&(n.sourcePath=i),n)},populateWithProperties:function(t,e,i){if(i&&Array.isArray(i))for(var n=0,s=i.length;n<s;n++)i[n]in t&&(e[i[n]]=t[i[n]])},createCanvasElement:function(){return E.document.createElement("canvas")},copyCanvasElement:function(t){var e=E.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,i){return t.toDataURL("image/"+e,i)},createImage:function(){return E.document.createElement("img")},multiplyTransformMatrices:function(t,e,i){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],i?0:t[0]*e[4]+t[2]*e[5]+t[4],i?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=r(t[1],t[0]),i=a(t[0],2)+a(t[1],2),n=s(i),l=(t[0]*t[3]-t[2]*t[1])/n,c=r(t[0]*t[2]+t[1]*t[3],i);return{angle:e/o,scaleX:n,scaleY:l,skewX:c/o,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return E.iMatrix.concat();var e=E.util.degreesToRadians(t.angle),i=E.util.cos(e),n=E.util.sin(e);return[i,n,-n,i,0,0]},calcDimensionsMatrix:function(t){var e=void 0===t.scaleX?1:t.scaleX,i=void 0===t.scaleY?1:t.scaleY,n=[t.flipX?-e:e,0,0,t.flipY?-i:i,0,0],s=E.util.multiplyTransformMatrices,r=E.util.degreesToRadians;return t.skewX&&(n=s(n,[1,0,Math.tan(r(t.skewX)),1],!0)),t.skewY&&(n=s(n,[1,Math.tan(r(t.skewY)),0,1],!0)),n},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],i=E.util.multiplyTransformMatrices;return t.angle&&(e=i(e,E.util.calcRotateMatrix(t))),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=i(e,E.util.calcDimensionsMatrix(t))),e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,i,n){n>0&&(e>n?e-=n:e=0,i>n?i-=n:i=0);var s,r=!0,a=t.getImageData(e,i,2*n||1,2*n||1),o=a.data.length;for(s=3;s<o&&0!=(r=a.data[s]<=0);s+=4);return a=null,r},parsePreserveAspectRatioAttribute:function(t){var e,i="meet",n=t.split(" ");return n&&n.length&&("meet"!==(i=n.pop())&&"slice"!==i?(e=i,i="meet"):n.length&&(e=n.pop())),{meetOrSlice:i,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?E.charWidthsCache[t]&&delete E.charWidthsCache[t]:E.charWidthsCache={}},limitDimsByArea:function(t,e){var i=Math.sqrt(e*t),n=Math.floor(e/i);return{x:Math.floor(i),y:n}},capValue:function(t,e,i){return Math.max(t,Math.min(e,i))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return E.util.toFixed(t,E.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(t,e){var i=E.util.invertTransform(e),n=E.util.multiplyTransformMatrices(i,t.calcOwnMatrix());E.util.applyTransformToObject(t,n)},addTransformToObject:function(t,e){E.util.applyTransformToObject(t,E.util.multiplyTransformMatrices(e,t.calcOwnMatrix()))},applyTransformToObject:function(t,e){var i=E.util.qrDecompose(e),n=new E.Point(i.translateX,i.translateY);t.flipX=!1,t.flipY=!1,t.set("scaleX",i.scaleX),t.set("scaleY",i.scaleY),t.skewX=i.skewX,t.skewY=i.skewY,t.angle=i.angle,t.setPositionByOrigin(n,"center","center")},sizeAfterTransform:function(t,e,i){var n=t/2,s=e/2,r=[{x:-n,y:-s},{x:n,y:-s},{x:-n,y:s},{x:n,y:s}],a=E.util.calcDimensionsMatrix(i),o=E.util.makeBoundingBoxFromPoints(r,a);return{x:o.width,y:o.height}},mergeClipPaths:function(t,e){var i=t,n=e;i.inverted&&!n.inverted&&(i=e,n=t),E.util.applyTransformToObject(n,E.util.multiplyTransformMatrices(E.util.invertTransform(i.calcTransformMatrix()),n.calcTransformMatrix()));var s=i.inverted&&n.inverted;return s&&(i.inverted=n.inverted=!1),new E.Group([i],{clipPath:n,inverted:s})},hasStyleChanged:function(t,e,i){return i=i||!1,t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.textBackgroundColor!==e.textBackgroundColor||t.deltaY!==e.deltaY||i&&(t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough)},stylesToArray:function(t,e){t=E.util.object.clone(t,!0);for(var i=e.split("\n"),n=-1,s={},r=[],a=0;a<i.length;a++)if(t[a])for(var o=0;o<i[a].length;o++){n++;var l=t[a][o];l&&Object.keys(l).length>0&&(E.util.hasStyleChanged(s,l,!0)?r.push({start:n,end:n+1,style:l}):r[r.length-1].end++),s=l||{}}else n+=i[a].length;return r},stylesFromArray:function(t,e){if(!Array.isArray(t))return t;for(var i=e.split("\n"),n=-1,s=0,r={},a=0;a<i.length;a++)for(var o=0;o<i[a].length;o++)n++,t[s]&&t[s].start<=n&&n<t[s].end&&(r[a]=r[a]||{},r[a][o]=Object.assign({},t[s].style),n===t[s].end-1&&s++);return r}},function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},i={m:"l",M:"L"};function n(t,e,i,n,s,r,a,o,l,c,h){var d=E.util.cos(t),u=E.util.sin(t),f=E.util.cos(e),p=E.util.sin(e),g=i*s*f-n*r*p+a,m=n*s*f+i*r*p+o;return["C",c+l*(-i*s*u-n*r*d),h+l*(-n*s*u+i*r*d),g+l*(i*s*p+n*r*f),m+l*(n*s*p-i*r*f),g,m]}function s(t,e,i,n){var s=Math.atan2(e,t),r=Math.atan2(n,i);return r>=s?r-s:2*Math.PI-(s-r)}function r(t,e,i){for(var r=i[1],a=i[2],o=i[3],l=i[4],c=i[5],h=function(t,e,i,r,a,o,l){var c=Math.PI,h=l*c/180,d=E.util.sin(h),u=E.util.cos(h),f=0,p=0,g=-u*t*.5-d*e*.5,m=-u*e*.5+d*t*.5,v=(i=Math.abs(i))*i,b=(r=Math.abs(r))*r,y=m*m,x=g*g,w=v*b-v*y-b*x,C=0;if(w<0){var S=Math.sqrt(1-w/(v*b));i*=S,r*=S}else C=(a===o?-1:1)*Math.sqrt(w/(v*y+b*x));var T=C*i*m/r,A=-C*r*g/i,I=u*T-d*A+.5*t,O=d*T+u*A+.5*e,k=s(1,0,(g-T)/i,(m-A)/r),M=s((g-T)/i,(m-A)/r,(-g-T)/i,(-m-A)/r);0===o&&M>0?M-=2*c:1===o&&M<0&&(M+=2*c);for(var P=Math.ceil(Math.abs(M/c*2)),_=[],D=M/P,L=8/3*Math.sin(D/4)*Math.sin(D/4)/Math.sin(D/2),B=k+D,j=0;j<P;j++)_[j]=n(k,B,u,d,i,r,I,O,L,f,p),f=_[j][5],p=_[j][6],k=B,B+=D;return _}(i[6]-t,i[7]-e,r,a,l,c,o),d=0,u=h.length;d<u;d++)h[d][1]+=t,h[d][2]+=e,h[d][3]+=t,h[d][4]+=e,h[d][5]+=t,h[d][6]+=e;return h}function a(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}function o(t,e,i,n,s,r,a,o){return function(l){var c,h=(c=l)*c*c,d=function(t){return 3*t*t*(1-t)}(l),u=function(t){return 3*t*(1-t)*(1-t)}(l),f=function(t){return(1-t)*(1-t)*(1-t)}(l);return{x:a*h+s*d+i*u+t*f,y:o*h+r*d+n*u+e*f}}}function l(t,e,i,n,s,r,a,o){return function(l){var c=1-l,h=3*c*c*(i-t)+6*c*l*(s-i)+3*l*l*(a-s),d=3*c*c*(n-e)+6*c*l*(r-n)+3*l*l*(o-r);return Math.atan2(d,h)}}function c(t,e,i,n,s,r){return function(a){var o,l=(o=a)*o,c=function(t){return 2*t*(1-t)}(a),h=function(t){return(1-t)*(1-t)}(a);return{x:s*l+i*c+t*h,y:r*l+n*c+e*h}}}function h(t,e,i,n,s,r){return function(a){var o=1-a,l=2*o*(i-t)+2*a*(s-i),c=2*o*(n-e)+2*a*(r-n);return Math.atan2(c,l)}}function d(t,e,i){var n,s,r={x:e,y:i},o=0;for(s=1;s<=100;s+=1)n=t(s/100),o+=a(r.x,r.y,n.x,n.y),r=n;return o}function u(t){for(var e,i,n,s,r=0,u=t.length,f=0,p=0,g=0,m=0,v=[],b=0;b<u;b++){switch(n={x:f,y:p,command:(e=t[b])[0]},e[0]){case"M":n.length=0,g=f=e[1],m=p=e[2];break;case"L":n.length=a(f,p,e[1],e[2]),f=e[1],p=e[2];break;case"C":i=o(f,p,e[1],e[2],e[3],e[4],e[5],e[6]),s=l(f,p,e[1],e[2],e[3],e[4],e[5],e[6]),n.iterator=i,n.angleFinder=s,n.length=d(i,f,p),f=e[5],p=e[6];break;case"Q":i=c(f,p,e[1],e[2],e[3],e[4]),s=h(f,p,e[1],e[2],e[3],e[4]),n.iterator=i,n.angleFinder=s,n.length=d(i,f,p),f=e[3],p=e[4];break;case"Z":case"z":n.destX=g,n.destY=m,n.length=a(f,p,g,m),f=g,p=m}r+=n.length,v.push(n)}return v.push({length:r,x:f,y:p}),v}E.util.joinPath=function(t){return t.map((function(t){return t.join(" ")})).join(" ")},E.util.parsePath=function(t){var n,s,r,a,o,l=[],c=[],h=E.rePathCommand,d="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",u="("+d+")"+E.commaWsp,f="([01])"+E.commaWsp+"?",p=new RegExp(u+"?"+u+"?"+u+f+f+u+"?("+d+")","g");if(!t||!t.match)return l;for(var g,m=0,v=(o=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;m<v;m++){a=(n=o[m]).slice(1).trim(),c.length=0;var b=n.charAt(0);if(g=[b],"a"===b.toLowerCase())for(var y;y=p.exec(a);)for(var x=1;x<y.length;x++)c.push(y[x]);else for(;r=h.exec(a);)c.push(r[0]);x=0;for(var w=c.length;x<w;x++)s=parseFloat(c[x]),isNaN(s)||g.push(s);var C=e[b.toLowerCase()],S=i[b]||b;if(g.length-1>C)for(var T=1,A=g.length;T<A;T+=C)l.push([b].concat(g.slice(T,T+C))),b=S;else l.push(g)}return l},E.util.makePathSimpler=function(t){var e,i,n,s,a,o,l=0,c=0,h=t.length,d=0,u=0,f=[];for(i=0;i<h;++i){switch(n=!1,(e=t[i].slice(0))[0]){case"l":e[0]="L",e[1]+=l,e[2]+=c;case"L":l=e[1],c=e[2];break;case"h":e[1]+=l;case"H":e[0]="L",e[2]=c,l=e[1];break;case"v":e[1]+=c;case"V":e[0]="L",c=e[1],e[1]=l,e[2]=c;break;case"m":e[0]="M",e[1]+=l,e[2]+=c;case"M":l=e[1],c=e[2],d=e[1],u=e[2];break;case"c":e[0]="C",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c,e[5]+=l,e[6]+=c;case"C":a=e[3],o=e[4],l=e[5],c=e[6];break;case"s":e[0]="S",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"S":"C"===s?(a=2*l-a,o=2*c-o):(a=l,o=c),l=e[3],c=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=a,e[2]=o,a=e[3],o=e[4];break;case"q":e[0]="Q",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"Q":a=e[1],o=e[2],l=e[3],c=e[4];break;case"t":e[0]="T",e[1]+=l,e[2]+=c;case"T":"Q"===s?(a=2*l-a,o=2*c-o):(a=l,o=c),e[0]="Q",l=e[1],c=e[2],e[1]=a,e[2]=o,e[3]=l,e[4]=c;break;case"a":e[0]="A",e[6]+=l,e[7]+=c;case"A":n=!0,f=f.concat(r(l,c,e)),l=e[6],c=e[7];break;case"z":case"Z":l=d,c=u}n||f.push(e),s=e[0]}return f},E.util.getSmoothPathFromPoints=function(t,e){var i,n=[],s=new E.Point(t[0].x,t[0].y),r=new E.Point(t[1].x,t[1].y),a=t.length,o=1,l=0,c=a>2;for(e=e||0,c&&(o=t[2].x<r.x?-1:t[2].x===r.x?0:1,l=t[2].y<r.y?-1:t[2].y===r.y?0:1),n.push(["M",s.x-o*e,s.y-l*e]),i=1;i<a;i++){if(!s.eq(r)){var h=s.midPointFrom(r);n.push(["Q",s.x,s.y,h.x,h.y])}s=t[i],i+1<t.length&&(r=t[i+1])}return c&&(o=s.x>t[i-2].x?1:s.x===t[i-2].x?0:-1,l=s.y>t[i-2].y?1:s.y===t[i-2].y?0:-1),n.push(["L",s.x+o*e,s.y+l*e]),n},E.util.getPathSegmentsInfo=u,E.util.getBoundsOfCurve=function(e,i,n,s,r,a,o,l){var c;if(E.cachesBoundsOfCurve&&(c=t.call(arguments),E.boundsOfCurveCache[c]))return E.boundsOfCurveCache[c];var h,d,u,f,p,g,m,v,b=Math.sqrt,y=Math.min,x=Math.max,w=Math.abs,C=[],S=[[],[]];d=6*e-12*n+6*r,h=-3*e+9*n-9*r+3*o,u=3*n-3*e;for(var T=0;T<2;++T)if(T>0&&(d=6*i-12*s+6*a,h=-3*i+9*s-9*a+3*l,u=3*s-3*i),w(h)<1e-12){if(w(d)<1e-12)continue;0<(f=-u/d)&&f<1&&C.push(f)}else(m=d*d-4*u*h)<0||(0<(p=(-d+(v=b(m)))/(2*h))&&p<1&&C.push(p),0<(g=(-d-v)/(2*h))&&g<1&&C.push(g));for(var A,I,O,k=C.length,M=k;k--;)A=(O=1-(f=C[k]))*O*O*e+3*O*O*f*n+3*O*f*f*r+f*f*f*o,S[0][k]=A,I=O*O*O*i+3*O*O*f*s+3*O*f*f*a+f*f*f*l,S[1][k]=I;S[0][M]=e,S[1][M]=i,S[0][M+1]=o,S[1][M+1]=l;var P=[{x:y.apply(null,S[0]),y:y.apply(null,S[1])},{x:x.apply(null,S[0]),y:x.apply(null,S[1])}];return E.cachesBoundsOfCurve&&(E.boundsOfCurveCache[c]=P),P},E.util.getPointOnPath=function(t,e,i){i||(i=u(t));for(var n=0;e-i[n].length>0&&n<i.length-2;)e-=i[n].length,n++;var s,r=i[n],o=e/r.length,l=r.command,c=t[n];switch(l){case"M":return{x:r.x,y:r.y,angle:0};case"Z":case"z":return(s=new E.Point(r.x,r.y).lerp(new E.Point(r.destX,r.destY),o)).angle=Math.atan2(r.destY-r.y,r.destX-r.x),s;case"L":return(s=new E.Point(r.x,r.y).lerp(new E.Point(c[1],c[2]),o)).angle=Math.atan2(c[2]-r.y,c[1]-r.x),s;case"C":case"Q":return function(t,e){for(var i,n,s,r=0,o=0,l=t.iterator,c={x:t.x,y:t.y},h=.01,d=t.angleFinder;o<e&&h>1e-4;)i=l(r),s=r,(n=a(c.x,c.y,i.x,i.y))+o>e?(r-=h,h/=2):(c=i,r+=h,o+=n);return i.angle=d(s),i}(r,e)}},E.util.transformPath=function(t,e,i){return i&&(e=E.util.multiplyTransformMatrices(e,[1,0,0,1,-i.x,-i.y])),t.map((function(t){for(var i=t.slice(0),n={},s=1;s<t.length-1;s+=2)n.x=t[s],n.y=t[s+1],n=E.util.transformPoint(n,e),i[s]=n.x,i[s+1]=n.y;return i}))}}(),function(){var t=Array.prototype.slice;function e(t,e,i){if(t&&0!==t.length){var n=t.length-1,s=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],s)&&(s=t[n][e]);else for(;n--;)i(t[n],s)&&(s=t[n]);return s}}E.util.array={fill:function(t,e){for(var i=t.length;i--;)t[i]=e;return t},invoke:function(e,i){for(var n=t.call(arguments,2),s=[],r=0,a=e.length;r<a;r++)s[r]=n.length?e[r][i].apply(e[r],n):e[r][i].call(e[r]);return s},min:function(t,i){return e(t,i,(function(t,e){return t<e}))},max:function(t,i){return e(t,i,(function(t,e){return t>=e}))}}}(),function(){function t(e,i,n){if(n)if(!E.isLikelyNode&&i instanceof Element)e=i;else if(i instanceof Array){e=[];for(var s=0,r=i.length;s<r;s++)e[s]=t({},i[s],n)}else if(i&&"object"==typeof i)for(var a in i)"canvas"===a||"group"===a?e[a]=null:i.hasOwnProperty(a)&&(e[a]=t({},i[a],n));else e=i;else for(var a in i)e[a]=i[a];return e}E.util.object={extend:t,clone:function(e,i){return t({},e,i)}},E.util.object.extend(E.util,E.Observable)}(),function(){function t(t,e){var i=t.charCodeAt(e);if(isNaN(i))return"";if(i<55296||i>57343)return t.charAt(e);if(55296<=i&&i<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var n=t.charCodeAt(e+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var s=t.charCodeAt(e-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}E.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var i,n=0,s=[];for(n=0;n<e.length;n++)!1!==(i=t(e,n))&&s.push(i);return s}}}(),function(){var t=Array.prototype.slice,e=function(){},i=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),n=function(t,e,n){for(var s in e)s in t.prototype&&"function"==typeof t.prototype[s]&&(e[s]+"").indexOf("callSuper")>-1?t.prototype[s]=function(t){return function(){var i=this.constructor.superclass;this.constructor.superclass=n;var s=e[t].apply(this,arguments);if(this.constructor.superclass=i,"initialize"!==t)return s}}(s):t.prototype[s]=e[s],i&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function s(){}function r(e){for(var i=null,n=this;n.constructor.superclass;){var s=n.constructor.superclass.prototype[e];if(n[e]!==s){i=s;break}n=n.constructor.superclass.prototype}return i?arguments.length>1?i.apply(this,t.call(arguments,1)):i.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}E.util.createClass=function(){var i=null,a=t.call(arguments,0);function o(){this.initialize.apply(this,arguments)}"function"==typeof a[0]&&(i=a.shift()),o.superclass=i,o.subclasses=[],i&&(s.prototype=i.prototype,o.prototype=new s,i.subclasses.push(o));for(var l=0,c=a.length;l<c;l++)n(o,a[l],i);return o.prototype.initialize||(o.prototype.initialize=e),o.prototype.constructor=o,o.prototype.callSuper=r,o}}(),c=!!E.document.createElement("div").attachEvent,h=["touchstart","touchmove","touchend"],E.util.addListener=function(t,e,i,n){t&&t.addEventListener(e,i,!c&&n)},E.util.removeListener=function(t,e,i,n){t&&t.removeEventListener(e,i,!c&&n)},E.util.getPointer=function(t){var e=t.target,i=E.util.getScrollLeftTop(e),n=function(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}(t);return{x:n.clientX+i.left,y:n.clientY+i.top}},E.util.isTouchEvent=function(t){return h.indexOf(t.type)>-1||"touch"===t.pointerType},u="string"==typeof(d=E.document.createElement("div")).style.opacity,f="string"==typeof d.style.filter,p=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,g=function(t){return t},u?g=function(t,e){return t.style.opacity=e,t}:f&&(g=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),p.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(p,e)):i.filter+=" alpha(opacity="+100*e+")",t}),E.util.setStyle=function(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?g(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var n in e)if("opacity"===n)g(t,e[n]);else{var s="float"===n||"cssFloat"===n?void 0===i.styleFloat?"cssFloat":"styleFloat":n;i.setProperty(s,e[n])}return t},function(){var t,e,i,n,s=Array.prototype.slice,r=function(t){return s.call(t,0)};try{t=r(E.document.childNodes)instanceof Array}catch(t){}function a(t,e){var i=E.document.createElement(t);for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:i.setAttribute(n,e[n]);return i}function o(t){for(var e=0,i=0,n=E.document.documentElement,s=E.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===E.document?(e=s.scrollLeft||n.scrollLeft||0,i=s.scrollTop||n.scrollTop||0):(e+=t.scrollLeft||0,i+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:i}}t||(r=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e}),e=E.document.defaultView&&E.document.defaultView.getComputedStyle?function(t,e){var i=E.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},i=E.document.documentElement.style,n="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"",E.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=E.util.falseFunction),n?t.style[n]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},E.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),n?t.style[n]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},E.util.setImageSmoothing=function(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e},E.util.getById=function(t){return"string"==typeof t?E.document.getElementById(t):t},E.util.toArray=r,E.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},E.util.makeElement=a,E.util.wrapElement=function(t,e,i){return"string"==typeof e&&(e=a(e,i)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},E.util.getScrollLeftTop=o,E.util.getElementOffset=function(t){var i,n,s=t&&t.ownerDocument,r={left:0,top:0},a={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!s)return a;for(var c in l)a[l[c]]+=parseInt(e(t,c),10)||0;return i=s.documentElement,void 0!==t.getBoundingClientRect&&(r=t.getBoundingClientRect()),n=o(t),{left:r.left+n.left-(i.clientLeft||0)+a.left,top:r.top+n.top-(i.clientTop||0)+a.top}},E.util.getNodeCanvas=function(t){var e=E.jsdomImplForWrapper(t);return e._canvas||e._image},E.util.cleanUpJsdomNode=function(t){if(E.isLikelyNode){var e=E.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}E.util.request=function(e,i){i||(i={});var n=i.method?i.method.toUpperCase():"GET",s=i.onComplete||function(){},r=new E.window.XMLHttpRequest,a=i.body||i.parameters;return r.onreadystatechange=function(){4===r.readyState&&(s(r),r.onreadystatechange=t)},"GET"===n&&(a=null,"string"==typeof i.parameters&&(e=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(e,i.parameters))),r.open(n,e,!0),"POST"!==n&&"PUT"!==n||r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(a),r}}(),E.log=console.log,E.warn=console.warn,function(){var t=E.util.object.extend,e=E.util.object.clone,i=[];function n(){return!1}function s(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e}E.util.object.extend(i,{cancelAll:function(){var t=this.splice(0);return t.forEach((function(t){t.cancel()})),t},cancelByCanvas:function(t){if(!t)return[];var e=this.filter((function(e){return"object"==typeof e.target&&e.target.canvas===t}));return e.forEach((function(t){t.cancel()})),e},cancelByTarget:function(t){var e=this.findAnimationsByTarget(t);return e.forEach((function(t){t.cancel()})),e},findAnimationIndex:function(t){return this.indexOf(this.findAnimation(t))},findAnimation:function(t){return this.find((function(e){return e.cancel===t}))},findAnimationsByTarget:function(t){return t?this.filter((function(e){return e.target===t})):[]}});var r=E.window.requestAnimationFrame||E.window.webkitRequestAnimationFrame||E.window.mozRequestAnimationFrame||E.window.oRequestAnimationFrame||E.window.msRequestAnimationFrame||function(t){return E.window.setTimeout(t,1e3/60)},a=E.window.cancelAnimationFrame||E.window.clearTimeout;function o(){return r.apply(E.window,arguments)}E.util.animate=function(i){i||(i={});var r,a=!1,l=function(){var t=E.runningAnimations.indexOf(r);return t>-1&&E.runningAnimations.splice(t,1)[0]};return r=t(e(i),{cancel:function(){return a=!0,l()},currentValue:"startValue"in i?i.startValue:0,completionRate:0,durationRate:0}),E.runningAnimations.push(r),o((function(t){var e,c=t||+new Date,h=i.duration||500,d=c+h,u=i.onChange||n,f=i.abort||n,p=i.onComplete||n,g=i.easing||s,m="startValue"in i&&i.startValue.length>0,v="startValue"in i?i.startValue:0,b="endValue"in i?i.endValue:100,y=i.byValue||(m?v.map((function(t,e){return b[e]-v[e]})):b-v);i.onStart&&i.onStart(),function t(i){var n=(e=i||+new Date)>d?h:e-c,s=n/h,x=m?v.map((function(t,e){return g(n,v[e],y[e],h)})):g(n,v,y,h),w=m?Math.abs((x[0]-v[0])/y[0]):Math.abs((x-v)/y);if(r.currentValue=m?x.slice():x,r.completionRate=w,r.durationRate=s,!a){if(!f(x,w,s))return e>d?(r.currentValue=m?b.slice():b,r.completionRate=1,r.durationRate=1,u(m?b.slice():b,1,1),p(b,1,1),void l()):(u(x,w,s),void o(t));l()}}(c)})),r.cancel},E.util.requestAnimFrame=o,E.util.cancelAnimFrame=function(){return a.apply(E.window,arguments)},E.runningAnimations=i}(),function(){function t(t,e,i){var n="rgba("+parseInt(t[0]+i*(e[0]-t[0]),10)+","+parseInt(t[1]+i*(e[1]-t[1]),10)+","+parseInt(t[2]+i*(e[2]-t[2]),10);return(n+=","+(t&&e?parseFloat(t[3]+i*(e[3]-t[3])):1))+")"}E.util.animateColor=function(e,i,n,s){var r=new E.Color(e).getSource(),a=new E.Color(i).getSource(),o=s.onComplete,l=s.onChange;return s=s||{},E.util.animate(E.util.object.extend(s,{duration:n||500,startValue:r,endValue:a,byValue:a,easing:function(e,i,n,r){return t(i,n,s.colorEasing?s.colorEasing(e,r):1-Math.cos(e/r*(Math.PI/2)))},onComplete:function(e,i,n){if(o)return o(t(a,a,0),i,n)},onChange:function(e,i,n){if(l){if(Array.isArray(e))return l(t(e,e,0),i,n);l(e,i,n)}}}))}}(),function(){function t(t,e,i,n){return t<Math.abs(e)?(t=e,n=i/4):n=0===e&&0===t?i/(2*Math.PI)*Math.asin(1):i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:n}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function i(t,e,i,s){return i-n(s-t,0,i,s)+e}function n(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}E.util.ease={easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:function(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e},easeInOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,i,n){return t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOutCirc:function(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(i,n,s,r){var a=0;return 0===i?n:1==(i/=r)?n+s:(a||(a=.3*r),-e(t(s,s,a,1.70158),i,r)+n)},easeOutElastic:function(e,i,n,s){var r=0;if(0===e)return i;if(1==(e/=s))return i+n;r||(r=.3*s);var a=t(n,n,r,1.70158);return a.a*Math.pow(2,-10*e)*Math.sin((e*s-a.s)*(2*Math.PI)/a.p)+a.c+i},easeInOutElastic:function(i,n,s,r){var a=0;if(0===i)return n;if(2==(i/=r/2))return n+s;a||(a=r*(.3*1.5));var o=t(s,s,a,1.70158);return i<1?-.5*e(o,i,r)+n:o.a*Math.pow(2,-10*(i-=1))*Math.sin((i*r-o.s)*(2*Math.PI)/o.p)*.5+o.c+n},easeInBack:function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*(t/=n)*t*((s+1)*t-s)+e},easeOutBack:function(t,e,i,n,s){return void 0===s&&(s=1.70158),i*((t=t/n-1)*t*((s+1)*t+s)+1)+e},easeInOutBack:function(t,e,i,n,s){return void 0===s&&(s=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(s*=1.525))*t-s))+e:i/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+e},easeInBounce:i,easeOutBounce:n,easeInOutBounce:function(t,e,s,r){return t<r/2?.5*i(2*t,0,s,r)+e:.5*n(2*t-r,0,s,r)+.5*s+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,s=e.util.toFixed,r=e.util.parseUnit,a=e.util.multiplyTransformMatrices,o={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},l={stroke:"strokeOpacity",fill:"fillOpacity"},c="font-size",h="clip-path";function d(t){return t in o?o[t]:t}function u(t,i,n,s){var o,l=Array.isArray(i);if("fill"!==t&&"stroke"!==t||"none"!==i){if("strokeUniform"===t)return"non-scaling-stroke"===i;if("strokeDashArray"===t)i="none"===i?null:i.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)i=n&&n.transformMatrix?a(n.transformMatrix,e.parseTransformAttribute(i)):e.parseTransformAttribute(i);else if("visible"===t)i="none"!==i&&"hidden"!==i,n&&!1===n.visible&&(i=!1);else if("opacity"===t)i=parseFloat(i),n&&void 0!==n.opacity&&(i*=n.opacity);else if("textAnchor"===t)i="start"===i?"left":"end"===i?"right":"center";else if("charSpacing"===t)o=r(i,s)/s*1e3;else if("paintFirst"===t){var c=i.indexOf("fill"),h=i.indexOf("stroke");i="fill",(c>-1&&h>-1&&h<c||-1===c&&h>-1)&&(i="stroke")}else{if("href"===t||"xlink:href"===t||"font"===t)return i;if("imageSmoothing"===t)return"optimizeQuality"===i;o=l?i.map(r):r(i,s)}}else i="";return!l&&isNaN(o)?i:o}function f(t){return new RegExp("^("+t.join("|")+")\\b","i")}function p(t,e){var i,n,s,r,a=[];for(s=0,r=e.length;s<r;s++)i=e[s],n=t.getElementsByTagName(i),a=a.concat(Array.prototype.slice.call(n));return a}function g(t,e){var i,n=!0;return(i=m(t,e.pop()))&&e.length&&(n=function(t,e){for(var i,n=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)n&&(i=e.pop()),n=m(t=t.parentNode,i);return 0===e.length}(t,e)),i&&n&&0===e.length}function m(t,e){var i,n,s=t.nodeName,r=t.getAttribute("class"),a=t.getAttribute("id");if(i=new RegExp("^"+s,"i"),e=e.replace(i,""),a&&e.length&&(i=new RegExp("#"+a+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),r&&e.length)for(n=(r=r.split(" ")).length;n--;)i=new RegExp("\\."+r[n]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"");return 0===e.length}function v(t,e){var i;if(t.getElementById&&(i=t.getElementById(e)),i)return i;var n,s,r,a=t.getElementsByTagName("*");for(s=0,r=a.length;s<r;s++)if(e===(n=a[s]).getAttribute("id"))return n}e.svgValidTagNamesRegEx=f(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),e.svgViewBoxElementsRegEx=f(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=f(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=f(["symbol","g","a","svg","clipPath","defs"]),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,i,n){t[n]=Math.tan(e.util.degreesToRadians(i[0]))}var i=e.iMatrix,n=e.reNum,s=e.commaWsp,r="(?:(?:(matrix)\\s*\\(\\s*("+n+")"+s+"("+n+")"+s+"("+n+")"+s+"("+n+")"+s+"("+n+")"+s+"("+n+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+n+")(?:"+s+"("+n+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+n+")(?:"+s+"("+n+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+n+")(?:"+s+"("+n+")"+s+"("+n+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+n+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+n+")\\s*\\)))",a=new RegExp("^\\s*(?:(?:"+r+"(?:"+s+"*"+r+")*)?)\\s*$"),o=new RegExp(r,"g");return function(n){var s=i.concat(),l=[];if(!n||n&&!a.test(n))return s;n.replace(o,(function(n){var a=new RegExp(r).exec(n).filter((function(t){return!!t})),o=a[1],c=a.slice(2).map(parseFloat);switch(o){case"translate":!function(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}(s,c);break;case"rotate":c[0]=e.util.degreesToRadians(c[0]),function(t,i){var n=e.util.cos(i[0]),s=e.util.sin(i[0]),r=0,a=0;3===i.length&&(r=i[1],a=i[2]),t[0]=n,t[1]=s,t[2]=-s,t[3]=n,t[4]=r-(n*r-s*a),t[5]=a-(s*r+n*a)}(s,c);break;case"scale":!function(t,e){var i=e[0],n=2===e.length?e[1]:e[0];t[0]=i,t[3]=n}(s,c);break;case"skewX":t(s,c,2);break;case"skewY":t(s,c,1);break;case"matrix":s=c}l.push(s.concat()),s=i.concat()}));for(var c=l[0];l.length>1;)l.shift(),c=e.util.multiplyTransformMatrices(c,l[0]);return c}}();var b=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function y(t){if(!e.svgViewBoxElementsRegEx.test(t.nodeName))return{};var i,n,s,a,o,l,c=t.getAttribute("viewBox"),h=1,d=1,u=t.getAttribute("width"),f=t.getAttribute("height"),p=t.getAttribute("x")||0,g=t.getAttribute("y")||0,m=t.getAttribute("preserveAspectRatio")||"",v=!c||!(c=c.match(b)),y=!u||!f||"100%"===u||"100%"===f,x=v&&y,w={},C="",S=0,T=0;if(w.width=0,w.height=0,w.toBeParsed=x,v&&(p||g)&&t.parentNode&&"#document"!==t.parentNode.nodeName&&(C=" translate("+r(p)+" "+r(g)+") ",o=(t.getAttribute("transform")||"")+C,t.setAttribute("transform",o),t.removeAttribute("x"),t.removeAttribute("y")),x)return w;if(v)return w.width=r(u),w.height=r(f),w;if(i=-parseFloat(c[1]),n=-parseFloat(c[2]),s=parseFloat(c[3]),a=parseFloat(c[4]),w.minX=i,w.minY=n,w.viewBoxWidth=s,w.viewBoxHeight=a,y?(w.width=s,w.height=a):(w.width=r(u),w.height=r(f),h=w.width/s,d=w.height/a),"none"!==(m=e.util.parsePreserveAspectRatioAttribute(m)).alignX&&("meet"===m.meetOrSlice&&(d=h=h>d?d:h),"slice"===m.meetOrSlice&&(d=h=h>d?h:d),S=w.width-s*h,T=w.height-a*h,"Mid"===m.alignX&&(S/=2),"Mid"===m.alignY&&(T/=2),"Min"===m.alignX&&(S=0),"Min"===m.alignY&&(T=0)),1===h&&1===d&&0===i&&0===n&&0===p&&0===g)return w;if((p||g)&&"#document"!==t.parentNode.nodeName&&(C=" translate("+r(p)+" "+r(g)+") "),o=C+" matrix("+h+" 0 0 "+d+" "+(i*h+S)+" "+(n*d+T)+") ","svg"===t.nodeName){for(l=t.ownerDocument.createElementNS(e.svgNS,"g");t.firstChild;)l.appendChild(t.firstChild);t.appendChild(l)}else(l=t).removeAttribute("x"),l.removeAttribute("y"),o=l.getAttribute("transform")+o;return l.setAttribute("transform",o),w}function x(t,e){var i="xlink:href",n=v(t,e.getAttribute(i).slice(1));if(n&&n.getAttribute(i)&&x(t,n),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(t){n&&!e.hasAttribute(t)&&n.hasAttribute(t)&&e.setAttribute(t,n.getAttribute(t))})),!e.children.length)for(var s=n.cloneNode(!0);s.firstChild;)e.appendChild(s.firstChild);e.removeAttribute(i)}e.parseSVGDocument=function(t,i,s,r){if(t){!function(t){for(var i=p(t,["use","svg:use"]),n=0;i.length&&n<i.length;){var s=i[n],r=s.getAttribute("xlink:href")||s.getAttribute("href");if(null===r)return;var a,o,l,c,h=r.slice(1),d=s.getAttribute("x")||0,u=s.getAttribute("y")||0,f=v(t,h).cloneNode(!0),g=(f.getAttribute("transform")||"")+" translate("+d+", "+u+")",m=i.length,b=e.svgNS;if(y(f),/^svg$/i.test(f.nodeName)){var x=f.ownerDocument.createElementNS(b,"g");for(o=0,c=(l=f.attributes).length;o<c;o++)a=l.item(o),x.setAttributeNS(b,a.nodeName,a.nodeValue);for(;f.firstChild;)x.appendChild(f.firstChild);f=x}for(o=0,c=(l=s.attributes).length;o<c;o++)"x"!==(a=l.item(o)).nodeName&&"y"!==a.nodeName&&"xlink:href"!==a.nodeName&&"href"!==a.nodeName&&("transform"===a.nodeName?g=a.nodeValue+" "+g:f.setAttribute(a.nodeName,a.nodeValue));f.setAttribute("transform",g),f.setAttribute("instantiated_by_use","1"),f.removeAttribute("id"),s.parentNode.replaceChild(f,s),i.length===m&&n++}}(t);var a,o,l=e.Object.__uid++,c=y(t),h=e.util.toArray(t.getElementsByTagName("*"));if(c.crossOrigin=r&&r.crossOrigin,c.svgUid=l,0===h.length&&e.isLikelyNode){var d=[];for(a=0,o=(h=t.selectNodes('//*[name(.)!="svg"]')).length;a<o;a++)d[a]=h[a];h=d}var u=h.filter((function(t){return y(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)}));if(!u||u&&!u.length)i&&i([],{});else{var f={};h.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var i=t.getAttribute("id");f[i]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[l]=e.getGradientDefs(t),e.cssRules[l]=e.getCSSRules(t),e.clipPaths[l]=f,e.parseElements(u,(function(t,n){i&&(i(t,c,n,h),delete e.gradientDefs[l],delete e.cssRules[l],delete e.clipPaths[l])}),n(c),s,r)}}};var w=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");i(e,{parseFontDeclaration:function(t,e){var i=t.match(w);if(i){var n=i[1],s=i[3],a=i[4],o=i[5],l=i[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),a&&(e.fontSize=r(a)),l&&(e.fontFamily=l),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,i=p(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),n=0,s={};for(n=i.length;n--;)(e=i[n]).getAttribute("xlink:href")&&x(t,e),s[e.getAttribute("id")]=e;return s},parseAttributes:function(t,n,a){if(t){var o,f,p,m={};void 0===a&&(a=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(m=e.parseAttributes(t.parentNode,n,a));var v=n.reduce((function(e,i){return(o=t.getAttribute(i))&&(e[i]=o),e}),{}),b=i(function(t,i){var n={};for(var s in e.cssRules[i])if(g(t,s.split(" ")))for(var r in e.cssRules[i][s])n[r]=e.cssRules[i][s][r];return n}(t,a),e.parseStyleAttribute(t));v=i(v,b),b[h]&&t.setAttribute(h,b[h]),f=p=m.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,v[c]&&(v[c]=f=r(v[c],p));var y,x,w={};for(var C in v)x=u(y=d(C),v[C],m,f),w[y]=x;w&&w.font&&e.parseFontDeclaration(w.font,w);var S=i(m,w);return e.svgValidParentsRegEx.test(t.nodeName)?S:function(t){for(var i in l)if(void 0!==t[l[i]]&&""!==t[i]){if(void 0===t[i]){if(!e.Object.prototype[i])continue;t[i]=e.Object.prototype[i]}if(0!==t[i].indexOf("url(")){var n=new e.Color(t[i]);t[i]=n.setAlpha(s(n.getAlpha()*t[l[i]],2)).toRgba()}}return t}(S)}},parseElements:function(t,i,n,s,r){new e.ElementsParser(t,i,n,s,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?function(t,e){var i,n;t.replace(/;\s*$/,"").split(";").forEach((function(t){var s=t.split(":");i=s[0].trim().toLowerCase(),n=s[1].trim(),e[i]=n}))}(i,e):function(t,e){var i,n;for(var s in t)void 0!==t[s]&&(i=s.toLowerCase(),n=t[s],e[i]=n)}(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;var e,i,n=[];for(e=0,i=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<i;e+=2)n.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return n},getCSSRules:function(t){var i,n,s=t.getElementsByTagName("style"),r={};for(i=0,n=s.length;i<n;i++){var a=s[i].textContent;""!==(a=a.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&a.split("}").filter((function(t){return t.trim()})).forEach((function(t){var s=t.split("{"),a={},o=s[1].trim().split(";").filter((function(t){return t.trim()}));for(i=0,n=o.length;i<n;i++){var l=o[i].split(":"),c=l[0].trim(),h=l[1].trim();a[c]=h}(t=s[0].trim()).split(",").forEach((function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(r[t]?e.util.object.extend(r[t],a):r[t]=e.util.object.clone(a))}))}))}return r},loadSVGFromURL:function(t,i,n,s){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var r=t.responseXML;if(!r||!r.documentElement)return i&&i(null),!1;e.parseSVGDocument(r.documentElement,(function(t,e,n,s){i&&i(t,e,n,s)}),n,s)}})},loadSVGFromString:function(t,i,n,s){var r=(new e.window.DOMParser).parseFromString(t.trim(),"text/xml");e.parseSVGDocument(r.documentElement,(function(t,e,n,s){i(t,e,n,s)}),n,s)}})}(e),E.ElementsParser=function(t,e,i,n,s,r){this.elements=t,this.callback=e,this.options=i,this.reviver=n,this.svgUid=i&&i.svgUid||0,this.parsingOptions=s,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r},(m=E.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},m.createObjects=function(){var t=this;this.elements.forEach((function(e,i){e.setAttribute("svgUid",t.svgUid),t.createObject(e,i)}))},m.findTag=function(t){return E[E.util.string.capitalize(t.tagName.replace("svg:",""))]},m.createObject=function(t,e){var i=this.findTag(t);if(i&&i.fromElement)try{i.fromElement(t,this.createCallback(e,t),this.options)}catch(t){E.log(t)}else this.checkIfDone()},m.createCallback=function(t,e){var i=this;return function(n){var s;i.resolveGradient(n,e,"fill"),i.resolveGradient(n,e,"stroke"),n instanceof E.Image&&n._originalElement&&(s=n.parsePreserveAspectRatioAttribute(e)),n._removeTransformMatrix(s),i.resolveClipPath(n,e),i.reviver&&i.reviver(e,n),i.instances[t]=n,i.checkIfDone()}},m.extractPropertyDefinition=function(t,e,i){var n=t[e],s=this.regexUrl;if(s.test(n)){s.lastIndex=0;var r=s.exec(n)[1];return s.lastIndex=0,E[i][this.svgUid][r]}},m.resolveGradient=function(t,e,i){var n=this.extractPropertyDefinition(t,i,"gradientDefs");if(n){var s=e.getAttribute(i+"-opacity"),r=E.Gradient.fromElement(n,t,s,this.options);t.set(i,r)}},m.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},m.resolveClipPath=function(t,e){var i,n,s,r,a=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(a){s=[],n=E.util.invertTransform(t.calcTransformMatrix());for(var o=a[0].parentNode,l=e;l.parentNode&&l.getAttribute("clip-path")!==t.clipPath;)l=l.parentNode;l.parentNode.appendChild(o);for(var c=0;c<a.length;c++)i=a[c],this.findTag(i).fromElement(i,this.createClipPathCallback(t,s),this.options);a=1===s.length?s[0]:new E.Group(s),r=E.util.multiplyTransformMatrices(n,a.calcTransformMatrix()),a.clipPath&&this.resolveClipPath(a,l);var h=E.util.qrDecompose(r);a.flipX=!1,a.flipY=!1,a.set("scaleX",h.scaleX),a.set("scaleY",h.scaleY),a.angle=h.angle,a.skewX=h.skewX,a.skewY=0,a.setPositionByOrigin({x:h.translateX,y:h.translateY},"center","center"),t.clipPath=a}else delete t.clipPath},m.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))},function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=i,i.prototype={type:"point",constructor:i,add:function(t){return new i(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new i(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new i(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new i(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new i(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new i(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new i(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new i(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i},clone:function(){return new i(this.x,this.y)}})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=i,e.Intersection.prototype={constructor:i,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,n,s,r){var a,o=(r.x-s.x)*(t.y-s.y)-(r.y-s.y)*(t.x-s.x),l=(n.x-t.x)*(t.y-s.y)-(n.y-t.y)*(t.x-s.x),c=(r.y-s.y)*(n.x-t.x)-(r.x-s.x)*(n.y-t.y);if(0!==c){var h=o/c,d=l/c;0<=h&&h<=1&&0<=d&&d<=1?(a=new i("Intersection")).appendPoint(new e.Point(t.x+h*(n.x-t.x),t.y+h*(n.y-t.y))):a=new i}else a=new i(0===o||0===l?"Coincident":"Parallel");return a},e.Intersection.intersectLinePolygon=function(t,e,n){var s,r,a,o,l=new i,c=n.length;for(o=0;o<c;o++)s=n[o],r=n[(o+1)%c],a=i.intersectLineLine(t,e,s,r),l.appendPoints(a.points);return l.points.length>0&&(l.status="Intersection"),l},e.Intersection.intersectPolygonPolygon=function(t,e){var n,s=new i,r=t.length;for(n=0;n<r;n++){var a=t[n],o=t[(n+1)%r],l=i.intersectLinePolygon(a,o,e);s.appendPoints(l.points)}return s.points.length>0&&(s.status="Intersection"),s},e.Intersection.intersectPolygonRectangle=function(t,n,s){var r=n.min(s),a=n.max(s),o=new e.Point(a.x,r.y),l=new e.Point(r.x,a.y),c=i.intersectLinePolygon(r,o,t),h=i.intersectLinePolygon(o,a,t),d=i.intersectLinePolygon(a,l,t),u=i.intersectLinePolygon(l,r,t),f=new i;return f.appendPoints(c.points),f.appendPoints(h.points),f.appendPoints(d.points),f.appendPoints(u.points),f.points.length>0&&(f.status="Intersection"),f})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function i(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function n(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=i,e.Color.prototype={_tryParsingColor:function(t){var e;t in i.colorNameMap&&(t=i.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=i.sourceFromHex(t)),e||(e=i.sourceFromRgb(t)),e||(e=i.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,i,n){t/=255,i/=255,n/=255;var s,r,a,o=e.util.array.max([t,i,n]),l=e.util.array.min([t,i,n]);if(a=(o+l)/2,o===l)s=r=0;else{var c=o-l;switch(r=a>.5?c/(2-o-l):c/(o+l),o){case t:s=(i-n)/c+(i<n?6:0);break;case i:s=(n-t)/c+2;break;case n:s=(t-i)/c+4}s/=6}return[Math.round(360*s),Math.round(100*r),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,n=this.getSource();return t=1===(t=n[0].toString(16)).length?"0"+t:t,e=1===(e=n[1].toString(16)).length?"0"+e:e,i=1===(i=n[2].toString(16)).length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),n=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,n]),this},overlayWith:function(t){t instanceof i||(t=new i(t));var e,n=[],s=this.getAlpha(),r=this.getSource(),a=t.getSource();for(e=0;e<3;e++)n.push(Math.round(.5*r[e]+.5*a[e]));return n[3]=s,this.setSource(n),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return i.fromSource(i.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(i.reRGBa);if(e){var n=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),s=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),r=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(n,10),parseInt(s,10),parseInt(r,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=i.fromRgb,e.Color.fromHsl=function(t){return i.fromSource(i.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(i.reHSLa);if(e){var s,r,a,o=(parseFloat(e[1])%360+360)%360/360,l=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===l)s=r=a=c;else{var h=c<=.5?c*(l+1):c+l-c*l,d=2*c-h;s=n(d,h,o+1/3),r=n(d,h,o),a=n(d,h,o-1/3)}return[Math.round(255*s),Math.round(255*r),Math.round(255*a),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=i.fromHsl,e.Color.fromHex=function(t){return i.fromSource(i.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(i.reHex)){var e=t.slice(t.indexOf("#")+1),n=3===e.length||4===e.length,s=8===e.length||4===e.length,r=n?e.charAt(0)+e.charAt(0):e.substring(0,2),a=n?e.charAt(1)+e.charAt(1):e.substring(2,4),o=n?e.charAt(2)+e.charAt(2):e.substring(4,6),l=s?n?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(r,16),parseInt(a,16),parseInt(o,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new i;return e.setSource(t),e})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=["e","se","s","sw","w","nw","n","ne","e"],n=["ns","nesw","ew","nwse"],s={},r="left",a="top",o="right",l="bottom",c="center",h={top:l,bottom:a,left:o,right:r,center:c},d=e.util.radiansToDegrees,u=Math.sign||function(t){return(t>0)-(t<0)||+t};function f(t,e){var i=t.angle+d(Math.atan2(e.y,e.x))+360;return Math.round(i%360/45)}function p(t,i){var n=i.transform.target,s=n.canvas,r=e.util.object.clone(i);r.target=n,s&&s.fire("object:"+t,r),n.fire(t,i)}function g(t,e){var i=e.canvas,n=t[i.uniScaleKey];return i.uniformScaling&&!n||!i.uniformScaling&&n}function m(t){return t.originX===c&&t.originY===c}function v(t,e,i){var n=t.lockScalingX,s=t.lockScalingY;return!((!n||!s)&&(e||!n&&!s||!i)&&(!n||"x"!==e)&&(!s||"y"!==e))}function b(t,e,i,n){return{e:t,transform:e,pointer:{x:i,y:n}}}function y(t){return function(e,i,n,s){var r=i.target,a=r.getCenterPoint(),o=r.translateToOriginPoint(a,i.originX,i.originY),l=t(e,i,n,s);return r.setPositionByOrigin(o,i.originX,i.originY),l}}function x(t,e){return function(i,n,s,r){var a=e(i,n,s,r);return a&&p(t,b(i,n,s,r)),a}}function w(t,i,n,s,r){var a=t.target,o=a.controls[t.corner],l=a.canvas.getZoom(),c=a.padding/l,h=a.toLocalPoint(new e.Point(s,r),i,n);return h.x>=c&&(h.x-=c),h.x<=-c&&(h.x+=c),h.y>=c&&(h.y-=c),h.y<=c&&(h.y+=c),h.x-=o.offsetX,h.y-=o.offsetY,h}function C(t){return t.flipX!==t.flipY}function S(t,e,i,n,s){if(0!==t[e]){var r=s/t._getTransformedDimensions()[n]*t[i];t.set(i,r)}}function T(t,e,i,n){var s,c=e.target,h=c._getTransformedDimensions(0,c.skewY),u=w(e,e.originX,e.originY,i,n),f=Math.abs(2*u.x)-h.x,p=c.skewX;f<2?s=0:(s=d(Math.atan2(f/c.scaleX,h.y/c.scaleY)),e.originX===r&&e.originY===l&&(s=-s),e.originX===o&&e.originY===a&&(s=-s),C(c)&&(s=-s));var g=p!==s;if(g){var m=c._getTransformedDimensions().y;c.set("skewX",s),S(c,"skewY","scaleY","y",m)}return g}function E(t,e,i,n){var s,c=e.target,h=c._getTransformedDimensions(c.skewX,0),u=w(e,e.originX,e.originY,i,n),f=Math.abs(2*u.y)-h.y,p=c.skewY;f<2?s=0:(s=d(Math.atan2(f/c.scaleY,h.x/c.scaleX)),e.originX===r&&e.originY===l&&(s=-s),e.originX===o&&e.originY===a&&(s=-s),C(c)&&(s=-s));var g=p!==s;if(g){var m=c._getTransformedDimensions().x;c.set("skewY",s),S(c,"skewX","scaleX","x",m)}return g}function A(t,e,i,n,s){s=s||{};var r,a,o,l,c,d,f=e.target,p=f.lockScalingX,b=f.lockScalingY,y=s.by,x=g(t,f),C=v(f,y,x),S=e.gestureScale;if(C)return!1;if(S)a=e.scaleX*S,o=e.scaleY*S;else{if(r=w(e,e.originX,e.originY,i,n),c="y"!==y?u(r.x):1,d="x"!==y?u(r.y):1,e.signX||(e.signX=c),e.signY||(e.signY=d),f.lockScalingFlip&&(e.signX!==c||e.signY!==d))return!1;if(l=f._getTransformedDimensions(),x&&!y){var T=Math.abs(r.x)+Math.abs(r.y),E=e.original,A=T/(Math.abs(l.x*E.scaleX/f.scaleX)+Math.abs(l.y*E.scaleY/f.scaleY));a=E.scaleX*A,o=E.scaleY*A}else a=Math.abs(r.x*f.scaleX/l.x),o=Math.abs(r.y*f.scaleY/l.y);m(e)&&(a*=2,o*=2),e.signX!==c&&"y"!==y&&(e.originX=h[e.originX],a*=-1,e.signX=c),e.signY!==d&&"x"!==y&&(e.originY=h[e.originY],o*=-1,e.signY=d)}var I=f.scaleX,O=f.scaleY;return y?("x"===y&&f.set("scaleX",a),"y"===y&&f.set("scaleY",o)):(!p&&f.set("scaleX",a),!b&&f.set("scaleY",o)),I!==f.scaleX||O!==f.scaleY}s.scaleCursorStyleHandler=function(t,e,n){var s=g(t,n),r="";if(0!==e.x&&0===e.y?r="x":0===e.x&&0!==e.y&&(r="y"),v(n,r,s))return"not-allowed";var a=f(n,e);return i[a]+"-resize"},s.skewCursorStyleHandler=function(t,e,i){var s="not-allowed";if(0!==e.x&&i.lockSkewingY)return s;if(0!==e.y&&i.lockSkewingX)return s;var r=f(i,e)%4;return n[r]+"-resize"},s.scaleSkewCursorStyleHandler=function(t,e,i){return t[i.canvas.altActionKey]?s.skewCursorStyleHandler(t,e,i):s.scaleCursorStyleHandler(t,e,i)},s.rotationWithSnapping=x("rotating",y((function(t,e,i,n){var s=e,r=s.target,a=r.translateToOriginPoint(r.getCenterPoint(),s.originX,s.originY);if(r.lockRotation)return!1;var o,l=Math.atan2(s.ey-a.y,s.ex-a.x),c=Math.atan2(n-a.y,i-a.x),h=d(c-l+s.theta);if(r.snapAngle>0){var u=r.snapAngle,f=r.snapThreshold||u,p=Math.ceil(h/u)*u,g=Math.floor(h/u)*u;Math.abs(h-g)<f?h=g:Math.abs(h-p)<f&&(h=p)}return h<0&&(h=360+h),h%=360,o=r.angle!==h,r.angle=h,o}))),s.scalingEqually=x("scaling",y((function(t,e,i,n){return A(t,e,i,n)}))),s.scalingX=x("scaling",y((function(t,e,i,n){return A(t,e,i,n,{by:"x"})}))),s.scalingY=x("scaling",y((function(t,e,i,n){return A(t,e,i,n,{by:"y"})}))),s.scalingYOrSkewingX=function(t,e,i,n){return t[e.target.canvas.altActionKey]?s.skewHandlerX(t,e,i,n):s.scalingY(t,e,i,n)},s.scalingXOrSkewingY=function(t,e,i,n){return t[e.target.canvas.altActionKey]?s.skewHandlerY(t,e,i,n):s.scalingX(t,e,i,n)},s.changeWidth=x("resizing",y((function(t,e,i,n){var s=e.target,r=w(e,e.originX,e.originY,i,n),a=s.strokeWidth/(s.strokeUniform?s.scaleX:1),o=m(e)?2:1,l=s.width,c=Math.abs(r.x*o/s.scaleX)-a;return s.set("width",Math.max(c,0)),l!==c}))),s.skewHandlerX=function(t,e,i,n){var s,l=e.target,h=l.skewX,d=e.originY;return!l.lockSkewingX&&(0===h?s=w(e,c,c,i,n).x>0?r:o:(h>0&&(s=d===a?r:o),h<0&&(s=d===a?o:r),C(l)&&(s=s===r?o:r)),e.originX=s,x("skewing",y(T))(t,e,i,n))},s.skewHandlerY=function(t,e,i,n){var s,o=e.target,h=o.skewY,d=e.originX;return!o.lockSkewingY&&(0===h?s=w(e,c,c,i,n).y>0?a:l:(h>0&&(s=d===r?a:l),h<0&&(s=d===r?l:a),C(o)&&(s=s===a?l:a)),e.originY=s,x("skewing",y(E))(t,e,i,n))},s.dragHandler=function(t,e,i,n){var s=e.target,r=i-e.offsetX,a=n-e.offsetY,o=!s.get("lockMovementX")&&s.left!==r,l=!s.get("lockMovementY")&&s.top!==a;return o&&s.set("left",r),l&&s.set("top",a),(o||l)&&p("moving",b(t,e,i,n)),o||l},s.scaleOrSkewActionName=function(t,e,i){var n=t[i.canvas.altActionKey];return 0===e.x?n?"skewX":"scaleY":0===e.y?n?"skewY":"scaleX":void 0},s.rotationStyleHandler=function(t,e,i){return i.lockRotation?"not-allowed":e.cursorStyle},s.fireEvent=p,s.wrapWithFixedAnchor=y,s.wrapWithFireEvent=x,s.getLocalPoint=w,e.controlsUtils=s}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.degreesToRadians,n=e.controlsUtils;n.renderCircleControl=function(t,e,i,n,s){n=n||{};var r,a=this.sizeX||n.cornerSize||s.cornerSize,o=this.sizeY||n.cornerSize||s.cornerSize,l=void 0!==n.transparentCorners?n.transparentCorners:s.transparentCorners,c=l?"stroke":"fill",h=!l&&(n.cornerStrokeColor||s.cornerStrokeColor),d=e,u=i;t.save(),t.fillStyle=n.cornerColor||s.cornerColor,t.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor,a>o?(r=a,t.scale(1,o/a),u=i*a/o):o>a?(r=o,t.scale(a/o,1),d=e*o/a):r=a,t.lineWidth=1,t.beginPath(),t.arc(d,u,r/2,0,2*Math.PI,!1),t[c](),h&&t.stroke(),t.restore()},n.renderSquareControl=function(t,e,n,s,r){s=s||{};var a=this.sizeX||s.cornerSize||r.cornerSize,o=this.sizeY||s.cornerSize||r.cornerSize,l=void 0!==s.transparentCorners?s.transparentCorners:r.transparentCorners,c=l?"stroke":"fill",h=!l&&(s.cornerStrokeColor||r.cornerStrokeColor),d=a/2,u=o/2;t.save(),t.fillStyle=s.cornerColor||r.cornerColor,t.strokeStyle=s.cornerStrokeColor||r.cornerStrokeColor,t.lineWidth=1,t.translate(e,n),t.rotate(i(r.angle)),t[c+"Rect"](-d,-u,a,o),h&&t.strokeRect(-d,-u,a,o),t.restore()}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Control=function(t){for(var e in t)this[e]=t[e]},e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){var i=t._controlsVisibility;return i&&void 0!==i[e]?i[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,i){return e.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},i)},calcCornerCoords:function(t,i,n,s,r){var a,o,l,c,h=r?this.touchSizeX:this.sizeX,d=r?this.touchSizeY:this.sizeY;if(h&&d&&h!==d){var u=Math.atan2(d,h),f=Math.sqrt(h*h+d*d)/2,p=u-e.util.degreesToRadians(t),g=Math.PI/2-u-e.util.degreesToRadians(t);a=f*e.util.cos(p),o=f*e.util.sin(p),l=f*e.util.cos(g),c=f*e.util.sin(g)}else f=.7071067812*(h&&d?h:i),p=e.util.degreesToRadians(45-t),a=l=f*e.util.cos(p),o=c=f*e.util.sin(p);return{tl:{x:n-c,y:s-l},tr:{x:n+a,y:s-o},bl:{x:n-a,y:s+o},br:{x:n+c,y:s+l}}},render:function(t,i,n,s,r){"circle"===((s=s||{}).cornerStyle||r.cornerStyle)?e.controlsUtils.renderCircleControl.call(this,t,i,n,s,r):e.controlsUtils.renderSquareControl.call(this,t,i,n,s,r)}}}(e),function(){function t(t,e){var i,n,s,r,a=t.getAttribute("style"),o=t.getAttribute("offset")||0;if(o=(o=parseFloat(o)/(/%$/.test(o)?100:1))<0?0:o>1?1:o,a){var l=a.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),r=l.length;r--;){var c=l[r].split(/\s*:\s*/),h=c[0].trim(),d=c[1].trim();"stop-color"===h?i=d:"stop-opacity"===h&&(s=d)}}return i||(i=t.getAttribute("stop-color")||"rgb(0,0,0)"),s||(s=t.getAttribute("stop-opacity")),n=(i=new E.Color(i)).getAlpha(),s=isNaN(parseFloat(s))?1:parseFloat(s),s*=n*e,{offset:o,color:i.toRgb(),opacity:s}}var e=E.util.object.clone;E.Gradient=E.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,i=this;Object.keys(t).forEach((function(e){i[e]=t[e]})),this.id?this.id+="_"+E.Object.__uid++:this.id=E.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var i=new E.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return E.util.populateWithProperties(this,e,t),e},toSVG:function(t,i){var n,s,r,a,o=e(this.coords,!0),l=(i=i||{},e(this.colorStops,!0)),c=o.r1>o.r2,h=this.gradientTransform?this.gradientTransform.concat():E.iMatrix.concat(),d=-this.offsetX,u=-this.offsetY,f=!!i.additionalTransform,p="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(t,e){return t.offset-e.offset})),"objectBoundingBox"===p?(d/=t.width,u/=t.height):(d+=t.width/2,u+=t.height/2),"path"===t.type&&"percentage"!==this.gradientUnits&&(d-=t.pathOffset.x,u-=t.pathOffset.y),h[4]-=d,h[5]-=u,a='id="SVGID_'+this.id+'" gradientUnits="'+p+'"',a+=' gradientTransform="'+(f?i.additionalTransform+" ":"")+E.util.matrixToSVG(h)+'" ',"linear"===this.type?r=["<linearGradient ",a,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'">\n']:"radial"===this.type&&(r=["<radialGradient ",a,' cx="',c?o.x1:o.x2,'" cy="',c?o.y1:o.y2,'" r="',c?o.r1:o.r2,'" fx="',c?o.x2:o.x1,'" fy="',c?o.y2:o.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),n=0,s=l.length;n<s;n++)l[n].offset=1-l[n].offset;var g=Math.min(o.r1,o.r2);if(g>0){var m=g/Math.max(o.r1,o.r2);for(n=0,s=l.length;n<s;n++)l[n].offset+=m*(1-l[n].offset)}}for(n=0,s=l.length;n<s;n++){var v=l[n];r.push("<stop ",'offset="',100*v.offset+"%",'" style="stop-color:',v.color,void 0!==v.opacity?";stop-opacity: "+v.opacity:";",'"/>\n')}return r.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),r.join("")},toLive:function(t){var e,i,n,s=E.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(s.x1,s.y1,s.x2,s.y2):"radial"===this.type&&(e=t.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2)),i=0,n=this.colorStops.length;i<n;i++){var r=this.colorStops[i].color,a=this.colorStops[i].opacity,o=this.colorStops[i].offset;void 0!==a&&(r=new E.Color(r).setAlpha(a).toRgba()),e.addColorStop(o,r)}return e}}}),E.util.object.extend(E.Gradient,{fromElement:function(e,i,n,s){var r=parseFloat(n)/(/%$/.test(n)?100:1);r=r<0?0:r>1?1:r,isNaN(r)&&(r=1);var a,o,l,c,h=e.getElementsByTagName("stop"),d="userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage",u=e.getAttribute("gradientTransform")||"",f=[],p=0,g=0;for("linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?(a="linear",o=function(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}(e)):(a="radial",o=function(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}(e)),l=h.length;l--;)f.push(t(h[l],r));return c=E.parseTransformAttribute(u),function(t,e,i,n){var s,r;Object.keys(e).forEach((function(t){"Infinity"===(s=e[t])?r=1:"-Infinity"===s?r=0:(r=parseFloat(e[t],10),"string"==typeof s&&/^(\d+\.\d+)%|(\d+)%$/.test(s)&&(r*=.01,"pixels"===n&&("x1"!==t&&"x2"!==t&&"r2"!==t||(r*=i.viewBoxWidth||i.width),"y1"!==t&&"y2"!==t||(r*=i.viewBoxHeight||i.height)))),e[t]=r}))}(0,o,s,d),"pixels"===d&&(p=-i.left,g=-i.top),new E.Gradient({id:e.getAttribute("id"),type:a,coords:o,colorStops:f,gradientUnits:d,gradientTransform:c,offsetX:p,offsetY:g})}})}(),function(){"use strict";var t=E.util.toFixed;E.Pattern=E.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=E.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)e&&e(this);else{var i=this;this.source=E.util.createImage(),E.util.loadImage(t.source,(function(t,n){i.source=t,e&&e(i,n)}),null,this.crossOrigin)}},toObject:function(e){var i,n,s=E.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?i=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(i=this.source.toDataURL()),n={type:"pattern",source:i,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,s),offsetY:t(this.offsetY,s),patternTransform:this.patternTransform?this.patternTransform.concat():null},E.util.populateWithProperties(this,n,e),n},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.width,n=e.height/t.height,s=this.offsetX/t.width,r=this.offsetY/t.height,a="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,r&&(n+=Math.abs(r))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,s&&(i+=Math.abs(s))),e.src?a=e.src:e.toDataURL&&(a=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+r+'" width="'+i+'" height="'+n+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e=this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var i in"string"==typeof t&&(t=this._parseShadow(t)),t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),n=e.Shadow.reOffsetsAndBlur.exec(i)||[];return{color:(i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(n[1],10)||0,offsetY:parseFloat(n[2],10)||0,blur:parseFloat(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var n=40,s=40,r=e.Object.NUM_FRACTION_DIGITS,a=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),o=new e.Color(this.color);return t.width&&t.height&&(n=100*i((Math.abs(a.x)+this.blur)/t.width,r)+20,s=100*i((Math.abs(a.y)+this.blur)/t.height,r)+20),t.flipX&&(a.x*=-1),t.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+i(this.blur?this.blur/2:0,r)+'"></feGaussianBlur>\n\t<feOffset dx="'+i(a.x,r)+'" dy="'+i(a.y,r)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+o.toRgb()+'" flood-opacity="'+o.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var t={},i=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(e){this[e]!==i[e]&&(t[e]=this[e])}),this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){"use strict";if(E.StaticCanvas)E.warn("fabric.StaticCanvas is already defined.");else{var t=E.util.object.extend,e=E.util.getElementOffset,i=E.util.removeFromArray,n=E.util.toFixed,s=E.util.transformPoint,r=E.util.invertTransform,a=E.util.getNodeCanvas,o=E.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");E.StaticCanvas=E.util.createClass(E.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:E.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var i=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,i),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,i),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,i),e.overlayColor&&this.setOverlayColor(e.overlayColor,i),this.calcOffset()},_isRetinaScaling:function(){return E.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,E.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var t=E.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,e,i){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),i.scale(t,t)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(t,e,i,n){return"string"==typeof e?E.util.loadImage(e,(function(e,s){if(e){var r=new E.Image(e,n);this[t]=r,r.canvas=this}i&&i(e,s)}),this,n&&n.crossOrigin):(n&&e.setOptions(n),this[t]=e,e&&(e.canvas=this),i&&i(e,!1)),this},__setBgOverlayColor:function(t,e,i){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,i),this},_createCanvasElement:function(){var t=o();if(!t)throw l;if(t.style||(t.style={}),void 0===t.getContext)throw l;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=E.util.getById(t)||this._createCanvasElement(),E.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;for(var n in e=e||{},t)i=t[n],e.cssOnly||(this._setBackstoreDimension(n,t[n]),i+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(n,i);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,i,n,s=this._activeObject,r=this.backgroundImage,a=this.overlayImage;for(this.viewportTransform=t,i=0,n=this._objects.length;i<n;i++)(e=this._objects[i]).group||e.setCoords(!0);return s&&s.setCoords(),r&&r.setCoords(!0),a&&a.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var i=t,n=this.viewportTransform.slice(0);t=s(t,r(this.viewportTransform)),n[0]=e,n[3]=e;var a=s(t,n);return n[4]+=i.x-a.x,n[5]+=i.y-a.y,this.setViewportTransform(n)},setZoom:function(t){return this.zoomToPoint(new E.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new E.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=E.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,i=this.height,n=r(this.viewportTransform);return t.tl=s({x:0,y:0},n),t.br=s({x:e,y:i},n),t.tr=new E.Point(t.br.x,t.tl.y),t.bl=new E.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(E.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var i=this.viewportTransform,n=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),E.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),n&&(n.canvas=this,n.shouldCache(),n._transformDone=!0,n.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,i=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var i,n;for(i=0,n=e.length;i<n;++i)e[i]&&e[i].render(t)},_renderBackgroundOrOverlay:function(t,e){var i=this[e+"Color"],n=this[e+"Image"],s=this.viewportTransform,r=this[e+"Vpt"];if(i||n){if(i){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=i.toLive?i.toLive(t,this):i,r&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),t.transform(1,0,0,1,i.offsetX||0,i.offsetY||0);var a=i.gradientTransform||i.patternTransform;a&&t.transform(a[0],a[1],a[2],a[3],a[4],a[5]),t.fill(),t.restore()}n&&(t.save(),r&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),n.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new E.Point(this.width/2,this.height/2)},centerObjectH:function(t){return this._centerObject(t,new E.Point(this.getCenterPoint().x,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new E.Point(t.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(t){var e=this.getCenterPoint();return this._centerObject(t,e)},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new E.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new E.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenterPoint(),e=r(this.viewportTransform);return s(t,e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var n=this.clipPath,s={version:E.version,objects:this._toObjects(e,i)};return n&&!n.excludeFromExport&&(s.clipPath=this._toObject(this.clipPath,e,i)),t(s,this.__serializeBgOverlay(e,i)),E.util.populateWithProperties(this,s,i),s},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(i){return this._toObject(i,t,e)}),this)},_toObject:function(t,e,i){var n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);var s=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=n),s},__serializeBgOverlay:function(t,e){var i={},n=this.backgroundImage,s=this.overlayImage,r=this.backgroundColor,a=this.overlayColor;return r&&r.toObject?r.excludeFromExport||(i.background=r.toObject(e)):r&&(i.background=r),a&&a.toObject?a.excludeFromExport||(i.overlay=a.toObject(e)):a&&(i.overlay=a),n&&!n.excludeFromExport&&(i.backgroundImage=this._toObject(n,t,e)),s&&!s.excludeFromExport&&(i.overlayImage=this._toObject(s,t,e)),i},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={}),t.reviver=e;var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this.clipPath&&i.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(i,"background"),this._setSVGBgOverlayImage(i,"backgroundImage",e),this._setSVGObjects(i,e),this.clipPath&&i.push("</g>\n"),this._setSVGBgOverlayColor(i,"overlay"),this._setSVGBgOverlayImage(i,"overlayImage",e),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,s=e.width||this.width,r=e.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',o=E.Object.NUM_FRACTION_DIGITS;e.viewBox?a='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(i=this.viewportTransform,a='viewBox="'+n(-i[4]/i[0],o)+" "+n(-i[5]/i[3],o)+" "+n(this.width/i[0],o)+" "+n(this.height/i[3],o)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',s,'" ','height="',r,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",E.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+E.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var t=this;return["background","overlay"].map((function(e){var i=t[e+"Color"];if(i&&i.toLive){var n=t[e+"Vpt"],s=t.viewportTransform,r={width:t.width/(n?s[0]:1),height:t.height/(n?s[3]:1)};return i.toSVG(r,{additionalTransform:n?E.util.matrixToSVG(s):""})}})).join("")},createSVGFontFacesMarkup:function(){var t,e,i,n,s,r,a,o,l="",c={},h=E.fontPaths,d=[];for(this._objects.forEach((function t(e){d.push(e),e._objects&&e._objects.forEach(t)})),a=0,o=d.length;a<o;a++)if(e=(t=d[a]).fontFamily,-1!==t.type.indexOf("text")&&!c[e]&&h[e]&&(c[e]=!0,t.styles))for(s in i=t.styles)for(r in n=i[s])!c[e=n[r].fontFamily]&&h[e]&&(c[e]=!0);for(var u in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",u,"';\n","\t\t\tsrc: url('",h[u],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(t,e){var i,n,s,r=this._objects;for(n=0,s=r.length;n<s;n++)(i=r[n]).excludeFromExport||this._setSVGObject(t,i,e)},_setSVGObject:function(t,e,i){t.push(e.toSVG(i))},_setSVGBgOverlayImage:function(t,e,i){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(i))},_setSVGBgOverlayColor:function(t,e){var i=this[e+"Color"],n=this.viewportTransform,s=this.width,r=this.height;if(i)if(i.toLive){var a=i.repeat,o=E.util.invertTransform(n),l=this[e+"Vpt"]?E.util.matrixToSVG(o):"";t.push('<rect transform="'+l+" translate(",s/2,",",r/2,')"',' x="',i.offsetX-s/2,'" y="',i.offsetY-r/2,'" ','width="',"repeat-y"===a||"no-repeat"===a?i.source.width:s,'" height="',"repeat-x"===a||"no-repeat"===a?i.source.height:r,'" fill="url(#SVGID_'+i.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',i,'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,n,s,r=this._activeObject;if(t===r&&"activeSelection"===t.type)for(e=(s=r._objects).length;e--;)n=s[e],i(this._objects,n),this._objects.unshift(n);else i(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,n,s,r=this._activeObject;if(t===r&&"activeSelection"===t.type)for(s=r._objects,e=0;e<s.length;e++)n=s[e],i(this._objects,n),this._objects.push(n);else i(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var n,s,r,a,o,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(o=l._objects,n=0;n<o.length;n++)s=o[n],(r=this._objects.indexOf(s))>0+c&&(a=r-1,i(this._objects,s),this._objects.splice(a,0,s)),c++;else 0!==(r=this._objects.indexOf(t))&&(a=this._findNewLowerIndex(t,r,e),i(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,i){var n,s;if(i){for(n=e,s=e-1;s>=0;--s)if(t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t)){n=s;break}}else n=e-1;return n},bringForward:function(t,e){if(!t)return this;var n,s,r,a,o,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(n=(o=l._objects).length;n--;)s=o[n],(r=this._objects.indexOf(s))<this._objects.length-1-c&&(a=r+1,i(this._objects,s),this._objects.splice(a,0,s)),c++;else(r=this._objects.indexOf(t))!==this._objects.length-1&&(a=this._findNewUpperIndex(t,r,e),i(this._objects,t),this._objects.splice(a,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,i){var n,s,r;if(i){for(n=e,s=e+1,r=this._objects.length;s<r;++s)if(t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t)){n=s;break}}else n=e+1;return n},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(E.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),E.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),E.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(E.StaticCanvas.prototype,E.Observable),t(E.StaticCanvas.prototype,E.Collection),t(E.StaticCanvas.prototype,E.DataURLExporter),t(E.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=o();if(!e||!e.getContext)return null;var i=e.getContext("2d");return i&&"setLineDash"===t?void 0!==i.setLineDash:null}}),E.StaticCanvas.prototype.toJSON=E.StaticCanvas.prototype.toObject,E.isLikelyNode&&(E.StaticCanvas.prototype.createPNGStream=function(){var t=a(this.lowerCanvasEl);return t&&t.createPNGStream()},E.StaticCanvas.prototype.createJPEGStream=function(t){var e=a(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),E.BaseBrush=E.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,i=t.contextTop,n=t.getZoom();t&&t._isRetinaScaling()&&(n*=E.devicePixelRatio),i.shadowColor=e.color,i.shadowBlur=e.blur*n,i.shadowOffsetX=e.offsetX*n,i.shadowOffsetY=e.offsetY*n}},needsFullRender:function(){return new E.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}),E.PencilBrush=E.util.createClass(E.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,i){var n=e.midPointFrom(i);return t.quadraticCurveTo(e.x,e.y,n.x,n.y),n},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var i=this._points,n=i.length,s=this.canvas.contextTop;this._saveAndTransform(s),this.oldEnd&&(s.beginPath(),s.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(s,i[n-2],i[n-1],!0),s.stroke(),s.restore()}},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){var e=new E.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new E.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,i,n=this._points[0],s=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),2===this._points.length&&n.x===s.x&&n.y===s.y){var r=this.width/1e3;n=new E.Point(n.x,n.y),s=new E.Point(s.x,s.y),n.x-=r,s.x+=r}for(t.moveTo(n.x,n.y),e=1,i=this._points.length;e<i;e++)this._drawSegment(t,n,s),n=this._points[e],s=this._points[e+1];t.lineTo(n.x,n.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return E.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){return"M 0 0 Q 0 0 0 0 L 0 0"===E.util.joinPath(t)},createPath:function(t){var e=new E.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new E.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var i,n=this.canvas.getZoom(),s=Math.pow(e/n,2),r=t.length-1,a=t[0],o=[a];for(i=1;i<r-1;i++)Math.pow(a.x-t[i].x,2)+Math.pow(a.y-t[i].y,2)>=s&&(a=t[i],o.push(a));return o.push(t[r]),o},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t))this.canvas.requestRenderAll();else{var e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}}),E.CircleBrush=E.util.createClass(E.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;this._saveAndTransform(i),this.dot(i,e),i.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,i=this.canvas.contextTop,n=this.points;for(this._saveAndTransform(i),t=0,e=n.length;t<e;t++)this.dot(i,n[t]);i.restore()},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t,e,i=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var n=[];for(t=0,e=this.points.length;t<e;t++){var s=this.points[t],r=new E.Circle({radius:s.radius,left:s.x,top:s.y,originX:"center",originY:"center",fill:s.fill});this.shadow&&(r.shadow=new E.Shadow(this.shadow)),n.push(r)}var a=new E.Group(n);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=i,this.canvas.requestRenderAll()},addPoint:function(t){var e=new E.Point(t.x,t.y),i=E.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,n=new E.Color(this.color).setAlpha(E.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=n,this.points.push(e),e}}),E.SprayBrush=E.util.createClass(E.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.sprayChunks.length;i<n;i++)for(var s=this.sprayChunks[i],r=0,a=s.length;r<a;r++){var o=new E.Rect({width:s[r].width,height:s[r].width,left:s[r].x+1,top:s[r].y+1,originX:"center",originY:"center",fill:this.color});e.push(o)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new E.Group(e);this.shadow&&l.set("shadow",new E.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,i,n,s={};for(i=0,n=t.length;i<n;i++)s[e=t[i].left+""+t[i].top]||(s[e]=t[i]);var r=[];for(e in s)r.push(s[e]);return r},render:function(t){var e,i,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),e=0,i=t.length;e<i;e++){var s=t[e];void 0!==s.opacity&&(n.globalAlpha=s.opacity),n.fillRect(s.x,s.y,s.width,s.width)}n.restore()},_render:function(){var t,e,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);i.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,i,n,s,r=this.width/2;for(s=0;s<this.density;s++){e=E.util.getRandomInt(t.x-r,t.x+r),i=E.util.getRandomInt(t.y-r,t.y+r),n=this.dotWidthVariance?E.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new E.Point(e,i);a.width=n,this.randomOpacity&&(a.opacity=E.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),E.PatternBrush=E.util.createClass(E.PencilBrush,{getPatternSrc:function(){var t=E.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),i=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new E.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-i.x,offsetY:-i.y}),e}}),function(){var t=E.util.getPointer,e=E.util.degreesToRadians,i=E.util.isTouchEvent;for(var n in E.Canvas=E.util.createClass(E.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=E.PencilBrush&&new E.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,i,n=this.getActiveObjects();if(n.length>0&&!this.preserveObjectStacking){e=[],i=[];for(var s=0,r=this._objects.length;s<r;s++)t=this._objects[s],-1===n.indexOf(t)?e.push(t):i.push(t);n.length>1&&(this._activeObject._objects=i),e.push.apply(e,i)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){var i=t.calcTransformMatrix(),n=E.util.invertTransform(i),s=this.restorePointerVpt(e);return E.util.transformPoint(s,n)},isTargetTransparent:function(t,e,i){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var n=this._normalizePointer(t,{x:e,y:i}),s=Math.max(t.cacheTranslationX+n.x*t.zoomX,0),r=Math.max(t.cacheTranslationY+n.y*t.zoomY,0);return E.util.isTransparent(t._cacheContext,Math.round(s),Math.round(r),this.targetFindTolerance)}var a=this.contextCache,o=t.selectionBackgroundColor,l=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.render(a),a.restore(),t.selectionBackgroundColor=o,E.util.isTransparent(a,e,i,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return Array.isArray(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var i=this.getActiveObjects(),n=this._activeObject;return!e||e&&n&&i.length>1&&-1===i.indexOf(e)&&n!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&n&&n!==e},_shouldCenterTransform:function(t,e,i){var n;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?n=this.centeredScaling||t.centeredScaling:"rotate"===e&&(n=this.centeredRotation||t.centeredRotation),n?!i:i},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},_getActionFromCorner:function(t,e,i,n){if(!e||!t)return"drag";var s=n.controls[e];return s.getActionName(i,s,n)},_setupCurrentTransform:function(t,i,n){if(i){var s=this.getPointer(t),r=i.__corner,a=i.controls[r],o=n&&r?a.getActionHandler(t,i,a):E.controlsUtils.dragHandler,l=this._getActionFromCorner(n,r,t,i),c=this._getOriginFromCorner(i,r),h=t[this.centeredKey],d={target:i,action:l,actionHandler:o,corner:r,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:s.x-i.left,offsetY:s.y-i.top,originX:c.x,originY:c.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:e(i.angle),width:i.width*i.scaleX,shiftKey:t.shiftKey,altKey:h,original:E.util.saveObjectTransform(i)};this._shouldCenterTransform(i,l,h)&&(d.originX="center",d.originY="center"),d.original.originX=c.x,d.original.originY=c.y,this._currentTransform=d,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,i=new E.Point(e.ex,e.ey),n=E.util.transformPoint(i,this.viewportTransform),s=new E.Point(e.ex+e.left,e.ey+e.top),r=E.util.transformPoint(s,this.viewportTransform),a=Math.min(n.x,r.x),o=Math.min(n.y,r.y),l=Math.max(n.x,r.x),c=Math.max(n.y,r.y),h=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(a,o,l-a,c-o)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,a+=h,o+=h,l-=h,c-=h,E.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(a,o,l-a,c-o))},findTarget:function(t,e){if(!this.skipTargetFind){var n,s,r=this.getPointer(t,!0),a=this._activeObject,o=this.getActiveObjects(),l=i(t),c=o.length>1&&!e||1===o.length;if(this.targets=[],c&&a._findTargetCorner(r,l))return a;if(o.length>1&&!e&&a===this._searchPossibleTargets([a],r))return a;if(1===o.length&&a===this._searchPossibleTargets([a],r)){if(!this.preserveObjectStacking)return a;n=a,s=this.targets,this.targets=[]}var h=this._searchPossibleTargets(this._objects,r);return t[this.altSelectionKey]&&h&&n&&h!==n&&(h=n,this.targets=s),h}},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&e.containsPoint(t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,i.x,i.y))return!0}},_searchPossibleTargets:function(t,e){for(var i,n,s=t.length;s--;){var r=t[s],a=r.group?this._normalizePointer(r.group,e):e;if(this._checkTarget(a,r,e)){(i=t[s]).subTargetCheck&&i instanceof E.Group&&(n=this._searchPossibleTargets(i._objects,e))&&this.targets.push(n);break}}return i},restorePointerVpt:function(t){return E.util.transformPoint(t,E.util.invertTransform(this.viewportTransform))},getPointer:function(e,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var n,s=t(e),r=this.upperCanvasEl,a=r.getBoundingClientRect(),o=a.width||0,l=a.height||0;o&&l||("top"in a&&"bottom"in a&&(l=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(o=Math.abs(a.right-a.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,i||(s=this.restorePointerVpt(s));var c=this.getRetinaScaling();return 1!==c&&(s.x/=c,s.y/=c),n=0===o||0===l?{width:1,height:1}:{width:r.width/o,height:r.height/l},{x:s.x*n.width,y:s.y*n.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,i=this.upperCanvasEl;i?i.className="":(i=this._createCanvasElement(),this.upperCanvasEl=i),E.util.addClass(i,"upper-canvas "+t),this.wrapperEl.appendChild(i),this._copyCanvasStyle(e,i),this._applyCanvasStyle(i),this.contextTop=i.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=E.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),E.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),E.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,i=this.height||t.height;E.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=i,E.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var i=!1,n=this.getActiveObjects(),s=[],r=[];t.forEach((function(t){-1===n.indexOf(t)&&(i=!0,t.fire("deselected",{e,target:t}),r.push(t))})),n.forEach((function(n){-1===t.indexOf(n)&&(i=!0,n.fire("selected",{e,target:n}),s.push(n))})),t.length>0&&n.length>0?i&&this.fire("selection:updated",{e,selected:s,deselected:r}):n.length>0?this.fire("selection:created",{e,selected:s}):t.length>0&&this.fire("selection:cleared",{e,deselected:r})},setActiveObject:function(t,e){var i=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(i,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&!!this._discardActiveObject(e,t)&&!t.onSelect({e})&&(this._activeObject=t,!0)},_discardActiveObject:function(t,e){var i=this._activeObject;if(i){if(i.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),i=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:i,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){E.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,E.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(t),s=this.callSuper("_toObject",t,e,i);return this._unwindGroupTransformOnObject(t,n),s},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(i){e[i]=t[i]})),E.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,i){var n=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,i),this._unwindGroupTransformOnObject(e,n)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),E.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),E.StaticCanvas)"prototype"!==n&&(E.Canvas[n]=E.StaticCanvas[n])}(),function(){var t=E.util.addListener,e=E.util.removeListener,i={passive:!1};function n(t,e){return t.button&&t.button===e-1}E.util.object.extend(E.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var n=this.upperCanvasEl,s=this._getEventPrefix();t(E.window,"resize",this._onResize),t(n,s+"down",this._onMouseDown),t(n,s+"move",this._onMouseMove,i),t(n,s+"out",this._onMouseOut),t(n,s+"enter",this._onMouseEnter),t(n,"wheel",this._onMouseWheel),t(n,"contextmenu",this._onContextMenu),t(n,"dblclick",this._onDoubleClick),t(n,"dragover",this._onDragOver),t(n,"dragenter",this._onDragEnter),t(n,"dragleave",this._onDragLeave),t(n,"drop",this._onDrop),this.enablePointerEvents||t(n,"touchstart",this._onTouchStart,i),"undefined"!=typeof eventjs&&e in eventjs&&(eventjs[e](n,"gesture",this._onGesture),eventjs[e](n,"drag",this._onDrag),eventjs[e](n,"orientation",this._onOrientationChange),eventjs[e](n,"shake",this._onShake),eventjs[e](n,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var t=this._getEventPrefix();e(E.document,t+"up",this._onMouseUp),e(E.document,"touchend",this._onTouchEnd,i),e(E.document,t+"move",this._onMouseMove,i),e(E.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t});var i=this;this._hoveredTargets.forEach((function(n){i.fire("mouse:out",{target:e,e:t}),n&&e.fire("mouseout",{e:t})})),this._hoveredTargets=[]},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onDrop:function(t){return this._simpleEventHandler("drop:before",t),this._simpleEventHandler("drop",t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(n){n.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(n)),this.__onMouseDown(n),this._resetTransformEventData();var s=this.upperCanvasEl,r=this._getEventPrefix();t(E.document,"touchend",this._onTouchEnd,i),t(E.document,"touchmove",this._onMouseMove,i),e(s,r+"down",this._onMouseDown)},_onMouseDown:function(n){this.__onMouseDown(n),this._resetTransformEventData();var s=this.upperCanvasEl,r=this._getEventPrefix();e(s,r+"move",this._onMouseMove,i),t(E.document,r+"up",this._onMouseUp),t(E.document,r+"move",this._onMouseMove,i)},_onTouchEnd:function(n){if(!(n.touches.length>0)){this.__onMouseUp(n),this._resetTransformEventData(),this.mainTouchId=null;var s=this._getEventPrefix();e(E.document,"touchend",this._onTouchEnd,i),e(E.document,"touchmove",this._onMouseMove,i);var r=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(r.upperCanvasEl,s+"down",r._onMouseDown),r._willAddMouseDown=0}),400)}},_onMouseUp:function(n){this.__onMouseUp(n),this._resetTransformEventData();var s=this.upperCanvasEl,r=this._getEventPrefix();this._isMainEvent(n)&&(e(E.document,r+"up",this._onMouseUp),e(E.document,r+"move",this._onMouseMove,i),t(s,r+"move",this._onMouseMove,i))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,i=this._currentTransform,s=this._groupSelector,r=!1,a=!s||0===s.left&&0===s.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),n(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,a);else{if(n(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,a),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(i&&(this._finalizeCurrentTransform(t),r=i.actionPerformed),!a){var o=e===this._activeObject;this._maybeGroupObjects(t),r||(r=this._shouldRender(e)||!o&&e===this._activeObject)}var l,c;if(e){if(l=e._findTargetCorner(this.getPointer(t,!0),E.util.isTouchEvent(t)),e.selectable&&e!==this._activeObject&&"up"===e.activeOn)this.setActiveObject(e,t),r=!0;else{var h=e.controls[l],d=h&&h.getMouseUpHandler(t,e,h);d&&d(t,i,(c=this.getPointer(t)).x,c.y)}e.isMoving=!1}if(i&&(i.target!==e||i.corner!==l)){var u=i.target&&i.target.controls[i.corner],f=u&&u.getMouseUpHandler(t,e,h);c=c||this.getPointer(t),f&&f(t,i,c.x,c.y)}this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,a),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),r?this.requestRenderAll():a||this.renderTop()}}},_simpleEventHandler:function(t,e){var i=this.findTarget(e),n=this.targets,s={e,target:i,subTargets:n};if(this.fire(t,s),i&&i.fire(t,s),!n)return i;for(var r=0;r<n.length;r++)n[r].fire(t,s);return i},_handleEvent:function(t,e,i,n){var s=this._target,r=this.targets||[],a={e:t,target:s,subTargets:r,button:i||1,isClick:n||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(a.currentTarget=this.findTarget(t),a.currentSubTargets=this.targets),this.fire("mouse:"+e,a),s&&s.fire("mouse"+e,a);for(var o=0;o<r.length;o++)r[o].fire("mouse"+e,a)},_finalizeCurrentTransform:function(t){var e=this._currentTransform,i=e.target,n={e:t,target:i,transform:e,action:e.action};i._scaling&&(i._scaling=!1),i.setCoords(),(e.actionPerformed||this.stateful&&i.hasStateChanged())&&this._fire("modified",n)},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(n(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(n(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var i=this._pointer;this._previousPointer=i;var s=this._shouldRender(e),r=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):r&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),e){var a=e===this._activeObject;e.selectable&&"down"===e.activeOn&&this.setActiveObject(e,t);var o=e._findTargetCorner(this.getPointer(t,!0),E.util.isTouchEvent(t));if(e.__corner=o,e===this._activeObject&&(o||!r)){this._setupCurrentTransform(t,e,a);var l=e.controls[o],c=(i=this.getPointer(t),l&&l.getMouseDownHandler(t,e,l));c&&c(t,this._currentTransform,i.x,i.y)}}this._handleEvent(t,"down"),(s||r)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,i;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var n=this._groupSelector;n?(i=this._absolutePointer,n.left=i.x-n.ex,n.top=i.y-n.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){var i=this._hoveredTarget,n=this._hoveredTargets,s=this.targets,r=Math.max(n.length,s.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:i,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var a=0;a<r;a++)this.fireSyntheticInOutEvents(s[a],e,{oldTarget:n[a],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var i=this._draggedoverTarget,n=this._hoveredTargets,s=this.targets,r=Math.max(n.length,s.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:i,evtOut:"dragleave",evtIn:"dragenter"});for(var a=0;a<r;a++)this.fireSyntheticInOutEvents(s[a],e,{oldTarget:n[a],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,i){var n,s,r,a=i.oldTarget,o=a!==t,l=i.canvasEvtIn,c=i.canvasEvtOut;o&&(n={e,target:t,previousTarget:a},s={e,target:a,nextTarget:t}),r=t&&o,a&&o&&(c&&this.fire(c,s),a.fire(i.evtOut,s)),r&&(l&&this.fire(l,n),t.fire(i.evtIn,n))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.shiftKey=t.shiftKey,i.altKey=t[this.centeredKey],this._performTransformAction(t,i,e),i.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,i){var n=i.x,s=i.y,r=e.action,a=!1,o=e.actionHandler;o&&(a=o(t,e,n,s)),"drag"===r&&a&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||a},_fire:E.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var i=e.hoverCursor||this.hoverCursor,n=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,s=(!n||!n.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));s?this.setCursor(this.getCornerCursor(s,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map((function(t){i=t.hoverCursor||i})),this.setCursor(i))},getCornerCursor:function(t,e,i){var n=e.controls[t];return n.cursorStyleHandler(i,n,e)}})}(),v=Math.min,b=Math.max,E.util.object.extend(E.Canvas.prototype,{_shouldGroup:function(t,e){var i=this._activeObject;return i&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(i!==e||"activeSelection"===i.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var i=this._activeObject;i.__corner||(e!==i||(e=this.findTarget(t,!0))&&e.selectable)&&(i&&"activeSelection"===i.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var i=this._activeObject,n=i._objects.slice(0);i.contains(t)?(i.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===i.size()&&this._setActiveObject(i.item(0),e)):(i.addWithUpdate(t),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(n,e)},_createActiveSelection:function(t,e){var i=this.getActiveObjects(),n=this._createGroup(t);this._hoveredTarget=n,this._setActiveObject(n,e),this._fireSelectionEvents(i,e)},_createGroup:function(t){var e=this._objects,i=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new E.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(t){var e,i=this._collectObjects(t);1===i.length?this.setActiveObject(i[0],t):i.length>1&&(e=new E.ActiveSelection(i.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(t){for(var e,i=[],n=this._groupSelector.ex,s=this._groupSelector.ey,r=n+this._groupSelector.left,a=s+this._groupSelector.top,o=new E.Point(v(n,r),v(s,a)),l=new E.Point(b(n,r),b(s,a)),c=!this.selectionFullyContained,h=n===r&&s===a,d=this._objects.length;d--&&!((e=this._objects[d])&&e.selectable&&e.visible&&(c&&e.intersectsWithRect(o,l,!0)||e.isContainedWithinRect(o,l,!0)||c&&e.containsPoint(o,null,!0)||c&&e.containsPoint(l,null,!0))&&(i.push(e),h)););return i.length>1&&(i=i.filter((function(e){return!e.onSelect({e:t})}))),i},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}}),E.util.object.extend(E.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,n=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),s=this.toCanvasElement(n,t);return E.util.toDataURL(s,e,i)},toCanvasElement:function(t,e){t=t||1;var i=((e=e||{}).width||this.width)*t,n=(e.height||this.height)*t,s=this.getZoom(),r=this.width,a=this.height,o=s*t,l=this.viewportTransform,c=(l[4]-(e.left||0))*t,h=(l[5]-(e.top||0))*t,d=this.interactive,u=[o,0,0,o,c,h],f=this.enableRetinaScaling,p=E.util.createCanvasElement(),g=this.contextTop;return p.width=i,p.height=n,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=u,this.width=i,this.height=n,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=l,this.width=r,this.height=a,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=f,this.contextTop=g,p}}),E.util.object.extend(E.StaticCanvas.prototype,{loadFromJSON:function(t,e,i){if(t){var n="string"==typeof t?JSON.parse(t):E.util.object.clone(t),s=this,r=n.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete n.clipPath,this._enlivenObjects(n.objects,(function(t){s.clear(),s._setBgOverlay(n,(function(){r?s._enlivenObjects([r],(function(i){s.clipPath=i[0],s.__setupCanvas.call(s,n,t,a,e)})):s.__setupCanvas.call(s,n,t,a,e)}))}),i),this}},__setupCanvas:function(t,e,i,n){var s=this;e.forEach((function(t,e){s.insertAt(t,e)})),this.renderOnAddRemove=i,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),n&&n()},_setBgOverlay:function(t,e){var i={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var n=function(){i.backgroundImage&&i.overlayImage&&i.backgroundColor&&i.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,i,n),this.__setBgOverlay("overlayImage",t.overlayImage,i,n),this.__setBgOverlay("backgroundColor",t.background,i,n),this.__setBgOverlay("overlayColor",t.overlay,i,n)}else e&&e()},__setBgOverlay:function(t,e,i,n){var s=this;if(!e)return i[t]=!0,void(n&&n());"backgroundImage"===t||"overlayImage"===t?E.util.enlivenObjects([e],(function(e){s[t]=e[0],i[t]=!0,n&&n()})):this["set"+E.util.string.capitalize(t,!0)](e,(function(){i[t]=!0,n&&n()}))},_enlivenObjects:function(t,e,i){t&&0!==t.length?E.util.enlivenObjects(t,(function(t){e&&e(t)}),null,i):e&&e([])},_toDataURL:function(t,e){this.clone((function(i){e(i.toDataURL(t))}))},_toDataURLWithMultiplier:function(t,e,i){this.clone((function(n){i(n.toDataURLWithMultiplier(t,e))}))},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData((function(e){e.loadFromJSON(i,(function(){t&&t(e)}))}))},cloneWithoutData:function(t){var e=E.util.createCanvasElement();e.width=this.width,e.height=this.height;var i=new E.Canvas(e);this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,(function(){i.renderAll(),t&&t(i)})),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,s=e.util.toFixed,r=e.util.string.capitalize,a=e.util.degreesToRadians,o=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var i=e.perfLimitSizeTotal,n=t.width,s=t.height,r=e.maxCacheSideLimit,a=e.minCacheSideLimit;if(n<=r&&s<=r&&n*s<=i)return n<a&&(t.width=a),s<a&&(t.height=a),t;var o=n/s,l=e.util.limitDimsByArea(o,i),c=e.util.capValue,h=c(a,l.x,r),d=c(a,l.y,r);return n>h&&(t.zoomX/=n/h,t.width=h,t.capped=!0),s>d&&(t.zoomY/=s/d,t.height=d,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),i=e.x*t.scaleX/this.scaleX,n=e.y*t.scaleY/this.scaleY;return{width:i+2,height:n+2,zoomX:t.scaleX,zoomY:t.scaleY,x:i,y:n}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var i=t._currentTransform.target,n=t._currentTransform.action;if(this===i&&n.slice&&"scale"===n.slice(0,5))return!1}var s,r,a=this._cacheCanvas,o=this._limitCacheSize(this._getCacheCanvasDimensions()),l=e.minCacheSideLimit,c=o.width,h=o.height,d=o.zoomX,u=o.zoomY,f=c!==this.cacheWidth||h!==this.cacheHeight,p=this.zoomX!==d||this.zoomY!==u,g=f||p,m=0,v=0,b=!1;if(f){var y=this._cacheCanvas.width,x=this._cacheCanvas.height,w=c>y||h>x;b=w||(c<.9*y||h<.9*x)&&y>l&&x>l,w&&!o.capped&&(c>l||h>l)&&(m=.1*c,v=.1*h)}return this instanceof e.Text&&this.path&&(g=!0,b=!0,m+=this.getHeightOfLine(0)*this.zoomX,v+=this.getHeightOfLine(0)*this.zoomY),!!g&&(b?(a.width=Math.ceil(c+m),a.height=Math.ceil(h+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,a.width,a.height)),s=o.x/2,r=o.y/2,this.cacheTranslationX=Math.round(a.width/2-s)+s,this.cacheTranslationY=Math.round(a.height/2-r)+r,this.cacheWidth=c,this.cacheHeight=h,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(d,u),this.zoomX=d,this.zoomY=u,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,i=this.calcTransformMatrix(!e);t.transform(i[0],i[1],i[2],i[3],i[4],i[5])},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,n={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:s(this.left,i),top:s(this.top,i),width:s(this.width,i),height:s(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:s(this.strokeWidth,i),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:s(this.strokeMiterLimit,i),scaleX:s(this.scaleX,i),scaleY:s(this.scaleY,i),angle:s(this.angle,i),flipX:this.flipX,flipY:this.flipY,opacity:s(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:s(this.skewX,i),skewY:s(this.skewY,i)};return this.clipPath&&!this.clipPath.excludeFromExport&&(n.clipPath=this.clipPath.toObject(t),n.clipPath.inverted=this.clipPath.inverted,n.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,n,t),this.includeDefaultValues||(n=this._removeDefaultValues(n)),n},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype;return i.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===i[e]&&delete t[e],Array.isArray(t[e])&&Array.isArray(i[e])&&0===t[e].length&&0===i[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+r(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var t=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,i=t.scaleY;if(this.canvas){var n=this.canvas.getZoom(),s=this.canvas.getRetinaScaling();e*=n*s,i*=n*s}return{scaleX:e,scaleY:i}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,i){var n="scaleX"===t||"scaleY"===t,s=this[t]!==i,r=!1;return n&&(i=this._constrainScale(i)),"scaleX"===t&&i<0?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&i<0?(this.flipY=!this.flipY,i*=-1):"shadow"!==t||!i||i instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",i):i=new e.Shadow(i),this[t]=i,s&&(r=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,r&&this.group.set("dirty",!0)):r&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t,i){if(t.save(),i.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",i.absolutePositioned){var n=e.util.invertTransform(this.calcTransformMatrix());t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}i.transform(t),t.scale(1/i.zoomX,1/i.zoomY),t.drawImage(i._cacheCanvas,-i.cacheTranslationX,-i.cacheTranslationY),t.restore()},drawObject:function(t,e){var i=this.fill,n=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath),this.fill=i,this.stroke=n},_drawClipPath:function(t,e){e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t,e))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!t){var e=this.cacheWidth/this.zoomX,i=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-i/2,e,i)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var i=e.stroke;i&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,i.toLive?"percentage"===i.gradientUnits||i.gradientTransform||i.patternTransform?this._applyPatternForTransformedGradient(t,i):(t.strokeStyle=i.toLive(t,this),this._applyPatternGradientTransform(t,i)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var i=e.fill;i&&(i.toLive?(t.fillStyle=i.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=i)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e){e&&0!==e.length&&(1&e.length&&e.push.apply(e,e),t.setLineDash(e))},_renderControls:function(t,i){var n,s,r,o=this.getViewportTransform(),l=this.calcTransformMatrix();s=void 0!==(i=i||{}).hasBorders?i.hasBorders:this.hasBorders,r=void 0!==i.hasControls?i.hasControls:this.hasControls,l=e.util.multiplyTransformMatrices(o,l),n=e.util.qrDecompose(l),t.save(),t.translate(n.translateX,n.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(n.angle-=180),t.rotate(a(this.group?n.angle:this.angle)),i.forActiveSelection||this.group?s&&this.drawBordersInGroup(t,n,i):s&&this.drawBorders(t,i),r&&this.drawControls(t,i),t.restore()},_setShadow:function(t){if(this.shadow){var i,n=this.shadow,s=this.canvas,r=s&&s.viewportTransform[0]||1,a=s&&s.viewportTransform[3]||1;i=n.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),s&&s._isRetinaScaling()&&(r*=e.devicePixelRatio,a*=e.devicePixelRatio),t.shadowColor=n.color,t.shadowBlur=n.blur*e.browserShadowBlurConstant*(r+a)*(i.scaleX+i.scaleY)/4,t.shadowOffsetX=n.offsetX*r*i.scaleX,t.shadowOffsetY=n.offsetY*a*i.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var i=e.gradientTransform||e.patternTransform,n=-this.width/2+e.offsetX||0,s=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,n,s):t.transform(1,0,0,1,n,s),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),{offsetX:n,offsetY:s}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var e=this.getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,i){var n,s=this._limitCacheSize(this._getCacheCanvasDimensions()),r=e.util.createCanvasElement(),a=this.canvas.getRetinaScaling(),o=s.x/this.scaleX/a,l=s.y/this.scaleY/a;r.width=o,r.height=l,(n=r.getContext("2d")).beginPath(),n.moveTo(0,0),n.lineTo(o,0),n.lineTo(o,l),n.lineTo(0,l),n.closePath(),n.translate(o/2,l/2),n.scale(s.zoomX/this.scaleX/a,s.zoomY/this.scaleY/a),this._applyPatternGradientTransform(n,i),n.fillStyle=i.toLive(t),n.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(a*this.scaleX/s.zoomX,a*this.scaleY/s.zoomY),t.strokeStyle=n.createPattern(r,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var i=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),i=e.util.transformPoint(i,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,i.x+=t.offsetLeft,i.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(i,"center","center")},clone:function(t,i){var n=this.toObject(i);this.constructor.fromObject?this.constructor.fromObject(n,t):e.Object._fromObject("Object",n,t)},cloneAsImage:function(t,i){var n=this.toCanvasElement(i);return t&&t(new e.Image(n)),this},toCanvasElement:function(t){t||(t={});var i=e.util,n=i.saveObjectTransform(this),s=this.group,r=this.shadow,a=Math.abs,o=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,t.withoutTransform&&i.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var l,c,h,d,u=e.util.createCanvasElement(),f=this.getBoundingRect(!0,!0),p=this.shadow,g={x:0,y:0};p&&(c=p.blur,l=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),g.x=2*Math.round(a(p.offsetX)+c)*a(l.scaleX),g.y=2*Math.round(a(p.offsetY)+c)*a(l.scaleY)),h=f.width+g.x,d=f.height+g.y,u.width=Math.ceil(h),u.height=Math.ceil(d);var m=new e.StaticCanvas(u,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(m.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(m.width/2,m.height/2),"center","center");var v=this.canvas;m.add(this);var b=m.toCanvasElement(o||1,t);return this.shadow=r,this.set("canvas",v),s&&(this.group=s),this.set(n).setCoords(),m._objects=[],m.dispose(),m=null,b},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,i){i=i||this.canvas.getPointer(t);var n=new e.Point(i.x,i.y),s=this._getLeftTopCoords();return this.angle&&(n=e.util.rotatePoint(n,s,a(-this.angle))),{x:n.x-s.x,y:n.y-s.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(t,i,s,r){var a=e[t];i=n(i,!0),e.util.enlivenPatterns([i.fill,i.stroke],(function(t){void 0!==t[0]&&(i.fill=t[0]),void 0!==t[1]&&(i.stroke=t[1]),e.util.enlivenObjectEnlivables(i,i,(function(){var t=r?new a(i[r],i):new a(i);s&&s(t)}))}))},e.Object.__uid=0)}(e),y=E.util.degreesToRadians,x={left:-.5,center:0,right:.5},w={top:-.5,center:0,bottom:.5},E.util.object.extend(E.Object.prototype,{translateToGivenOrigin:function(t,e,i,n,s){var r,a,o,l=t.x,c=t.y;return"string"==typeof e?e=x[e]:e-=.5,"string"==typeof n?n=x[n]:n-=.5,"string"==typeof i?i=w[i]:i-=.5,"string"==typeof s?s=w[s]:s-=.5,a=s-i,((r=n-e)||a)&&(o=this._getTransformedDimensions(),l=t.x+r*o.x,c=t.y+a*o.y),new E.Point(l,c)},translateToCenterPoint:function(t,e,i){var n=this.translateToGivenOrigin(t,e,i,"center","center");return this.angle?E.util.rotatePoint(n,t,y(this.angle)):n},translateToOriginPoint:function(t,e,i){var n=this.translateToGivenOrigin(t,"center","center",e,i);return this.angle?E.util.rotatePoint(n,t,y(this.angle)):n},getCenterPoint:function(){var t=new E.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(t,e,i){var n,s,r=this.getCenterPoint();return n=void 0!==e&&void 0!==i?this.translateToGivenOrigin(r,"center","center",e,i):new E.Point(this.left,this.top),s=new E.Point(t.x,t.y),this.angle&&(s=E.util.rotatePoint(s,r,-y(this.angle))),s.subtractEquals(n)},setPositionByOrigin:function(t,e,i){var n=this.translateToCenterPoint(t,e,i),s=this.translateToOriginPoint(n,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(t){var e,i,n=y(this.angle),s=this.getScaledWidth(),r=E.util.cos(n)*s,a=E.util.sin(n)*s;e="string"==typeof this.originX?x[this.originX]:this.originX-.5,i="string"==typeof t?x[t]:t-.5,this.left+=r*(i-e),this.top+=a*(i-e),this.setCoords(),this.originX=t},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var t=E.util,e=t.degreesToRadians,i=t.multiplyTransformMatrices,n=t.transformPoint;t.object.extend(E.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,e){return i=this._getCoords(t,e),[new E.Point(i.tl.x,i.tl.y),new E.Point(i.tr.x,i.tr.y),new E.Point(i.br.x,i.br.y),new E.Point(i.bl.x,i.bl.y)];var i},intersectsWithRect:function(t,e,i,n){var s=this.getCoords(i,n);return"Intersection"===E.Intersection.intersectPolygonRectangle(s,t,e).status},intersectsWithObject:function(t,e,i){return"Intersection"===E.Intersection.intersectPolygonPolygon(this.getCoords(e,i),t.getCoords(e,i)).status||t.isContainedWithinObject(this,e,i)||this.isContainedWithinObject(t,e,i)},isContainedWithinObject:function(t,e,i){for(var n=this.getCoords(e,i),s=e?t.aCoords:t.lineCoords,r=0,a=t._getImageLines(s);r<4;r++)if(!t.containsPoint(n[r],a))return!1;return!0},isContainedWithinRect:function(t,e,i,n){var s=this.getBoundingRect(i,n);return s.left>=t.x&&s.left+s.width<=e.x&&s.top>=t.y&&s.top+s.height<=e.y},containsPoint:function(t,e,i,n){var s=this._getCoords(i,n),r=(e=e||this._getImageLines(s),this._findCrossPoints(t,e));return 0!==r&&r%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.getCoords(!0,t).some((function(t){return t.x<=i.x&&t.x>=e.x&&t.y<=i.y&&t.y>=e.y}))||!!this.intersectsWithRect(e,i,!0,t)||this._containsCenterOfCanvas(e,i,t)},_containsCenterOfCanvas:function(t,e,i){var n={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(n,null,!0,i)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,i=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,i,!0,t)||this.getCoords(!0,t).every((function(t){return(t.x>=i.x||t.x<=e.x)&&(t.y>=i.y||t.y<=e.y)}))&&this._containsCenterOfCanvas(e,i,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,n,s,r=0;for(var a in e)if(!((s=e[a]).o.y<t.y&&s.d.y<t.y||s.o.y>=t.y&&s.d.y>=t.y||(s.o.x===s.d.x&&s.o.x>=t.x?n=s.o.x:(i=(s.d.y-s.o.y)/(s.d.x-s.o.x),n=-(t.y-0*t.x-(s.o.y-i*s.o.x))/(0-i)),n>=t.x&&(r+=1),2!==r)))break;return r},getBoundingRect:function(e,i){var n=this.getCoords(e,i);return t.makeBoundingBoxFromPoints(n)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var i=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/i)},scaleToHeight:function(t,e){var i=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/i)},calcLineCoords:function(){var i=this.getViewportTransform(),s=this.padding,r=e(this.angle),a=t.cos(r)*s,o=t.sin(r)*s,l=a+o,c=a-o,h=this.calcACoords(),d={tl:n(h.tl,i),tr:n(h.tr,i),bl:n(h.bl,i),br:n(h.br,i)};return s&&(d.tl.x-=c,d.tl.y-=l,d.tr.x+=l,d.tr.y-=c,d.bl.x-=l,d.bl.y+=c,d.br.x+=c,d.br.y+=l),d},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),n=this.getViewportTransform(),s=i(n,e),r=i(s,t),a=(r=i(r,[1/n[0],0,0,1/n[3],0,0]),this._calculateCurrentDimensions()),o={};return this.forEachControl((function(t,e,i){o[e]=t.positionHandler(a,r,i)})),o},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),s=i(e,t),r=this._getTransformedDimensions(),a=r.x/2,o=r.y/2;return{tl:n({x:-a,y:-o},s),tr:n({x:a,y:-o},s),bl:n({x:-a,y:o},s),br:n({x:a,y:o},s)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",i="";return!t&&this.group&&(i=this.group.transformMatrixKey(t)+e),i+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var n=this.transformMatrixKey(t),s=this.matrixCache||(this.matrixCache={});return s.key===n?s.value:(this.group&&(e=i(this.group.calcTransformMatrix(!1),e)),s.key=n,s.value=e,e)},calcOwnMatrix:function(){var e=this.transformMatrixKey(!0),i=this.ownMatrixCache||(this.ownMatrixCache={});if(i.key===e)return i.value;var n=this._calcTranslateMatrix(),s={angle:this.angle,translateX:n[4],translateY:n[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return i.key=e,i.value=t.composeMatrix(s),i.value},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(e,i){void 0===e&&(e=this.skewX),void 0===i&&(i=this.skewY);var n,s,r,a=0===e&&0===i;if(this.strokeUniform?(s=this.width,r=this.height):(s=(n=this._getNonTransformedDimensions()).x,r=n.y),a)return this._finalizeDimensions(s*this.scaleX,r*this.scaleY);var o=t.sizeAfterTransform(s,r,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:e,skewY:i});return this._finalizeDimensions(o.x,o.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return n(e,t,!0).scalarAdd(2*this.padding)}})}(),E.util.object.extend(E.Object.prototype,{sendToBack:function(){return this.group?E.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?E.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?E.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?E.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?E.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var i=new E.Color(e),n=t+": "+i.toRgb()+"; ",s=i.getAlpha();return 1!==s&&(n+=t+"-opacity: "+s.toString()+"; "),n}return t+": none; "}var e=E.util.toFixed;E.util.object.extend(E.Object.prototype,{getSvgStyles:function(e){var i=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",r=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",h=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),u=t("fill",this.fill);return[t("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",r,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",l,"; ",u,"fill-rule: ",i,"; ","opacity: ",c,";",d,h].join("")},getSvgSpanStyles:function(e,i){var n="; ",s=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+n:"",r=e.strokeWidth?"stroke-width: "+e.strokeWidth+n:"",a=e.fontSize?"font-size: "+e.fontSize+"px"+n:"",o=e.fontStyle?"font-style: "+e.fontStyle+n:"",l=e.fontWeight?"font-weight: "+e.fontWeight+n:"",c=e.fill?t("fill",e.fill):"",h=e.stroke?t("stroke",e.stroke):"",d=this.getSvgTextDecoration(e);return d&&(d="text-decoration: "+d+n),[h,r,s,a,o,l,d,c,e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"",i?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return["overline","underline","line-through"].filter((function(e){return t[e.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){var i=t?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+E.util.matrixToSVG(i)+(e||"")+'" '},_setSVGBg:function(t){if(this.backgroundColor){var i=E.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,i),'" y="',e(-this.height/2,i),'" width="',e(this.width,i),'" height="',e(this.height,i),'"></rect>\n')}},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){var i=(e=e||{}).reviver,n=e.additionalTransform||"",s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),r=t.indexOf("COMMON_PARTS");return t[r]=s,i?i(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){var i,n,s=(e=e||{}).noStyle,r=e.reviver,a=s?"":'style="'+this.getSvgStyles()+'" ',o=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",h=l&&l.absolutePositioned,d=this.stroke,u=this.fill,f=this.shadow,p=[],g=t.indexOf("COMMON_PARTS"),m=e.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+E.Object.__uid++,n='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(r)+"</clipPath>\n"),h&&p.push("<g ",o,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),h?"":o+this.getSvgCommons()," >\n"),i=[a,c,s?"":this.addPaintOrder()," ",m?'transform="'+m+'" ':""].join(""),t[g]=i,u&&u.toLive&&p.push(u.toSVG(this)),d&&d.toLive&&p.push(d.toSVG(this)),f&&p.push(f.toSVG(this)),l&&p.push(n),p.push(t.join("")),p.push("</g>\n"),h&&p.push("</g>\n"),r?r(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=E.util.object.extend,e="stateProperties";function i(e,i,n){var s={};n.forEach((function(t){s[t]=e[t]})),t(e[i],s,!0)}function n(t,e,i){if(t===e)return!0;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var s=0,r=t.length;s<r;s++)if(!n(t[s],e[s]))return!1;return!0}if(t&&"object"==typeof t){var a,o=Object.keys(t);if(!e||"object"!=typeof e||!i&&o.length!==Object.keys(e).length)return!1;for(s=0,r=o.length;s<r;s++)if("canvas"!==(a=o[s])&&"group"!==a&&!n(t[a],e[a]))return!1;return!0}}E.util.object.extend(E.Object.prototype,{hasStateChanged:function(t){var i="_"+(t=t||e);return Object.keys(this[i]).length<this[t].length||!n(this[i],this,!0)},saveState:function(t){var n=t&&t.propertySet||e,s="_"+n;return this[s]?(i(this,s,this[n]),t&&t.stateProperties&&i(this,s,t.stateProperties),this):this.setupState(t)},setupState:function(t){var i=(t=t||{}).propertySet||e;return t.propertySet=i,this["_"+i]={},this.saveState(t),this}})}(),function(){var t=E.util.degreesToRadians;E.util.object.extend(E.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var i,n,s,r=t.x,a=t.y,o=Object.keys(this.oCoords),l=o.length-1;for(this.__corner=0;l>=0;l--)if(s=o[l],this.isControlVisible(s)&&(n=this._getImageLines(e?this.oCoords[s].touchCorner:this.oCoords[s].corner),0!==(i=this._findCrossPoints({x:r,y:a},n))&&i%2==1))return this.__corner=s,s;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t=this.oCoords;for(var e in t){var i=this.controls[e];t[e].corner=i.calcCornerCoords(this.angle,this.cornerSize,t[e].x,t[e].y,!1),t[e].touchCorner=i.calcCornerCoords(this.angle,this.touchCornerSize,t[e].x,t[e].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var i=this.getCenterPoint(),n=this._calculateCurrentDimensions(),s=this.canvas.viewportTransform;return e.translate(i.x,i.y),e.scale(1/s[0],1/s[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var i=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=i.x+n,r=i.y+n,a=void 0!==e.hasControls?e.hasControls:this.hasControls,o=!1;return t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-r/2,s,r),a&&(t.beginPath(),this.forEachControl((function(e,i,n){e.withConnection&&e.getVisibility(n,i)&&(o=!0,t.moveTo(e.x*s,e.y*r),t.lineTo(e.x*s+e.offsetX,e.y*r+e.offsetY))})),o&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,e,i){i=i||{};var n=E.util.sizeAfterTransform(this.width,this.height,e),s=this.strokeWidth,r=this.strokeUniform,a=this.borderScaleFactor,o=n.x+s*(r?this.canvas.getZoom():e.scaleX)+a,l=n.y+s*(r?this.canvas.getZoom():e.scaleY)+a;return t.save(),this._setLineDash(t,i.borderDashArray||this.borderDashArray),t.strokeStyle=i.borderColor||this.borderColor,t.strokeRect(-o/2,-l/2,o,l),t.restore(),this},drawControls:function(t,e){e=e||{},t.save();var i,n,s=this.canvas.getRetinaScaling();return t.setTransform(s,0,0,s,0,0),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(i=this.group.calcTransformMatrix()),this.forEachControl((function(s,r,a){n=a.oCoords[r],s.getVisibility(a,r)&&(i&&(n=E.util.transformPoint(n,i)),s.render(t,n.x,n.y,e,a))})),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}})}(),E.util.object.extend(E.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,s=e.onChange||i,r=this;return E.util.animate({target:this,startValue:t.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),r.requestRenderAll(),s()},onComplete:function(){t.setCoords(),n()}})},fxCenterObjectV:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,s=e.onChange||i,r=this;return E.util.animate({target:this,startValue:t.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),r.requestRenderAll(),s()},onComplete:function(){t.setCoords(),n()}})},fxRemove:function(t,e){var i=function(){},n=(e=e||{}).onComplete||i,s=e.onChange||i,r=this;return E.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),r.requestRenderAll(),s()},onComplete:function(){r.remove(t),n()}})}}),E.util.object.extend(E.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[],n=[];for(t in arguments[0])i.push(t);for(var s=0,r=i.length;s<r;s++)t=i[s],e=s!==r-1,n.push(this._animate(t,arguments[0][t],arguments[1],e));return n}return this._animate.apply(this,arguments)},_animate:function(t,e,i,n){var s,r=this;e=e.toString(),i=i?E.util.object.clone(i):{},~t.indexOf(".")&&(s=t.split("."));var a=r.colorProperties.indexOf(t)>-1||s&&r.colorProperties.indexOf(s[1])>-1,o=s?this.get(s[0])[s[1]]:this.get(t);"from"in i||(i.from=o),a||(e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e));var l={target:this,startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(t,e,n){return i.abort.call(r,t,e,n)},onChange:function(e,a,o){s?r[s[0]][s[1]]=e:r.set(t,e),n||i.onChange&&i.onChange(e,a,o)},onComplete:function(t,e,s){n||(r.setCoords(),i.onComplete&&i.onComplete(t,e,s))}};return a?E.util.animateColor(l.startValue,l.endValue,l.duration,l):E.util.animate(l)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,s={x1:1,x2:1,y1:1,y2:1};function r(t,e){var i=t.origin,n=t.axis1,s=t.axis2,r=t.dimension,a=e.nearest,o=e.center,l=e.farthest;return function(){switch(this.get(i)){case a:return Math.min(this.get(n),this.get(s));case o:return Math.min(this.get(n),this.get(s))+.5*this.get(r);case l:return Math.max(this.get(n),this.get(s))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:r({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:r({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath();var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;var i=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=i},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return i(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,i=t*this.width*.5,n=e*this.height*.5;return{x1:i,x2:t*this.width*-.5,y1:n,y2:e*this.height*-.5}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,n,s){s=s||{};var r=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),a=[r.x1||0,r.y1||0,r.x2||0,r.y2||0];n(new e.Line(a,i(r,s)))},e.Line.fromObject=function(t,i){var s=n(t,!0);s.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",s,(function(t){delete t.points,i&&i(t)}),"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.degreesToRadians;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,n=(this.endAngle-this.startAngle)%360;if(0===n)t=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var s=i(this.startAngle),r=i(this.endAngle),a=this.radius;t=['<path d="M '+e.util.cos(s)*a+" "+e.util.sin(s)*a," A "+a+" "+a," 0 ",+(n>180?"1":"0")+" 1"," "+e.util.cos(r)*a+" "+e.util.sin(r)*a,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,i(this.startAngle),i(this.endAngle),!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,i){var n,s=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!("radius"in(n=s)&&n.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");s.left=(s.left||0)-s.radius,s.top=(s.top||0)-s.radius,i(new e.Circle(s))},e.Circle.fromObject=function(t,i){e.Object._fromObject("Circle",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderPaintInOrder(t)},_toSVG:function(){var t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-t+" "+e,"0 "+-e,t+" "+e].join(","),'" />']}}),e.Triangle.fromObject=function(t,i){return e.Object._fromObject("Triangle",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,i,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){var n=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,i(new e.Ellipse(n))},e.Ellipse.fromObject=function(t,i){e.Object._fromObject("Ellipse",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,s=this.height,r=-this.width/2,a=-this.height/2,o=0!==e||0!==i,l=.4477152502;t.beginPath(),t.moveTo(r+e,a),t.lineTo(r+n-e,a),o&&t.bezierCurveTo(r+n-l*e,a,r+n,a+l*i,r+n,a+i),t.lineTo(r+n,a+s-i),o&&t.bezierCurveTo(r+n,a+s-l*i,r+n-l*e,a+s,r+n-e,a+s),t.lineTo(r+e,a+s),o&&t.bezierCurveTo(r+l*e,a+s,r,a+s-l*i,r,a+s-i),t.lineTo(r,a+i),o&&t.bezierCurveTo(r,a+l*i,r+l*e,a,r+e,a),t.closePath(),this._renderPaintInOrder(t)},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,n,s){if(!t)return n(null);s=s||{};var r=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0,r.height=r.height||0,r.width=r.width||0;var a=new e.Rect(i(s?e.util.object.clone(s):{},r));a.visible=a.visible&&a.width>0&&a.height>0,n(a)},e.Rect.fromObject=function(t,i){return e.Object._fromObject("Rect",t,i)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.array.min,s=e.util.array.max,r=e.util.toFixed,a=e.util.projectStrokeOnPoints;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(t){var e,i=this._calcDimensions(t),n=this.exactBoundingBox?this.strokeWidth:0;this.width=i.width-n,this.height=i.height-n,t.fromSVG||(e=this.translateToGivenOrigin({x:i.left-this.strokeWidth/2+n/2,y:i.top-this.strokeWidth/2+n/2},"left","top",this.originX,this.originY)),void 0===t.left&&(this.left=t.fromSVG?i.left:e.x),void 0===t.top&&(this.top=t.fromSVG?i.top:e.y),this.pathOffset={x:i.left+this.width/2+n/2,y:i.top+this.height/2+n/2}},_calcDimensions:function(){var t=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,e=n(t,"x")||0,i=n(t,"y")||0;return{left:e,top:i,width:(s(t,"x")||0)-e,height:(s(t,"y")||0)-i}},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],i=this.pathOffset.x,n=this.pathOffset.y,s=e.Object.NUM_FRACTION_DIGITS,a=0,o=this.points.length;a<o;a++)t.push(r(this.points[a].x-i,s),",",r(this.points[a].y-n,s)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,i=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-n,this.points[0].y-s);for(var r=0;r<i;r++)e=this.points[r],t.lineTo(e.x-n,e.y-s);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(t){return function(n,s,r){if(!n)return s(null);r||(r={});var a=e.parsePointsAttribute(n.getAttribute("points")),o=e.parseAttributes(n,e[t].ATTRIBUTE_NAMES);o.fromSVG=!0,s(new e[t](a,i(o,r)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(t,i){return e.Object._fromObject("Polyline",t,i,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.projectStrokeOnPoints;e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return i(this.points,this)},_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(t,i){e.Object._fromObject("Polygon",t,i,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,n=e.util.array.max,s=e.util.object.extend,r=e.util.object.clone,a=e.util.toFixed;e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,e){delete(e=r(e||{})).path,this.callSuper("initialize",e),this._setPath(t||[],e)},_setPath:function(t,i){this.path=e.util.makePathSimpler(Array.isArray(t)?t:e.util.parsePath(t)),e.Polyline.prototype._setPositionDimensions.call(this,i||{})},_renderPathCommands:function(t){var e,i=0,n=0,s=0,r=0,a=0,o=0,l=-this.pathOffset.x,c=-this.pathOffset.y;t.beginPath();for(var h=0,d=this.path.length;h<d;++h)switch((e=this.path[h])[0]){case"L":s=e[1],r=e[2],t.lineTo(s+l,r+c);break;case"M":i=s=e[1],n=r=e[2],t.moveTo(s+l,r+c);break;case"C":s=e[5],r=e[6],a=e[3],o=e[4],t.bezierCurveTo(e[1]+l,e[2]+c,a+l,o+c,s+l,r+c);break;case"Q":t.quadraticCurveTo(e[1]+l,e[2]+c,e[3]+l,e[4]+c),s=e[3],r=e[4],a=e[1],o=e[2];break;case"z":case"Z":s=i,r=n,t.closePath()}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return s(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',e.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=e.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,t)+", "+a(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,s,r=[],a=[],o=0,l=0,c=0,h=0,d=0,u=this.path.length;d<u;++d){switch((t=this.path[d])[0]){case"L":c=t[1],h=t[2],s=[];break;case"M":o=c=t[1],l=h=t[2],s=[];break;case"C":s=e.util.getBoundsOfCurve(c,h,t[1],t[2],t[3],t[4],t[5],t[6]),c=t[5],h=t[6];break;case"Q":s=e.util.getBoundsOfCurve(c,h,t[1],t[2],t[1],t[2],t[3],t[4]),c=t[3],h=t[4];break;case"z":case"Z":c=o,h=l}s.forEach((function(t){r.push(t.x),a.push(t.y)})),r.push(c),a.push(h)}var f=i(r)||0,p=i(a)||0;return{left:f,top:p,width:(n(r)||0)-f,height:(n(a)||0)-p}}}),e.Path.fromObject=function(t,i){if("string"==typeof t.sourcePath){var n=t.sourcePath;e.loadSVGFromURL(n,(function(n){var s=n[0];s.setOptions(t),t.clipPath?e.util.enlivenObjects([t.clipPath],(function(t){s.clipPath=t[0],i&&i(s)})):i&&i(s)}))}else e.Object._fromObject("Path",t,i,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,n){var r=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);r.fromSVG=!0,i(new e.Path(r.d,s(r,n)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.array.min,n=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,i){e=e||{},this._objects=[],i&&this.callSuper("initialize",e),this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;if(i)this._updateObjectsACoords();else{var s=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),s||this._calcBounds(),this._updateObjectsCoords(s),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var i=t.left,n=t.top;t.set({left:i-e.x,top:n-e.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var i=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(i&&e.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,i?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,i){var n=this._objects.length;if(this.useSetOnGroup)for(;n--;)this._objects[n].setOnGroup(t,i);if("canvas"===t)for(;n--;)this._objects[n]._set(t,i);e.Object.prototype._set.call(this,t,i)},toObject:function(t){var i=this.includeDefaultValues,n=this._objects.filter((function(t){return!t.excludeFromExport})).map((function(e){var n=e.includeDefaultValues;e.includeDefaultValues=i;var s=e.toObject(t);return e.includeDefaultValues=n,s})),s=e.Object.prototype.toObject.call(this,t);return s.objects=n,s},toDatalessObject:function(t){var i,n=this.sourcePath;if(n)i=n;else{var s=this.includeDefaultValues;i=this._objects.map((function(e){var i=e.includeDefaultValues;e.includeDefaultValues=s;var n=e.toDatalessObject(t);return e.includeDefaultValues=i,n}))}var r=e.Object.prototype.toDatalessObject.call(this,t);return r.objects=i,r},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var i=0,n=this._objects.length;i<n;i++)if(this._objects[i].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,i=this._objects.length;t<i;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,i=this._objects.length;e<i;e++)this._objects[e].render(t);this._drawClipPath(t,this.clipPath)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,i=this._objects.length;e<i;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var n=this.cacheWidth/this.zoomX,s=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-n/2,-s/2,n,s)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach((function(i){e.util.addTransformToObject(i,t),delete i.group,i.setCoords()})),this},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[]},toActiveSelection:function(){if(this.canvas){var t=this._objects,i=this.canvas;this._objects=[];var n=this.toObject();delete n.objects;var s=new e.ActiveSelection([]);return s.set(n),s.type="activeSelection",i.remove(this),t.forEach((function(t){t.group=s,t.dirty=!0,i.add(t)})),s.canvas=i,s._objects=t,i._activeObject=s,s.setCoords(),s}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(!0)})),this},_calcBounds:function(t){for(var e,i,n,s,r=[],a=[],o=["tr","br","bl","tl"],l=0,c=this._objects.length,h=o.length;l<c;++l){for(n=(e=this._objects[l]).calcACoords(),s=0;s<h;s++)i=o[s],r.push(n[i].x),a.push(n[i].y);e.aCoords=n}this._getBounds(r,a,t)},_getBounds:function(t,s,r){var a=new e.Point(i(t),i(s)),o=new e.Point(n(t),n(s)),l=a.y||0,c=a.x||0,h=o.x-a.x||0,d=o.y-a.y||0;this.width=h,this.height=d,r||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],i=0,n=this._objects.length;i<n;i++)e.push("\t\t",this._objects[i].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],i=0,n=this._objects.length;i<n;i++)e.push("\t",this._objects[i].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),e.Group.fromObject=function(t,i){var n=t.objects,s=e.util.object.clone(t,!0);delete s.objects,"string"!=typeof n?e.util.enlivenObjects(n,(function(n){e.util.enlivenObjectEnlivables(t,s,(function(){i&&i(new e.Group(n,s,!0))}))})):e.loadSVGFromURL(n,(function(r){var a=e.util.groupSVGElements(r,t,n),o=s.clipPath;delete s.clipPath,a.set(s),o?e.util.enlivenObjects([o],(function(t){a.clipPath=t[0],i&&i(a)})):i&&i(a)}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,i){i=i||{},this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;i.originX&&(this.originX=i.originX),i.originY&&(this.originY=i.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,i),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var i=e.Object.prototype.toObject.call(this),n=new e.Group([]);if(delete i.type,n.set(i),t.forEach((function(t){t.canvas.remove(t),t.group=n})),n._objects=t,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,i){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(i=i||{}).hasControls&&(i.hasControls=!1),i.forActiveSelection=!0;for(var n=0,s=this._objects.length;n<s;n++)this._objects[n]._renderControls(t,i);t.restore()}}),e.ActiveSelection.fromObject=function(t,i){e.util.enlivenObjects(t.objects,(function(n){delete t.objects,i&&i(new e.ActiveSelection(n,t,!0))}))})}(e),function(t){"use strict";var e=E.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?E.warn("fabric.Image is already defined."):(E.Image=E.util.createClass(E.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:E.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:E.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+E.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=E.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){E.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,-i),t.lineTo(e,-i),t.lineTo(e,i),t.lineTo(-e,i),t.lineTo(-e,-i),t.closePath()}},toObject:function(t){var i=[];this.filters.forEach((function(t){t&&i.push(t.toObject())}));var n=e(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:i});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e=[],i=[],n=this._element,s=-this.width/2,r=-this.height/2,a="",o="";if(!n)return[];if(this.hasCrop()){var l=E.Object.__uid++;e.push('<clipPath id="imageCrop_'+l+'">\n','\t<rect x="'+s+'" y="'+r+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(o='" image-rendering="optimizeSpeed'),i.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',s-this.cropX,'" y="',r-this.cropY,'" width="',n.width||n.naturalWidth,'" height="',n.height||n.height,o,'"',a,"></image>\n"),this.stroke||this.strokeDashArray){var c=this.fill;this.fill=null,t=["\t<rect ",'x="',s,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=c}return"fill"!==this.paintFirst?e.concat(t,i):e.concat(i,t)},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,i){return E.util.loadImage(t,(function(t,n){this.setElement(t,i),this._setWidthHeight(),e&&e(this,n)}),this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.scaleX,s=i.scaleY,r=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||n>e&&s>e)return this._element=r,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=s);E.filterBackend||(E.filterBackend=E.initFilterBackend());var a=E.util.createCanvasElement(),o=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=r.width,c=r.height;a.width=l,a.height=c,this._element=a,this._lastScaleX=t.scaleX=n,this._lastScaleY=t.scaleY=s,E.filterBackend.applyFilters([t],r,l,c,this._element,o),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,i=e.naturalWidth||e.width,n=e.naturalHeight||e.height;if(this._element===this._originalElement){var s=E.util.createCanvasElement();s.width=i,s.height=n,this._element=s,this._filteredEl=s}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1;return E.filterBackend||(E.filterBackend=E.initFilterBackend()),E.filterBackend.applyFilters(t,this._originalElement,i,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){E.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){E.util.setImageSmoothing(t,this.imageSmoothing),E.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element;if(e){var i=this._filterScalingX,n=this._filterScalingY,s=this.width,r=this.height,a=Math.min,o=Math.max,l=o(this.cropX,0),c=o(this.cropY,0),h=e.naturalWidth||e.width,d=e.naturalHeight||e.height,u=l*i,f=c*n,p=a(s*i,h-u),g=a(r*n,d-f),m=-s/2,v=-r/2,b=a(s,h/i-l),y=a(r,d/n-c);e&&t.drawImage(e,u,f,p,g,m,v,b,y)}},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(E.util.getById(t),e),E.util.addClass(this.getElement(),E.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?E.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=E.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,n=this._element.height,s=1,r=1,a=0,o=0,l=0,c=0,h=this.width,d=this.height,u={width:h,height:d};return!e||"none"===e.alignX&&"none"===e.alignY?(s=h/i,r=d/n):("meet"===e.meetOrSlice&&(t=(h-i*(s=r=E.util.findScaleToFit(this._element,u)))/2,"Min"===e.alignX&&(a=-t),"Max"===e.alignX&&(a=t),t=(d-n*r)/2,"Min"===e.alignY&&(o=-t),"Max"===e.alignY&&(o=t)),"slice"===e.meetOrSlice&&(t=i-h/(s=r=E.util.findScaleToCover(this._element,u)),"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=n-d/r,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),i=h/s,n=d/r)),{width:i,height:n,scaleX:s,scaleY:r,offsetLeft:a,offsetTop:o,cropX:l,cropY:c}}}),E.Image.CSS_CANVAS="canvas-img",E.Image.prototype.getSvgSrc=E.Image.prototype.getSrc,E.Image.fromObject=function(t,e){var i=E.util.object.clone(t);E.util.loadImage(i.src,(function(t,n){n?e&&e(null,!0):E.Image.prototype._initFilters.call(i,i.filters,(function(n){i.filters=n||[],E.Image.prototype._initFilters.call(i,[i.resizeFilter],(function(n){i.resizeFilter=n[0],E.util.enlivenObjectEnlivables(i,i,(function(){var n=new E.Image(t,i);e(n,!1)}))}))}))}),null,i.crossOrigin)},E.Image.fromURL=function(t,e,i){E.util.loadImage(t,(function(t,n){e&&e(new E.Image(t,i),n)}),null,i&&i.crossOrigin)},E.Image.ATTRIBUTE_NAMES=E.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),E.Image.fromElement=function(t,i,n){var s=E.parseAttributes(t,E.Image.ATTRIBUTE_NAMES);E.Image.fromURL(s["xlink:href"],i,e(n?E.util.object.clone(n):{},s))})}(e),E.util.object.extend(E.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){var e=function(){},i=(t=t||{}).onComplete||e,n=t.onChange||e,s=this;return E.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){s.rotate(t),n()},onComplete:function(){s.setCoords(),i()}})}}),E.util.object.extend(E.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){"use strict";function t(t,e){var i="precision "+e+" float;\nvoid main(){}",n=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(n,i),t.compileShader(n),!!t.getShaderParameter(n,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}E.isWebglSupported=function(e){if(E.isLikelyNode)return!1;e=e||E.WebglFilterBackend.prototype.tileSize;var i=document.createElement("canvas"),n=i.getContext("webgl")||i.getContext("experimental-webgl"),s=!1;if(n){E.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=E.maxTextureSize>=e;for(var r=["highp","mediump","lowp"],a=0;a<3;a++)if(t(n,r[a])){E.webGlPrecision=r[a];break}}return this.isSupported=s,s},E.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var i,n=void 0!==window.performance;try{new ImageData(1,1),i=!0}catch(t){i=!1}var s="undefined"!=typeof ArrayBuffer,r="undefined"!=typeof Uint8ClampedArray;if(n&&i&&s&&r){var a=E.util.createCanvasElement(),o=new ArrayBuffer(t*e*4);if(E.forceGLPutImageData)return this.imageBuffer=o,void(this.copyGLTo2D=O);var l,c,h={imageBuffer:o,destinationWidth:t,destinationHeight:e,targetCanvas:a};a.width=t,a.height=e,l=window.performance.now(),I.call(h,this.gl,h),c=window.performance.now()-l,l=window.performance.now(),O.call(h,this.gl,h),c>window.performance.now()-l?(this.imageBuffer=o,this.copyGLTo2D=O):this.copyGLTo2D=I}},createWebGLCanvas:function(t,e){var i=E.util.createCanvasElement();i.width=t,i.height=e;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},s=i.getContext("webgl",n);s||(s=i.getContext("experimental-webgl",n)),s&&(s.clearColor(0,0,0,0),this.canvas=i,this.gl=s)},applyFilters:function(t,e,i,n,s,r){var a,o=this.gl;r&&(a=this.getCachedTexture(r,e));var l={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:o,sourceTexture:this.createTexture(o,i,n,!a&&e),targetTexture:this.createTexture(o,i,n),originalTexture:a||this.createTexture(o,i,n,!a&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},c=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,c),t.forEach((function(t){t&&t.applyTo(l)})),function(t){var e=t.targetCanvas,i=e.width,n=e.height,s=t.destinationWidth,r=t.destinationHeight;i===s&&n===r||(e.width=s,e.height=r)}(l),this.copyGLTo2D(o,l),o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(l.sourceTexture),o.deleteTexture(l.targetTexture),o.deleteFramebuffer(c),s.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,i,n,s){var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,s||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,s||t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,i,0,t.RGBA,t.UNSIGNED_BYTE,null),r},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var i=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=i,i},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:I,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var i=t.getExtension("WEBGL_debug_renderer_info");if(i){var n=t.getParameter(i.UNMASKED_RENDERER_WEBGL),s=t.getParameter(i.UNMASKED_VENDOR_WEBGL);n&&(e.renderer=n.toLowerCase()),s&&(e.vendor=s.toLowerCase())}return this.gpuInfo=e,e}}}(),function(){"use strict";var t=function(){};function e(){}E.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,i,n,s){var r=s.getContext("2d");r.drawImage(e,0,0,i,n);var a={sourceWidth:i,sourceHeight:n,imageData:r.getImageData(0,0,i,n),originalEl:e,originalImageData:r.getImageData(0,0,i,n),canvasEl:s,ctx:r,filterBackend:this};return t.forEach((function(t){t.applyTo(a)})),a.imageData.width===i&&a.imageData.height===n||(s.width=a.imageData.width,s.height=a.imageData.height),r.putImageData(a.imageData,0,0),a}}}(),E.Image=E.Image||{},E.Image.filters=E.Image.filters||{},E.Image.filters.BaseFilter=E.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,i){e=e||this.fragmentSource,i=i||this.vertexSource,"highp"!==E.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+E.webGlPrecision+" float"));var n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(n));var s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(s));var r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,s),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(r));var a=this.getAttributeLocations(t,r),o=this.getUniformLocations(t,r)||{};return o.uStepW=t.getUniformLocation(r,"uStepW"),o.uStepH=t.getUniformLocation(r,"uStepH"),{program:r,attributeLocations:a,uniformLocations:o}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,i){var n=e.aPosition,s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(n),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,i,n=t.context;t.passes>1?(e=t.destinationWidth,i=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===i||(n.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(n,e,i)),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t.targetTexture,0)):(n.bindFramebuffer(n.FRAMEBUFFER,null),n.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=E.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var i=e[t].length;i--;)if(this[t][i]!==e[t][i])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,i=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(i.program),this.sendAttributeData(e,i.attributeLocations,t.aPosition),e.uniform1f(i.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(i.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,i.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,i){t.activeTexture(i),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),E.Image.filters.BaseFilter.fromObject=function(t,e){var i=new E.Image.filters[t.type](t);return e&&e(i),i},function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.ColorMatrix=n(i.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,i,n,s,r,a=t.imageData.data,o=a.length,l=this.matrix,c=this.colorsOnly;for(r=0;r<o;r+=4)e=a[r],i=a[r+1],n=a[r+2],c?(a[r]=e*l[0]+i*l[1]+n*l[2]+255*l[4],a[r+1]=e*l[5]+i*l[6]+n*l[7]+255*l[9],a[r+2]=e*l[10]+i*l[11]+n*l[12]+255*l[14]):(s=a[r+3],a[r]=e*l[0]+i*l[1]+n*l[2]+s*l[3]+255*l[4],a[r+1]=e*l[5]+i*l[6]+n*l[7]+s*l[8]+255*l[9],a[r+2]=e*l[10]+i*l[11]+n*l[12]+s*l[13]+255*l[14],a[r+3]=e*l[15]+i*l[16]+n*l[17]+s*l[18]+255*l[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var i=this.matrix,n=[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]],s=[i[4],i[9],i[14],i[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,n),t.uniform4fv(e.uConstants,s)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Brightness=n(i.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,i=t.imageData.data,n=i.length,s=Math.round(255*this.brightness);for(e=0;e<n;e+=4)i[e]=i[e]+s,i[e+1]=i[e+1]+s,i[e+2]=i[e+2]+s}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,s=e.util.createClass;n.Convolute=s(n.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),i=this.type+"_"+e+"_"+(this.opaque?1:0),n=this.fragmentSource[i];return t.programCache.hasOwnProperty(i)||(t.programCache[i]=this.createProgram(t.context,n)),t.programCache[i]},applyTo2d:function(t){var e,i,n,s,r,a,o,l,c,h,d,u,f,p=t.imageData,g=p.data,m=this.matrix,v=Math.round(Math.sqrt(m.length)),b=Math.floor(v/2),y=p.width,x=p.height,w=t.ctx.createImageData(y,x),C=w.data,S=this.opaque?1:0;for(d=0;d<x;d++)for(h=0;h<y;h++){for(r=4*(d*y+h),e=0,i=0,n=0,s=0,f=0;f<v;f++)for(u=0;u<v;u++)a=h+u-b,(o=d+f-b)<0||o>=x||a<0||a>=y||(l=4*(o*y+a),c=m[f*v+u],e+=g[l]*c,i+=g[l+1]*c,n+=g[l+2]*c,S||(s+=g[l+3]*c));C[r]=e,C[r+1]=i,C[r+2]=n,C[r+3]=S?g[r+3]:s}t.imageData=w},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Grayscale=n(i.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,i,n=t.imageData.data,s=n.length,r=this.mode;for(e=0;e<s;e+=4)"average"===r?i=(n[e]+n[e+1]+n[e+2])/3:"lightness"===r?i=(Math.min(n[e],n[e+1],n[e+2])+Math.max(n[e],n[e+1],n[e+2]))/2:"luminosity"===r&&(i=.21*n[e]+.72*n[e+1]+.07*n[e+2]),n[e]=i,n[e+1]=i,n[e+2]=i},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var i=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,i)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Invert=n(i.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,i=t.imageData.data,n=i.length;for(e=0;e<n;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,s=e.util.createClass;n.Noise=s(n.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,i,n=t.imageData.data,s=n.length,r=this.noise;for(e=0,s=n.length;e<s;e+=4)i=(.5-Math.random())*r,n[e]+=i,n[e+1]+=i,n[e+2]+=i}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Pixelate=n(i.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,i,n,s,r,a,o,l,c,h,d,u=t.imageData,f=u.data,p=u.height,g=u.width;for(i=0;i<p;i+=this.blocksize)for(n=0;n<g;n+=this.blocksize)for(s=f[e=4*i*g+4*n],r=f[e+1],a=f[e+2],o=f[e+3],h=Math.min(i+this.blocksize,p),d=Math.min(n+this.blocksize,g),l=i;l<h;l++)for(c=n;c<d;c++)f[e=4*l*g+4*c]=s,f[e+1]=r,f[e+2]=a,f[e+3]=o},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.Image.filters,s=e.util.createClass;n.RemoveColor=s(n.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var i,n,s,r,a=t.imageData.data,o=255*this.distance,l=new e.Color(this.color).getSource(),c=[l[0]-o,l[1]-o,l[2]-o],h=[l[0]+o,l[1]+o,l[2]+o];for(i=0;i<a.length;i+=4)n=a[i],s=a[i+1],r=a[i+2],n>c[0]&&s>c[1]&&r>c[2]&&n<h[0]&&s<h[1]&&r<h[2]&&(a[i+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,i){var n=new e.Color(this.color).getSource(),s=parseFloat(this.distance),r=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],a=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];t.uniform4fv(i.uLow,r),t.uniform4fv(i.uHigh,a)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass,s={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var r in s)i[r]=n(i.ColorMatrix,{type:r,matrix:s[r],mainParameter:!1,colorsOnly:!0}),e.Image.filters[r].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,i=e.Image.filters,n=e.util.createClass;i.BlendColor=n(i.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,i=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(i)||(e=this.buildSource(this.mode),t.programCache[i]=this.createProgram(t.context,e)),t.programCache[i]},applyTo2d:function(t){var i,n,s,r,a,o,l,c=t.imageData.data,h=c.length,d=1-this.alpha;i=(l=new e.Color(this.color).getSource())[0]*this.alpha,n=l[1]*this.alpha,s=l[2]*this.alpha;for(var u=0;u<h;u+=4)switch(r=c[u],a=c[u+1],o=c[u+2],this.mode){case"multiply":c[u]=r*i/255,c[u+1]=a*n/255,c[u+2]=o*s/255;break;case"screen":c[u]=255-(255-r)*(255-i)/255,c[u+1]=255-(255-a)*(255-n)/255,c[u+2]=255-(255-o)*(255-s)/255;break;case"add":c[u]=r+i,c[u+1]=a+n,c[u+2]=o+s;break;case"diff":case"difference":c[u]=Math.abs(r-i),c[u+1]=Math.abs(a-n),c[u+2]=Math.abs(o-s);break;case"subtract":c[u]=r-i,c[u+1]=a-n,c[u+2]=o-s;break;case"darken":c[u]=Math.min(r,i),c[u+1]=Math.min(a,n),c[u+2]=Math.min(o,s);break;case"lighten":c[u]=Math.max(r,i),c[u+1]=Math.max(a,n),c[u+2]=Math.max(o,s);break;case"overlay":c[u]=i<128?2*r*i/255:255-2*(255-r)*(255-i)/255,c[u+1]=n<128?2*a*n/255:255-2*(255-a)*(255-n)/255,c[u+2]=s<128?2*o*s/255:255-2*(255-o)*(255-s)/255;break;case"exclusion":c[u]=i+r-2*i*r/255,c[u+1]=n+a-2*n*a/255,c[u+2]=s+o-2*s*o/255;break;case"tint":c[u]=i+r*d,c[u+1]=n+a*d,c[u+2]=s+o*d}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,i){var n=new e.Color(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,t.uniform4fv(i.uColor,n)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,i=e.Image.filters,n=e.util.createClass;i.BlendImage=n(i.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,i=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,i)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,i=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,i,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,i=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/i,1]},applyTo2d:function(t){var i,n,s,r,a,o,l,c,h,d,u,f=t.imageData,p=t.filterBackend.resources,g=f.data,m=g.length,v=f.width,b=f.height,y=this.image;p.blendImage||(p.blendImage=e.util.createCanvasElement()),d=(h=p.blendImage).getContext("2d"),h.width!==v||h.height!==b?(h.width=v,h.height=b):d.clearRect(0,0,v,b),d.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),d.drawImage(y._element,0,0,v,b),u=d.getImageData(0,0,v,b).data;for(var x=0;x<m;x+=4)switch(a=g[x],o=g[x+1],l=g[x+2],c=g[x+3],i=u[x],n=u[x+1],s=u[x+2],r=u[x+3],this.mode){case"multiply":g[x]=a*i/255,g[x+1]=o*n/255,g[x+2]=l*s/255,g[x+3]=c*r/255;break;case"mask":g[x+3]=r}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var i=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,i)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,i){e.Image.fromObject(t.image,(function(n){var s=e.util.object.clone(t);s.image=n,i(new e.Image.filters.BlendImage(s))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=Math.pow,n=Math.floor,s=Math.sqrt,r=Math.abs,a=Math.round,o=Math.sin,l=Math.ceil,c=e.Image.filters,h=e.util.createClass;c.Resize=h(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),i=this.type+"_"+e;if(!t.programCache.hasOwnProperty(i)){var n=this.generateShader(e);t.programCache[i]=this.createProgram(t.context,n)}return t.programCache[i]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,i=this.getFilterWindow(),n=new Array(i),s=1;s<=i;s++)n[s-1]=t(s*e);return n},generateShader:function(t){for(var e=new Array(t),i=this.fragmentSourceTOP,n=1;n<=t;n++)e[n-1]=n+".0 * uDelta";return i+="uniform float uTaps["+t+"];\n",i+="void main() {\n",i+="  vec4 color = texture2D(uTexture, vTexCoord);\n",i+="  float sum = 1.0;\n",e.forEach((function(t,e){i+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",i+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",i+="  sum += 2.0 * uTaps["+e+"];\n"})),i+="  gl_FragColor = color / sum;\n",i+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;var i=(e*=Math.PI)/t;return o(e)/e*o(i)/i}},applyTo2d:function(t){var e=t.imageData,i=this.scaleX,n=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/n;var s,r=e.width,o=e.height,l=a(r*i),c=a(o*n);"sliceHack"===this.resizeType?s=this.sliceByTwo(t,r,o,l,c):"hermite"===this.resizeType?s=this.hermiteFastResize(t,r,o,l,c):"bilinear"===this.resizeType?s=this.bilinearFiltering(t,r,o,l,c):"lanczos"===this.resizeType&&(s=this.lanczosResize(t,r,o,l,c)),t.imageData=s},sliceByTwo:function(t,i,s,r,a){var o,l,c=t.imageData,h=.5,d=!1,u=!1,f=i*h,p=s*h,g=e.filterBackend.resources,m=0,v=0,b=i,y=0;for(g.sliceByTwo||(g.sliceByTwo=document.createElement("canvas")),((o=g.sliceByTwo).width<1.5*i||o.height<s)&&(o.width=1.5*i,o.height=s),(l=o.getContext("2d")).clearRect(0,0,1.5*i,s),l.putImageData(c,0,0),r=n(r),a=n(a);!d||!u;)i=f,s=p,r<n(f*h)?f=n(f*h):(f=r,d=!0),a<n(p*h)?p=n(p*h):(p=a,u=!0),l.drawImage(o,m,v,i,s,b,y,f,p),m=b,v=y,y+=p;return l.getImageData(m,v,r,a)},lanczosResize:function(t,e,a,o,c){var h=t.imageData.data,d=t.ctx.createImageData(o,c),u=d.data,f=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,g=this.rcpScaleY,m=2/this.rcpScaleX,v=2/this.rcpScaleY,b=l(p*this.lanczosLobes/2),y=l(g*this.lanczosLobes/2),x={},w={},C={};return function t(l){var S,T,E,A,I,O,k,M,P,_,D;for(w.x=(l+.5)*p,C.x=n(w.x),S=0;S<c;S++){for(w.y=(S+.5)*g,C.y=n(w.y),I=0,O=0,k=0,M=0,P=0,T=C.x-b;T<=C.x+b;T++)if(!(T<0||T>=e)){_=n(1e3*r(T-w.x)),x[_]||(x[_]={});for(var L=C.y-y;L<=C.y+y;L++)L<0||L>=a||(D=n(1e3*r(L-w.y)),x[_][D]||(x[_][D]=f(s(i(_*m,2)+i(D*v,2))/1e3)),(E=x[_][D])>0&&(I+=E,O+=E*h[A=4*(L*e+T)],k+=E*h[A+1],M+=E*h[A+2],P+=E*h[A+3]))}u[A=4*(S*o+l)]=O/I,u[A+1]=k/I,u[A+2]=M/I,u[A+3]=P/I}return++l<o?t(l):d}(0)},bilinearFiltering:function(t,e,i,s,r){var a,o,l,c,h,d,u,f,p,g=0,m=this.rcpScaleX,v=this.rcpScaleY,b=4*(e-1),y=t.imageData.data,x=t.ctx.createImageData(s,r),w=x.data;for(l=0;l<r;l++)for(c=0;c<s;c++)for(h=m*c-(a=n(m*c)),d=v*l-(o=n(v*l)),p=4*(o*e+a),u=0;u<4;u++)f=y[p+u]*(1-h)*(1-d)+y[p+4+u]*h*(1-d)+y[p+b+u]*d*(1-h)+y[p+b+4+u]*h*d,w[g++]=f;return x},hermiteFastResize:function(t,e,i,a,o){for(var c=this.rcpScaleX,h=this.rcpScaleY,d=l(c/2),u=l(h/2),f=t.imageData.data,p=t.ctx.createImageData(a,o),g=p.data,m=0;m<o;m++)for(var v=0;v<a;v++){for(var b=4*(v+m*a),y=0,x=0,w=0,C=0,S=0,T=0,E=0,A=(m+.5)*h,I=n(m*h);I<(m+1)*h;I++)for(var O=r(A-(I+.5))/u,k=(v+.5)*c,M=O*O,P=n(v*c);P<(v+1)*c;P++){var _=r(k-(P+.5))/d,D=s(M+_*_);D>1&&D<-1||(y=2*D*D*D-3*D*D+1)>0&&(E+=y*f[3+(_=4*(P+I*e))],w+=y,f[_+3]<255&&(y=y*f[_+3]/250),C+=y*f[_],S+=y*f[_+1],T+=y*f[_+2],x+=y)}g[b]=C/x,g[b+1]=S/x,g[b+2]=T/x,g[b+3]=E/w}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Contrast=n(i.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,i=t.imageData.data,n=i.length,s=Math.floor(255*this.contrast),r=259*(s+255)/(255*(259-s));for(e=0;e<n;e+=4)i[e]=r*(i[e]-128)+128,i[e+1]=r*(i[e+1]-128)+128,i[e+2]=r*(i[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Saturation=n(i.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,i,n=t.imageData.data,s=n.length,r=-this.saturation;for(e=0;e<s;e+=4)i=Math.max(n[e],n[e+1],n[e+2]),n[e]+=i!==n[e]?(i-n[e])*r:0,n[e+1]+=i!==n[e+1]?(i-n[e+1])*r:0,n[e+2]+=i!==n[e+2]?(i-n[e+2])*r:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Vibrance=n(i.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(t){if(0!==this.vibrance){var e,i,n,s,r=t.imageData.data,a=r.length,o=-this.vibrance;for(e=0;e<a;e+=4)i=Math.max(r[e],r[e+1],r[e+2]),n=(r[e]+r[e+1]+r[e+2])/3,s=2*Math.abs(i-n)/255*o,r[e]+=i!==r[e]?(i-r[e])*s:0,r[e+1]+=i!==r[e+1]?(i-r[e+1])*s:0,r[e+2]+=i!==r[e+2]?(i-r[e+2])*s:0}},getUniformLocations:function(t,e){return{uVibrance:t.getUniformLocation(e,"uVibrance")}},sendUniformData:function(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Blur=n(i.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var i,n,s=t.filterBackend.resources,r=t.imageData.width,a=t.imageData.height;s.blurLayer1||(s.blurLayer1=e.util.createCanvasElement(),s.blurLayer2=e.util.createCanvasElement()),i=s.blurLayer1,n=s.blurLayer2,i.width===r&&i.height===a||(n.width=i.width=r,n.height=i.height=a);var o,l,c,h,d=i.getContext("2d"),u=n.getContext("2d"),f=.06*this.blur*.5;for(d.putImageData(t.imageData,0,0),u.clearRect(0,0,r,a),h=-15;h<=15;h++)c=f*(l=h/15)*r+(o=(Math.random()-.5)/4),u.globalAlpha=1-Math.abs(l),u.drawImage(i,c,o),d.drawImage(n,0,0),u.globalAlpha=1,u.clearRect(0,0,n.width,n.height);for(h=-15;h<=15;h++)c=f*(l=h/15)*a+(o=(Math.random()-.5)/4),u.globalAlpha=1-Math.abs(l),u.drawImage(i,o,c),d.drawImage(n,0,0),u.globalAlpha=1,u.clearRect(0,0,n.width,n.height);t.ctx.drawImage(i,0,0);var p=t.ctx.getImageData(0,0,i.width,i.height);return d.globalAlpha=1,d.clearRect(0,0,i.width,i.height),p},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var i=this.chooseRightDelta();t.uniform2fv(e.delta,i)},chooseRightDelta:function(){var t,e=1,i=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?i[0]=t:i[1]=t,i}}),i.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Gamma=n(i.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],i.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,i=t.imageData.data,n=this.gamma,s=i.length,r=1/n[0],a=1/n[1],o=1/n[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,s=256;e<s;e++)this.rVals[e]=255*Math.pow(e/255,r),this.gVals[e]=255*Math.pow(e/255,a),this.bVals[e]=255*Math.pow(e/255,o);for(e=0,s=i.length;e<s;e+=4)i[e]=this.rVals[i[e]],i[e+1]=this.gVals[i[e+1]],i[e+2]=this.bVals[i[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.Composed=n(i.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,i){var n=(t.subFilters||[]).map((function(t){return new e.Image.filters[t.type](t)})),s=new e.Image.filters.Composed({subFilters:n});return i&&i(s),s}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.Image.filters,n=e.util.createClass;i.HueRotation=n(i.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,i=e.util.cos(t),n=e.util.sin(t),s=1/3,r=Math.sqrt(s)*n,a=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+a/3,this.matrix[1]=s*a-r,this.matrix[2]=s*a+r,this.matrix[5]=s*a+r,this.matrix[6]=i+s*a,this.matrix[7]=s*a-r,this.matrix[10]=s*a-r,this.matrix[11]=s*a+r,this.matrix[12]=i+s*a},isNeutralState:function(t){return this.calculateMatrix(),i.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),i.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.clone;if(e.Text)e.warn("fabric.Text is already defined");else{var n="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(n),cacheProperties:e.Object.prototype.cacheProperties.concat(n),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=e.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,i,n,s,r,a,o=0,l=this._textLines.length;o<l;o++)if(("justify"===this.textAlign||o!==l-1&&!this.isEndOfWrapping(o))&&(n=0,s=this._textLines[o],(e=this.getLineWidth(o))<this.width&&(a=this.textLines[o].match(this._reSpacesAndTabs)))){i=a.length,t=(this.width-e)/i;for(var c=0,h=s.length;c<=h;c++)r=this.__charBounds[o][c],this._reSpaceAndTab.test(s[c])?(r.width+=t,r.kernedWidth+=t,r.left+=n,n+=t):r.left+=n}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){var e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,i){if(t.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":t.textBaseline="middle";break;case"ascender":t.textBaseline="top";break;case"descender":t.textBaseline="bottom"}t.font=this._getFontDeclaration(e,i)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,i=this._textLines.length;e<i;e++){var n=this.getLineWidth(e);n>t&&(t=n)}return t},_renderTextLine:function(t,e,i,n,s,r){this._renderChars(t,e,i,n,s,r)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,i,n,s,r,a,o,l=t.fillStyle,c=this._getLeftOffset(),h=this._getTopOffset(),d=0,u=0,f=this.path,p=0,g=this._textLines.length;p<g;p++)if(e=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){n=this._textLines[p],i=this._getLineLeftOffset(p),u=0,d=0,s=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var m=0,v=n.length;m<v;m++)r=this.__charBounds[p][m],a=this.getValueOfPropertyAt(p,m,"textBackgroundColor"),f?(t.save(),t.translate(r.renderLeft,r.renderTop),t.rotate(r.angle),t.fillStyle=a,a&&t.fillRect(-r.width/2,-e/this.lineHeight*(1-this._fontSizeFraction),r.width,e/this.lineHeight),t.restore()):a!==s?(o=c+i+d,"rtl"===this.direction&&(o=this.width-o-u),t.fillStyle=s,s&&t.fillRect(o,h,u,e/this.lineHeight),d=r.left,u=r.width,s=a):u+=r.kernedWidth;a&&!f&&(o=c+i+d,"rtl"===this.direction&&(o=this.width-o-u),t.fillStyle=a,t.fillRect(o,h,u,e/this.lineHeight)),h+=e}else h+=e;t.fillStyle=l,this._removeShadow(t)}},getFontCache:function(t){var i=t.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var n=e.charWidthsCache[i],s=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return n[s]||(n[s]={}),n[s]},_measureChar:function(t,e,i,n){var s,r,a,o,l=this.getFontCache(e),c=i+t,h=this._getFontDeclaration(e)===this._getFontDeclaration(n),d=e.fontSize/this.CACHE_FONT_SIZE;if(i&&void 0!==l[i]&&(a=l[i]),void 0!==l[t]&&(o=s=l[t]),h&&void 0!==l[c]&&(o=(r=l[c])-a),void 0===s||void 0===a||void 0===r){var u=this.getMeasuringContext();this._setTextStyles(u,e,!0)}return void 0===s&&(o=s=u.measureText(t).width,l[t]=s),void 0===a&&h&&i&&(a=u.measureText(i).width,l[i]=a),h&&void 0===r&&(r=u.measureText(c).width,l[c]=r,o=r-a),{width:s*d,kernedWidth:o*d}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var i,n,s,r,a,o,l=0,c=this._textLines[t],h=new Array(c.length),d=0,u=this.path,f="right"===this.pathSide;for(this.__charBounds[t]=h,i=0;i<c.length;i++)n=c[i],r=this._getGraphemeBox(n,t,i,s),h[i]=r,l+=r.kernedWidth,s=n;if(h[i]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize},u){switch(o=u.segmentsInfo[u.segmentsInfo.length-1].length,(a=e.util.getPointOnPath(u.path,0,u.segmentsInfo)).x+=u.pathOffset.x,a.y+=u.pathOffset.y,this.textAlign){case"left":d=f?o-l:0;break;case"center":d=(o-l)/2;break;case"right":d=f?0:o-l}for(d+=this.pathStartOffset*(f?-1:1),i=f?c.length-1:0;f?i>=0:i<c.length;f?i--:i++)r=h[i],d>o?d%=o:d<0&&(d+=o),this._setGraphemeOnPath(d,r,a),d+=r.kernedWidth}return{width:l,numOfSpaces:0}},_setGraphemeOnPath:function(t,i,n){var s=t+i.kernedWidth/2,r=this.path,a=e.util.getPointOnPath(r.path,s,r.segmentsInfo);i.renderLeft=a.x-n.x,i.renderTop=a.y-n.y,i.angle=a.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(t,e,i,n,s){var r,a=this.getCompleteStyleDeclaration(e,i),o=n?this.getCompleteStyleDeclaration(e,i-1):{},l=this._measureChar(t,a,n,o),c=l.kernedWidth,h=l.width;0!==this.charSpacing&&(h+=r=this._getWidthOfCharSpacing(),c+=r);var d={width:h,left:0,height:a.fontSize,kernedWidth:c,deltaY:a.deltaY};if(i>0&&!s){var u=this.__charBounds[e][i-1];d.left=u.left+u.width+l.kernedWidth-l.width}return d},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],i=this.getHeightOfChar(t,0),n=1,s=e.length;n<s;n++)i=Math.max(this.getHeightOfChar(t,n),i);return this.__lineHeights[t]=i*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,i=0,n=this._textLines.length;i<n;i++)t=this.getHeightOfLine(i),e+=i===n-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var i=0,n=this._getLeftOffset(),s=this._getTopOffset(),r=0,a=this._textLines.length;r<a;r++){var o=this.getHeightOfLine(r),l=o/this.lineHeight,c=this._getLineLeftOffset(r);this._renderTextLine(e,t,this._textLines[r],n+c,s+i+l,r),i+=o}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,i,n,s,r,a){var o,l,c,h,d,u=this.getHeightOfLine(a),f=-1!==this.textAlign.indexOf("justify"),p="",g=0,m=this.path,v=!f&&0===this.charSpacing&&this.isEmptyStyles(a)&&!m,b="ltr"===this.direction,y="ltr"===this.direction?1:-1,x=i.canvas.getAttribute("dir");if(i.save(),x!==this.direction&&(i.canvas.setAttribute("dir",b?"ltr":"rtl"),i.direction=b?"ltr":"rtl",i.textAlign=b?"left":"right"),r-=u*this._fontSizeFraction/this.lineHeight,v)return this._renderChar(t,i,a,0,n.join(""),s,r,u),void i.restore();for(var w=0,C=n.length-1;w<=C;w++)h=w===C||this.charSpacing||m,p+=n[w],c=this.__charBounds[a][w],0===g?(s+=y*(c.kernedWidth-c.width),g+=c.width):g+=c.kernedWidth,f&&!h&&this._reSpaceAndTab.test(n[w])&&(h=!0),h||(o=o||this.getCompleteStyleDeclaration(a,w),l=this.getCompleteStyleDeclaration(a,w+1),h=e.util.hasStyleChanged(o,l,!1)),h&&(m?(i.save(),i.translate(c.renderLeft,c.renderTop),i.rotate(c.angle),this._renderChar(t,i,a,w,p,-g/2,0,u),i.restore()):(d=s,this._renderChar(t,i,a,w,p,d,r,u)),p="",o=l,s+=y*g,g=0);i.restore()},_applyPatternGradientTransformText:function(t){var i,n=e.util.createCanvasElement(),s=this.width+this.strokeWidth,r=this.height+this.strokeWidth;return n.width=s,n.height=r,(i=n.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(s,0),i.lineTo(s,r),i.lineTo(0,r),i.closePath(),i.translate(s/2,r/2),i.fillStyle=t.toLive(i),this._applyPatternGradientTransform(i,t),i.fill(),i.createPattern(n,"no-repeat")},handleFiller:function(t,e,i){var n,s;return i.toLive?"percentage"===i.gradientUnits||i.gradientTransform||i.patternTransform?(n=-this.width/2,s=-this.height/2,t.translate(n,s),t[e]=this._applyPatternGradientTransformText(i),{offsetX:n,offsetY:s}):(t[e]=i.toLive(t,this),this._applyPatternGradientTransform(t,i)):(t[e]=i,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,e){return t.lineWidth=e.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",e.stroke)},_setFillStyles:function(t,e){return this.handleFiller(t,"fillStyle",e.fill)},_renderChar:function(t,e,i,n,s,r,a){var o,l,c=this._getStyleDeclaration(i,n),h=this.getCompleteStyleDeclaration(i,n),d="fillText"===t&&h.fill,u="strokeText"===t&&h.stroke&&h.strokeWidth;(u||d)&&(e.save(),d&&(o=this._setFillStyles(e,h)),u&&(l=this._setStrokeStyles(e,h)),e.font=this._getFontDeclaration(h),c&&c.textBackgroundColor&&this._removeShadow(e),c&&c.deltaY&&(a+=c.deltaY),d&&e.fillText(s,r-o.offsetX,a-o.offsetY),u&&e.strokeText(s,r-l.offsetX,a-l.offsetY),e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,i){var n=this.get2DCursorLocation(t,!0),s=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"fontSize"),r=this.getValueOfPropertyAt(n.lineIndex,n.charIndex,"deltaY"),a={fontSize:s*i.size,deltaY:r+s*i.baseline};return this.setSelectionStyles(a,t,e),this},_getLineLeftOffset:function(t){var e=this.getLineWidth(t),i=this.width-e,n=this.textAlign,s=this.direction,r=0,a=this.isEndOfWrapping(t);return"justify"===n||"justify-center"===n&&!a||"justify-right"===n&&!a||"justify-left"===n&&!a?0:("center"===n&&(r=i/2),"right"===n&&(r=i),"justify-center"===n&&(r=i/2),"justify-right"===n&&(r=i),"rtl"===s&&(r-=i),r)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){if(void 0!==this.__lineWidths[t])return this.__lineWidths[t];var e=this.measureLine(t).width;return this.__lineWidths[t]=e,e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,i){var n=this._getStyleDeclaration(t,e);return n&&void 0!==n[i]?n[i]:this[i]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var i,n,s,r,a,o,l,c,h,d,u,f,p,g,m,v,b=this._getLeftOffset(),y=this._getTopOffset(),x=this.path,w=this._getWidthOfCharSpacing(),C=this.offsets[e],S=0,T=this._textLines.length;S<T;S++)if(i=this.getHeightOfLine(S),this[e]||this.styleHas(e,S)){l=this._textLines[S],g=i/this.lineHeight,r=this._getLineLeftOffset(S),d=0,u=0,c=this.getValueOfPropertyAt(S,0,e),v=this.getValueOfPropertyAt(S,0,"fill"),h=y+g*(1-this._fontSizeFraction),n=this.getHeightOfChar(S,0),a=this.getValueOfPropertyAt(S,0,"deltaY");for(var E=0,A=l.length;E<A;E++)if(f=this.__charBounds[S][E],p=this.getValueOfPropertyAt(S,E,e),m=this.getValueOfPropertyAt(S,E,"fill"),s=this.getHeightOfChar(S,E),o=this.getValueOfPropertyAt(S,E,"deltaY"),x&&p&&m)t.save(),t.fillStyle=v,t.translate(f.renderLeft,f.renderTop),t.rotate(f.angle),t.fillRect(-f.kernedWidth/2,C*s+o,f.kernedWidth,this.fontSize/15),t.restore();else if((p!==c||m!==v||s!==n||o!==a)&&u>0){var I=b+r+d;"rtl"===this.direction&&(I=this.width-I-u),c&&v&&(t.fillStyle=v,t.fillRect(I,h+C*n+a,u,this.fontSize/15)),d=f.left,u=f.width,c=p,v=m,n=s,a=o}else u+=f.kernedWidth;I=b+r+d,"rtl"===this.direction&&(I=this.width-I-u),t.fillStyle=m,p&&m&&t.fillRect(I,h+C*n+a,u-w,this.fontSize/15),y+=i}else y+=i;this._removeShadow(t)}},_getFontDeclaration:function(t,i){var n=t||this,s=this.fontFamily,r=e.Text.genericFonts.indexOf(s.toLowerCase())>-1,a=void 0===s||s.indexOf("'")>-1||s.indexOf(",")>-1||s.indexOf('"')>-1||r?n.fontFamily:'"'+n.fontFamily+'"';return[e.isLikelyNode?n.fontWeight:n.fontStyle,e.isLikelyNode?n.fontStyle:n.fontWeight,i?this.CACHE_FONT_SIZE+"px":n.fontSize+"px",a].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var i=t.split(this._reNewline),n=new Array(i.length),s=["\n"],r=[],a=0;a<i.length;a++)n[a]=e.util.string.graphemeSplit(i[a]),r=r.concat(n[a],s);return r.pop(),{_unwrappedLines:n,lines:i,graphemeText:r,graphemeLines:n}},toObject:function(t){var i=n.concat(t),s=this.callSuper("toObject",i);return s.styles=e.util.stylesToArray(this.styles,this.text),s.path&&(s.path=this.path.toObject()),s},set:function(t,e){this.callSuper("set",t,e);var i=!1,n=!1;if("object"==typeof t)for(var s in t)"path"===s&&this.setPathInfo(),i=i||-1!==this._dimensionAffectingProps.indexOf(s),n=n||"path"===s;else i=-1!==this._dimensionAffectingProps.indexOf(t),n="path"===t;return n&&this.setPathInfo(),i&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,n,s){if(!t)return n(null);var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),a=r.textAnchor||"left";if((s=e.util.object.extend(s?i(s):{},r)).top=s.top||0,s.left=s.left||0,r.textDecoration){var o=r.textDecoration;-1!==o.indexOf("underline")&&(s.underline=!0),-1!==o.indexOf("overline")&&(s.overline=!0),-1!==o.indexOf("line-through")&&(s.linethrough=!0),delete s.textDecoration}"dx"in r&&(s.left+=r.dx),"dy"in r&&(s.top+=r.dy),"fontSize"in s||(s.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in t?l=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(l=t.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=s.strokeWidth;s.strokeWidth=0;var h=new e.Text(l,s),d=h.getScaledHeight()/h.height,u=((h.height+h.strokeWidth)*h.lineHeight-h.height)*d,f=h.getScaledHeight()+u,p=0;"center"===a&&(p=h.getScaledWidth()/2),"right"===a&&(p=h.getScaledWidth()),h.set({left:h.left-p,top:h.top-(f-h.fontSize*(.07+h._fontSizeFraction))/h.lineHeight,strokeWidth:void 0!==c?c:1}),n(h)},e.Text.fromObject=function(t,n){var s=i(t),r=t.path;return delete s.path,e.Object._fromObject("Text",s,(function(i){i.styles=e.util.stylesFromArray(t.styles,t.text),r?e.Object._fromObject("Path",r,(function(t){i.set("path",t),n(i)}),"path"):n(i)}),"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}}(e),E.util.object.extend(E.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e=void 0===t?this.styles:{line:this.styles[t]};for(var i in e)for(var n in e[i])for(var s in e[i][n])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var i=void 0===e?this.styles:{0:this.styles[e]};for(var n in i)for(var s in i[n])if(void 0!==i[n][s][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,i,n=this.styles,s=0,r=!0,a=0;for(var o in n){for(var l in e=0,n[o]){var c;s++,(c=n[o][l]).hasOwnProperty(t)?(i?c[t]!==i&&(r=!1):i=c[t],c[t]===this[t]&&delete c[t]):r=!1,0!==Object.keys(c).length?e++:delete n[o][l]}0===e&&delete n[o]}for(var h=0;h<this._textLines.length;h++)a+=this._textLines[h].length;r&&s===a&&(this[t]=i,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,i,n,s=this.styles;for(i in s){for(n in e=s[i])delete e[n][t],0===Object.keys(e[n]).length&&delete e[n];0===Object.keys(e).length&&delete s[i]}}},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this._getLineStyle(i.lineIndex)||this._setLineStyle(i.lineIndex),this._getStyleDeclaration(i.lineIndex,i.charIndex)||this._setStyleDeclaration(i.lineIndex,i.charIndex,{}),E.util.object.extend(this._getStyleDeclaration(i.lineIndex,i.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var i=e?this._unwrappedTextLines:this._textLines,n=i.length,s=0;s<n;s++){if(t<=i[s].length)return{lineIndex:s,charIndex:t};t-=i[s].length+this.missingNewlineOffset(s)}return{lineIndex:s-1,charIndex:i[s-1].length<t?i[s-1].length:t}},getSelectionStyles:function(t,e,i){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var n=[],s=t;s<e;s++)n.push(this.getStyleAtPosition(s,i));return n},getStyleAtPosition:function(t,e){var i=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(i.lineIndex,i.charIndex):this._getStyleDeclaration(i.lineIndex,i.charIndex))||{}},setSelectionStyles:function(t,e,i){void 0===e&&(e=this.selectionStart||0),void 0===i&&(i=this.selectionEnd||e);for(var n=e;n<i;n++)this._extendStyles(n,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var i=this.styles&&this.styles[t];return i?i[e]:null},getCompleteStyleDeclaration:function(t,e){for(var i,n=this._getStyleDeclaration(t,e)||{},s={},r=0;r<this._styleProperties.length;r++)s[i=this._styleProperties[r]]=void 0===n[i]?this[i]:n[i];return s},_setStyleDeclaration:function(t,e,i){this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}E.IText=E.util.createClass(E.Text,E.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,i=this.canvas.viewportTransform;e.save(),e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(e),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,i=this.height+4;t.clearRect(-e/2,-i/2,e,i)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),i=this._getTopOffset(),n=this._getCursorBoundariesOffsets(t);return{left:e,top:i,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,i,n,s,r=0,a=0,o=this.get2DCursorLocation(t);n=o.charIndex,i=o.lineIndex;for(var l=0;l<i;l++)r+=this.getHeightOfLine(l);e=this._getLineLeftOffset(i);var c=this.__charBounds[i][n];return c&&(a=c.left),0!==this.charSpacing&&n===this._textLines[i].length&&(a-=this._getWidthOfCharSpacing()),s={top:r,left:e+(a>0?a:0)},"rtl"===this.direction&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(t,e){var i=this.get2DCursorLocation(),n=i.lineIndex,s=i.charIndex>0?i.charIndex-1:0,r=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.scaleX*this.canvas.getZoom(),o=this.cursorWidth/a,l=t.topOffset,c=this.getValueOfPropertyAt(n,s,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-r*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-o/2,l+t.top+c,o,r)},renderSelection:function(t,e){for(var i=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=-1!==this.textAlign.indexOf("justify"),r=this.get2DCursorLocation(i),a=this.get2DCursorLocation(n),o=r.lineIndex,l=a.lineIndex,c=r.charIndex<0?0:r.charIndex,h=a.charIndex<0?0:a.charIndex,d=o;d<=l;d++){var u,f=this._getLineLeftOffset(d)||0,p=this.getHeightOfLine(d),g=0,m=0;if(d===o&&(g=this.__charBounds[o][c].left),d>=o&&d<l)m=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===l)if(0===h)m=this.__charBounds[l][h].left;else{var v=this._getWidthOfCharSpacing();m=this.__charBounds[l][h-1].left+this.__charBounds[l][h-1].width-v}u=p,(this.lineHeight<1||d===l&&this.lineHeight>1)&&(p/=this.lineHeight);var b=t.left+f+g,y=m-g,x=p,w=0;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",x=1,w=p):e.fillStyle=this.selectionColor,"rtl"===this.direction&&(b=this.width-b-y),e.fillRect(b,t.top+t.topOffset+w,y,x),t.topOffset+=u}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),E.IText.fromObject=function(e,i){var n=E.util.stylesFromArray(e.styles,e.text),s=Object.assign({},e,{styles:n});if(t(s),s.styles)for(var r in s.styles)for(var a in s.styles[r])t(s.styles[r][a]);E.Object._fromObject("IText",s,i,"text")}}(),C=E.util.object.clone,E.util.object.extend(E.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],E.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,i,n){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:i,onComplete:function(){s.isAborted||t[n]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),i)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i--;for(;/\S/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this._text[i]))for(;this._reSpace.test(this._text[i]);)e++,i++;for(;/\S/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this._text[i])&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this._text[i])&&i<this._text.length;)e++,i++;return t+e},searchWordBoundary:function(t,e){for(var i=this._text,n=this._reSpace.test(i[t])?t-1:t,s=i[n],r=E.reNonWord;!r.test(s)&&n>0&&n<i.length;)s=i[n+=e];return r.test(s)&&(n+=1===e?0:1),n},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var e=this.getSelectionStartFromPointer(t.e),i=this.selectionStart,n=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&i!==n||i!==e&&n!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===n||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,i){var n=i.slice(0,t),s=E.util.string.graphemeSplit(n).length;if(t===e)return{selectionStart:s,selectionEnd:s};var r=i.slice(t,e);return{selectionStart:s,selectionEnd:s+E.util.string.graphemeSplit(r).length}},fromGraphemeToStringSelection:function(t,e,i){var n=i.slice(0,t).join("").length;return t===e?{selectionStart:n,selectionEnd:n}:{selectionStart:n,selectionEnd:n+i.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),i=this.get2DCursorLocation(t),n=i.lineIndex,s=i.charIndex,r=this.getValueOfPropertyAt(n,s,"fontSize")*this.lineHeight,a=e.leftOffset,o=this.calcTransformMatrix(),l={x:e.left+a,y:e.top+e.topOffset+r},c=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/c,u=h.height/c,f=d-r,p=u-r,g=h.clientWidth/d,m=h.clientHeight/u;return l=E.util.transformPoint(l,o),(l=E.util.transformPoint(l,this.canvas.viewportTransform)).x*=g,l.y*=m,l.x<0&&(l.x=0),l.x>f&&(l.x=f),l.y<0&&(l.y=0),l.y>p&&(l.y=p),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,e=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var i,n,s=this.get2DCursorLocation(t,!0),r=this.get2DCursorLocation(e,!0),a=s.lineIndex,o=s.charIndex,l=r.lineIndex,c=r.charIndex;if(a!==l){if(this.styles[a])for(i=o;i<this._unwrappedTextLines[a].length;i++)delete this.styles[a][i];if(this.styles[l])for(i=c;i<this._unwrappedTextLines[l].length;i++)(n=this.styles[l][i])&&(this.styles[a]||(this.styles[a]={}),this.styles[a][o+i-c]=n);for(i=a+1;i<=l;i++)delete this.styles[i];this.shiftLineStyles(l,a-l)}else if(this.styles[a]){n=this.styles[a];var h,d,u=c-o;for(i=o;i<c;i++)delete n[i];for(d in this.styles[a])(h=parseInt(d,10))>=c&&(n[h-u]=n[d],delete n[d])}},shiftLineStyles:function(t,e){var i=C(this.styles);for(var n in this.styles){var s=parseInt(n,10);s>t&&(this.styles[s+e]=i[s],i[s-e]||delete this.styles[s])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(t,e,i,n){var s,r={},a=!1,o=this._unwrappedTextLines[t].length===e;for(var l in i||(i=1),this.shiftLineStyles(t,i),this.styles[t]&&(s=this.styles[t][0===e?e:e-1]),this.styles[t]){var c=parseInt(l,10);c>=e&&(a=!0,r[c-e]=this.styles[t][l],o&&0===e||delete this.styles[t][l])}var h=!1;for(a&&!o&&(this.styles[t+i]=r,h=!0),h&&i--;i>0;)n&&n[i-1]?this.styles[t+i]={0:C(n[i-1])}:s?this.styles[t+i]={0:C(s)}:delete this.styles[t+i],i--;this._forceClearCache=!0},insertCharStyleObject:function(t,e,i,n){this.styles||(this.styles={});var s=this.styles[t],r=s?C(s):{};for(var a in i||(i=1),r){var o=parseInt(a,10);o>=e&&(s[o+i]=r[o],r[o-i]||delete s[o])}if(this._forceClearCache=!0,n)for(;i--;)Object.keys(n[i]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+i]=C(n[i]));else if(s)for(var l=s[e?e-1:1];l&&i--;)this.styles[t][e+i]=C(l)},insertNewStyleBlock:function(t,e,i){for(var n=this.get2DCursorLocation(e,!0),s=[0],r=0,a=0;a<t.length;a++)"\n"===t[a]?s[++r]=0:s[r]++;for(s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],i),i=i&&i.slice(s[0]+1)),r&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],r),a=1;a<r;a++)s[a]>0?this.insertCharStyleObject(n.lineIndex+a,0,s[a],i):i&&this.styles[n.lineIndex+a]&&i[0]&&(this.styles[n.lineIndex+a][0]=i[0]),i=i&&i.slice(s[a]+1);s[a]>0&&this.insertCharStyleObject(n.lineIndex+a,0,s[a],i)},setSelectionStartEndWithShift:function(t,e,i){i<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=i):i>t&&i<e?"right"===this._selectionDirection?this.selectionEnd=i:this.selectionStart=i:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=i)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}}),E.util.object.extend(E.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),i=this.selectionStart,n=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(i,n,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e,i=this.getLocalPointer(t),n=0,s=0,r=0,a=0,o=0,l=0,c=this._textLines.length;l<c&&r<=i.y;l++)r+=this.getHeightOfLine(l)*this.scaleY,o=l,l>0&&(a+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));s=this._getLineLeftOffset(o)*this.scaleX,e=this._textLines[o],"rtl"===this.direction&&(i.x=this.width*this.scaleX-i.x+s);for(var h=0,d=e.length;h<d&&(n=s,(s+=this.__charBounds[o][h].kernedWidth*this.scaleX)<=i.x);h++)a++;return this._getNewSelectionStartFromOffset(i,n,s,a,d)},_getNewSelectionStartFromOffset:function(t,e,i,n,s){var r=t.x-e,a=i-t.x,o=n+(a>r||a<0?0:1);return this.flipX&&(o=s-o),o>this._text.length&&(o=this._text.length),o}}),E.util.object.extend(E.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=E.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):E.document.body.appendChild(this.hiddenTextarea),E.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),E.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),E.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),E.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),E.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),E.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),E.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),E.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),E.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(E.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var i,n,s,r,a,o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,c=o.length,h=c-l,d=this.selectionStart,u=this.selectionEnd,f=d!==u;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var p=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),g=d>p.selectionStart;f?(i=this._text.slice(d,u),h+=u-d):c<l&&(i=g?this._text.slice(u+h,u):this._text.slice(d,d-h)),n=o.slice(p.selectionEnd-h,p.selectionEnd),i&&i.length&&(n.length&&(s=this.getSelectionStyles(d,d+1,!1),s=n.map((function(){return s[0]}))),f?(r=d,a=u):g?(r=u-i.length,a=u):(r=u,a=u+i.length),this.removeStyleFromTo(r,a)),n.length&&(e&&n.join("")===E.copiedText&&!E.disableStyleCopyPaste&&(s=E.copiedTextStyle),this.insertNewStyleBlock(n,d,s)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(E.copiedText=this.getSelectedText(),E.disableStyleCopyPaste?E.copiedTextStyle=null:E.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||E.window.clipboardData},_getWidthBeforeCursor:function(t,e){var i,n=this._getLineLeftOffset(t);return e>0&&(n+=(i=this.__charBounds[t][e-1]).left+i.width),n},getDownCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),s=n.lineIndex;if(s===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-i;var r=n.charIndex,a=this._getWidthBeforeCursor(s,r),o=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(r).length+o+1+this.missingNewlineOffset(s)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var i=this._getSelectionForOffset(t,e),n=this.get2DCursorLocation(i),s=n.lineIndex;if(0===s||t.metaKey||33===t.keyCode)return-i;var r=n.charIndex,a=this._getWidthBeforeCursor(s,r),o=this._getIndexOnLine(s-1,a),l=this._textLines[s].slice(0,r),c=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+o-l.length+(1-c)},_getIndexOnLine:function(t,e){for(var i,n,s=this._textLines[t],r=this._getLineLeftOffset(t),a=0,o=0,l=s.length;o<l;o++)if((r+=i=this.__charBounds[t][o].width)>e){n=!0;var c=r-i,h=r,d=Math.abs(c-e);a=Math.abs(h-e)<d?o:o-1;break}return n||(a=s.length-1),a},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var i=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(i):this.moveCursorWithoutShift(i),0!==i&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,i){var n;if(t.altKey)n=this["findWordBoundary"+i](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===i?-1:1,!0;n=this["findLineBoundary"+i](this[e])}if(void 0!==n&&this[e]!==n)return this[e]=n,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var i="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?i+="Shift":i+="outShift",this[i](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){void 0===e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,i,n){void 0===n&&(n=i),n>i&&this.removeStyleFromTo(i,n);var s=E.util.string.graphemeSplit(t);this.insertNewStyleBlock(s,i,e),this._text=[].concat(this._text.slice(0,i),s,this._text.slice(n)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),S=E.util.toFixed,T=/  +/g,E.util.object.extend(E.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var i,n=[],s=[],r=t;this._setSVGBg(s);for(var a=0,o=this._textLines.length;a<o;a++)i=this._getLineLeftOffset(a),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(s,a,e+i,r),this._setSVGTextLineText(n,a,e+i,r),r+=this.getHeightOfLine(a);return{textSpans:n,textBgRects:s}},_createTextCharSpan:function(t,e,i,n){var s=t!==t.trim()||t.match(T),r=this.getSvgSpanStyles(e,s),a=r?'style="'+r+'"':"",o=e.deltaY,l="",c=E.Object.NUM_FRACTION_DIGITS;return o&&(l=' dy="'+S(o,c)+'" '),['<tspan x="',S(i,c),'" y="',S(n,c),'" ',l,a,">",E.util.string.escapeXml(t),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,i,n){var s,r,a,o,l,c=this.getHeightOfLine(e),h=-1!==this.textAlign.indexOf("justify"),d="",u=0,f=this._textLines[e];n+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,g=f.length-1;p<=g;p++)l=p===g||this.charSpacing,d+=f[p],a=this.__charBounds[e][p],0===u?(i+=a.kernedWidth-a.width,u+=a.width):u+=a.kernedWidth,h&&!l&&this._reSpaceAndTab.test(f[p])&&(l=!0),l||(s=s||this.getCompleteStyleDeclaration(e,p),r=this.getCompleteStyleDeclaration(e,p+1),l=E.util.hasStyleChanged(s,r,!0)),l&&(o=this._getStyleDeclaration(e,p)||{},t.push(this._createTextCharSpan(d,o,i,n)),d="",s=r,i+=u,u=0)},_pushTextBgRect:function(t,e,i,n,s,r){var a=E.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(e),' x="',S(i,a),'" y="',S(n,a),'" width="',S(s,a),'" height="',S(r,a),'"></rect>\n')},_setSVGTextLineBg:function(t,e,i,n){for(var s,r,a=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,l=0,c=0,h=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),d=0,u=a.length;d<u;d++)s=this.__charBounds[e][d],(r=this.getValueOfPropertyAt(e,d,"textBackgroundColor"))!==h?(h&&this._pushTextBgRect(t,h,i+c,n,l,o),c=s.left,l=s.width,h=r):l+=s.kernedWidth;r&&this._pushTextBgRect(t,r,i+c,n,l,o)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new E.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,i=0,n=0;n<t;n++)i+=this.getHeightOfLine(n);return e=this.getHeightOfLine(n),{lineTop:i,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return E.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}}),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,i=0,n=0,s={},r=0;r<t.graphemeLines.length;r++)"\n"===t.graphemeText[n]&&r>0?(i=0,n++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[n])&&r>0&&(i++,n++),s[r]={line:e,offset:i},n+=t.graphemeLines[r].length,i+=t.graphemeLines[r].length;return s},styleHas:function(t,i){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[i];n&&(i=n.line)}return e.Text.prototype.styleHas.call(this,t,i)},isEmptyStyles:function(t){if(!this.styles)return!0;var e,i,n=0,s=!1,r=this._styleMap[t],a=this._styleMap[t+1];for(var o in r&&(t=r.line,n=r.offset),a&&(s=a.line===t,e=a.offset),i=void 0===t?this.styles:{line:this.styles[t]})for(var l in i[o])if(l>=n&&(!s||l<e))for(var c in i[o][l])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[t];if(!i)return null;t=i.line,e=i.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,i){var n=this._styleMap[t];t=n.line,e=n.offset+e,this.styles[t][e]=i},_deleteStyleDeclaration:function(t,e){var i=this._styleMap[t];t=i.line,e=i.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var i,n=[];for(this.isWrapping=!0,i=0;i<t.length;i++)n=n.concat(this._wrapLine(t[i],i,e));return this.isWrapping=!1,n},_measureWord:function(t,e,i){var n,s=0;i=i||0;for(var r=0,a=t.length;r<a;r++)s+=this._getGraphemeBox(t[r],e,r+i,n,!0).kernedWidth,n=t[r];return s},_wrapLine:function(t,i,n,s){var r=0,a=this.splitByGrapheme,o=[],l=[],c=a?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),h="",d=0,u=a?"":" ",f=0,p=0,g=0,m=!0,v=this._getWidthOfCharSpacing();s=s||0,0===c.length&&c.push([]),n-=s;for(var b=0;b<c.length;b++)h=a?c[b]:e.util.string.graphemeSplit(c[b]),f=this._measureWord(h,i,d),d+=h.length,(r+=p+f-v)>n&&!m?(o.push(l),l=[],r=f,m=!0):r+=v,m||a||l.push(u),l=l.concat(h),p=a?0:this._measureWord([u],i,d),d++,m=!1,f>g&&(g=f);return b&&o.push(l),g+s>this.dynamicMinWidth&&(this.dynamicMinWidth=g-v+s),o},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var i=e.Text.prototype._splitTextIntoLines.call(this,t),n=this._wrapText(i.lines,this.width),s=new Array(n.length),r=0;r<n.length;r++)s[r]=n[r].join("");return i.lines=s,i.graphemeLines=n,i},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,i){var n=e.util.stylesFromArray(t.styles,t.text),s=Object.assign({},t,{styles:n});return e.Object._fromObject("Textbox",s,i,"text")}}(e),function(){var t=E.controlsUtils,e=t.scaleSkewCursorStyleHandler,i=t.scaleCursorStyleHandler,n=t.scalingEqually,s=t.scalingYOrSkewingX,r=t.scalingXOrSkewingY,a=t.scaleOrSkewActionName,o=E.Object.prototype.controls;if(o.ml=new E.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:r,getActionName:a}),o.mr=new E.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:r,getActionName:a}),o.mb=new E.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:s,getActionName:a}),o.mt=new E.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:s,getActionName:a}),o.tl=new E.Control({x:-.5,y:-.5,cursorStyleHandler:i,actionHandler:n}),o.tr=new E.Control({x:.5,y:-.5,cursorStyleHandler:i,actionHandler:n}),o.bl=new E.Control({x:-.5,y:.5,cursorStyleHandler:i,actionHandler:n}),o.br=new E.Control({x:.5,y:.5,cursorStyleHandler:i,actionHandler:n}),o.mtr=new E.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),E.Textbox){var l=E.Textbox.prototype.controls={};l.mtr=o.mtr,l.tr=o.tr,l.br=o.br,l.tl=o.tl,l.bl=o.bl,l.mt=o.mt,l.mb=o.mb,l.mr=new E.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new E.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()},331:function(t){t.exports=function(){"use strict";var t=function(){},e=Object.prototype.hasOwnProperty,i=Array.prototype.slice;function n(t,n,s){for(var r,a,o=0,l=(s=i.call(arguments,2)).length;o<l;o++)for(r in a=s[o])t&&!e.call(a,r)||(n[r]=a[r])}var s=function(e,i,s,r){var a=this;return"string"!=typeof e&&(r=s,s=i,i=e,e=null),"function"!=typeof i&&(r=s,s=i,i=function(){return a.apply(this,arguments)}),n(!1,i,a,r),i.prototype=function(e,i){var s;return"function"==typeof Object.create?s=Object.create(e):(t.prototype=e,s=new t,t.prototype=null),i&&n(!0,s,i),s}(a.prototype,s),i.prototype.constructor=i,i.class_=e||a.class_,i.super_=a,i};function r(){}r.class_="Nevis",r.super_=Object,r.extend=s;var a=r,o=a.extend((function(t,e,i){this.qrious=t,this.element=e,this.element.qrious=t,this.enabled=Boolean(i)}),{draw:function(t){},getElement:function(){return this.enabled||(this.enabled=!0,this.render()),this.element},getModuleSize:function(t){var e=this.qrious,i=e.padding||0,n=Math.floor((e.size-2*i)/t.width);return Math.max(1,n)},getOffset:function(t){var e=this.qrious,i=e.padding;if(null!=i)return i;var n=this.getModuleSize(t),s=Math.floor((e.size-n*t.width)/2);return Math.max(0,s)},render:function(t){this.enabled&&(this.resize(),this.reset(),this.draw(t))},reset:function(){},resize:function(){}}),l=o.extend({draw:function(t){var e,i,n=this.qrious,s=this.getModuleSize(t),r=this.getOffset(t),a=this.element.getContext("2d");for(a.fillStyle=n.foreground,a.globalAlpha=n.foregroundAlpha,e=0;e<t.width;e++)for(i=0;i<t.width;i++)t.buffer[i*t.width+e]&&a.fillRect(s*e+r,s*i+r,s,s)},reset:function(){var t=this.qrious,e=this.element.getContext("2d"),i=t.size;e.lineWidth=1,e.clearRect(0,0,i,i),e.fillStyle=t.background,e.globalAlpha=t.backgroundAlpha,e.fillRect(0,0,i,i)},resize:function(){var t=this.element;t.width=t.height=this.qrious.size}}),c=a.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]}),h=a.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}}),d=a.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]}),u=a.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]}),f=a.extend((function(t){var e,i,n,s,r,a=t.value.length;for(this._badness=[],this._level=h.LEVELS[t.level],this._polynomial=[],this._value=t.value,this._version=0,this._stringBuffer=[];this._version<40&&(this._version++,n=4*(this._level-1)+16*(this._version-1),s=h.BLOCKS[n++],r=h.BLOCKS[n++],e=h.BLOCKS[n++],i=h.BLOCKS[n],!(a<=(n=e*(s+r)+r-3+(this._version<=9)))););this._dataBlock=e,this._eccBlock=i,this._neccBlock1=s,this._neccBlock2=r;var o=this.width=17+4*this._version;this.buffer=f._createArray(o*o),this._ecc=f._createArray(e+(e+i)*(s+r)+r),this._mask=f._createArray((o*(o+1)+1)/2),this._insertFinders(),this._insertAlignments(),this.buffer[8+o*(o-8)]=1,this._insertTimingGap(),this._reverseMask(),this._insertTimingRowAndColumn(),this._insertVersion(),this._syncMask(),this._convertBitStream(a),this._calculatePolynomial(),this._appendEccToData(),this._interleaveBlocks(),this._pack(),this._finish()}),{_addAlignment:function(t,e){var i,n=this.buffer,s=this.width;for(n[t+s*e]=1,i=-2;i<2;i++)n[t+i+s*(e-2)]=1,n[t-2+s*(e+i+1)]=1,n[t+2+s*(e+i)]=1,n[t+i+1+s*(e+2)]=1;for(i=0;i<2;i++)this._setMask(t-1,e+i),this._setMask(t+1,e-i),this._setMask(t-i,e-1),this._setMask(t+i,e+1)},_appendData:function(t,e,i,n){var s,r,a,o=this._polynomial,l=this._stringBuffer;for(r=0;r<n;r++)l[i+r]=0;for(r=0;r<e;r++){if(255!==(s=d.LOG[l[t+r]^l[i]]))for(a=1;a<n;a++)l[i+a-1]=l[i+a]^d.EXPONENT[f._modN(s+o[n-a])];else for(a=i;a<i+n;a++)l[a]=l[a+1];l[i+n-1]=255===s?0:d.EXPONENT[f._modN(s+o[0])]}},_appendEccToData:function(){var t,e=0,i=this._dataBlock,n=this._calculateMaxLength(),s=this._eccBlock;for(t=0;t<this._neccBlock1;t++)this._appendData(e,i,n,s),e+=i,n+=s;for(t=0;t<this._neccBlock2;t++)this._appendData(e,i+1,n,s),e+=i+1,n+=s},_applyMask:function(t){var e,i,n,s,r=this.buffer,a=this.width;switch(t){case 0:for(s=0;s<a;s++)for(n=0;n<a;n++)n+s&1||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 1:for(s=0;s<a;s++)for(n=0;n<a;n++)1&s||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 2:for(s=0;s<a;s++)for(e=0,n=0;n<a;n++,e++)3===e&&(e=0),e||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 3:for(i=0,s=0;s<a;s++,i++)for(3===i&&(i=0),e=i,n=0;n<a;n++,e++)3===e&&(e=0),e||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 4:for(s=0;s<a;s++)for(e=0,i=s>>1&1,n=0;n<a;n++,e++)3===e&&(e=0,i=!i),i||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 5:for(i=0,s=0;s<a;s++,i++)for(3===i&&(i=0),e=0,n=0;n<a;n++,e++)3===e&&(e=0),(n&s&1)+!(!e|!i)||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 6:for(i=0,s=0;s<a;s++,i++)for(3===i&&(i=0),e=0,n=0;n<a;n++,e++)3===e&&(e=0),(n&s&1)+(e&&e===i)&1||this._isMasked(n,s)||(r[n+s*a]^=1);break;case 7:for(i=0,s=0;s<a;s++,i++)for(3===i&&(i=0),e=0,n=0;n<a;n++,e++)3===e&&(e=0),(e&&e===i)+(n+s&1)&1||this._isMasked(n,s)||(r[n+s*a]^=1)}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var t,e,i=this._eccBlock,n=this._polynomial;for(n[0]=1,t=0;t<i;t++){for(n[t+1]=1,e=t;e>0;e--)n[e]=n[e]?n[e-1]^d.EXPONENT[f._modN(d.LOG[n[e]]+t)]:n[e-1];n[0]=d.EXPONENT[f._modN(d.LOG[n[0]]+t)]}for(t=0;t<=i;t++)n[t]=d.LOG[n[t]]},_checkBadness:function(){var t,e,i,n,s,r=0,a=this._badness,o=this.buffer,l=this.width;for(s=0;s<l-1;s++)for(n=0;n<l-1;n++)(o[n+l*s]&&o[n+1+l*s]&&o[n+l*(s+1)]&&o[n+1+l*(s+1)]||!(o[n+l*s]||o[n+1+l*s]||o[n+l*(s+1)]||o[n+1+l*(s+1)]))&&(r+=f.N2);var c=0;for(s=0;s<l;s++){for(i=0,a[0]=0,t=0,n=0;n<l;n++)t===(e=o[n+l*s])?a[i]++:a[++i]=1,c+=(t=e)?1:-1;r+=this._getBadness(i)}c<0&&(c=-c);var h=0,d=c;for(d+=d<<2,d<<=1;d>l*l;)d-=l*l,h++;for(r+=h*f.N4,n=0;n<l;n++){for(i=0,a[0]=0,t=0,s=0;s<l;s++)t===(e=o[n+l*s])?a[i]++:a[++i]=1,t=e;r+=this._getBadness(i)}return r},_convertBitStream:function(t){var e,i,n=this._ecc,s=this._version;for(i=0;i<t;i++)n[i]=this._value.charCodeAt(i);var r=this._stringBuffer=n.slice(),a=this._calculateMaxLength();t>=a-2&&(t=a-2,s>9&&t--);var o=t;if(s>9){for(r[o+2]=0,r[o+3]=0;o--;)e=r[o],r[o+3]|=255&e<<4,r[o+2]=e>>4;r[2]|=255&t<<4,r[1]=t>>4,r[0]=64|t>>12}else{for(r[o+1]=0,r[o+2]=0;o--;)e=r[o],r[o+2]|=255&e<<4,r[o+1]=e>>4;r[1]|=255&t<<4,r[0]=64|t>>4}for(o=t+3-(s<10);o<a;)r[o++]=236,r[o++]=17},_getBadness:function(t){var e,i=0,n=this._badness;for(e=0;e<=t;e++)n[e]>=5&&(i+=f.N1+n[e]-5);for(e=3;e<t-1;e+=2)n[e-2]===n[e+2]&&n[e+2]===n[e-1]&&n[e-1]===n[e+1]&&3*n[e-1]===n[e]&&(0===n[e-3]||e+3>t||3*n[e-3]>=4*n[e]||3*n[e+3]>=4*n[e])&&(i+=f.N3);return i},_finish:function(){var t,e;this._stringBuffer=this.buffer.slice();var i=0,n=3e4;for(e=0;e<8&&(this._applyMask(e),(t=this._checkBadness())<n&&(n=t,i=e),7!==i);e++)this.buffer=this._stringBuffer.slice();i!==e&&this._applyMask(i),n=h.FINAL_FORMAT[i+(this._level-1<<3)];var s=this.buffer,r=this.width;for(e=0;e<8;e++,n>>=1)1&n&&(s[r-1-e+8*r]=1,e<6?s[8+r*e]=1:s[8+r*(e+1)]=1);for(e=0;e<7;e++,n>>=1)1&n&&(s[8+r*(r-7+e)]=1,e?s[6-e+8*r]=1:s[7+8*r]=1)},_interleaveBlocks:function(){var t,e,i=this._dataBlock,n=this._ecc,s=this._eccBlock,r=0,a=this._calculateMaxLength(),o=this._neccBlock1,l=this._neccBlock2,c=this._stringBuffer;for(t=0;t<i;t++){for(e=0;e<o;e++)n[r++]=c[t+e*i];for(e=0;e<l;e++)n[r++]=c[o*i+t+e*(i+1)]}for(e=0;e<l;e++)n[r++]=c[o*i+t+e*(i+1)];for(t=0;t<s;t++)for(e=0;e<o+l;e++)n[r++]=c[a+t+e*s];this._stringBuffer=n},_insertAlignments:function(){var t,e,i,n=this._version,s=this.width;if(n>1)for(t=c.BLOCK[n],i=s-7;;){for(e=s-7;e>t-3&&(this._addAlignment(e,i),!(e<t));)e-=t;if(i<=t+9)break;i-=t,this._addAlignment(6,i),this._addAlignment(i,6)}},_insertFinders:function(){var t,e,i,n,s=this.buffer,r=this.width;for(t=0;t<3;t++){for(e=0,n=0,1===t&&(e=r-7),2===t&&(n=r-7),s[n+3+r*(e+3)]=1,i=0;i<6;i++)s[n+i+r*e]=1,s[n+r*(e+i+1)]=1,s[n+6+r*(e+i)]=1,s[n+i+1+r*(e+6)]=1;for(i=1;i<5;i++)this._setMask(n+i,e+1),this._setMask(n+1,e+i+1),this._setMask(n+5,e+i),this._setMask(n+i+1,e+5);for(i=2;i<4;i++)s[n+i+r*(e+2)]=1,s[n+2+r*(e+i+1)]=1,s[n+4+r*(e+i)]=1,s[n+i+1+r*(e+4)]=1}},_insertTimingGap:function(){var t,e,i=this.width;for(e=0;e<7;e++)this._setMask(7,e),this._setMask(i-8,e),this._setMask(7,e+i-7);for(t=0;t<8;t++)this._setMask(t,7),this._setMask(t+i-8,7),this._setMask(t,i-8)},_insertTimingRowAndColumn:function(){var t,e=this.buffer,i=this.width;for(t=0;t<i-14;t++)1&t?(this._setMask(8+t,6),this._setMask(6,8+t)):(e[8+t+6*i]=1,e[6+i*(8+t)]=1)},_insertVersion:function(){var t,e,i,n,s=this.buffer,r=this._version,a=this.width;if(r>6)for(t=u.BLOCK[r-7],e=17,i=0;i<6;i++)for(n=0;n<3;n++,e--)1&(e>11?r>>e-12:t>>e)?(s[5-i+a*(2-n+a-11)]=1,s[2-n+a-11+a*(5-i)]=1):(this._setMask(5-i,2-n+a-11),this._setMask(2-n+a-11,5-i))},_isMasked:function(t,e){var i=f._getMaskBit(t,e);return 1===this._mask[i]},_pack:function(){var t,e,i,n=1,s=1,r=this.width,a=r-1,o=r-1,l=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(e=0;e<l;e++)for(t=this._stringBuffer[e],i=0;i<8;i++,t<<=1){128&t&&(this.buffer[a+r*o]=1);do{s?a--:(a++,n?0!==o?o--:(n=!n,6==(a-=2)&&(a--,o=9)):o!==r-1?o++:(n=!n,6==(a-=2)&&(a--,o-=8))),s=!s}while(this._isMasked(a,o))}},_reverseMask:function(){var t,e,i=this.width;for(t=0;t<9;t++)this._setMask(t,8);for(t=0;t<8;t++)this._setMask(t+i-8,8),this._setMask(8,t);for(e=0;e<7;e++)this._setMask(8,e+i-7)},_setMask:function(t,e){var i=f._getMaskBit(t,e);this._mask[i]=1},_syncMask:function(){var t,e,i=this.width;for(e=0;e<i;e++)for(t=0;t<=e;t++)this.buffer[t+i*e]&&this._setMask(t,e)}},{_createArray:function(t){var e,i=[];for(e=0;e<t;e++)i[e]=0;return i},_getMaskBit:function(t,e){var i;return t>e&&(i=t,t=e,e=i),i=e,i+=e*e,(i>>=1)+t},_modN:function(t){for(;t>=255;)t=((t-=255)>>8)+(255&t);return t},N1:3,N2:3,N3:40,N4:10}),p=f,g=o.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var t=this.element;t.width=t.height=this.qrious.size}}),m=a.extend((function(t,e,i,n){this.name=t,this.modifiable=Boolean(e),this.defaultValue=i,this._valueTransformer=n}),{transform:function(t){var e=this._valueTransformer;return"function"==typeof e?e(t,this):t}}),v=a.extend(null,{abs:function(t){return null!=t?Math.abs(t):null},hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},noop:function(){},toUpperCase:function(t){return null!=t?t.toUpperCase():null}}),b=a.extend((function(t){this.options={},t.forEach((function(t){this.options[t.name]=t}),this)}),{exists:function(t){return null!=this.options[t]},get:function(t,e){return b._get(this.options[t],e)},getAll:function(t){var e,i=this.options,n={};for(e in i)v.hasOwn(i,e)&&(n[e]=b._get(i[e],t));return n},init:function(t,e,i){var n,s;for(n in"function"!=typeof i&&(i=v.noop),this.options)v.hasOwn(this.options,n)&&(s=this.options[n],b._set(s,s.defaultValue,e),b._createAccessor(s,e,i));this._setAll(t,e,!0)},set:function(t,e,i){return this._set(t,e,i)},setAll:function(t,e){return this._setAll(t,e)},_set:function(t,e,i,n){var s=this.options[t];if(!s)throw new Error("Invalid option: "+t);if(!s.modifiable&&!n)throw new Error("Option cannot be modified: "+t);return b._set(s,e,i)},_setAll:function(t,e,i){if(!t)return!1;var n,s=!1;for(n in t)v.hasOwn(t,n)&&this._set(n,t[n],e,i)&&(s=!0);return s}},{_createAccessor:function(t,e,i){var n={get:function(){return b._get(t,e)}};t.modifiable&&(n.set=function(n){b._set(t,n,e)&&i(n,t)}),Object.defineProperty(e,t.name,n)},_get:function(t,e){return e["_"+t.name]},_set:function(t,e,i){var n="_"+t.name,s=i[n],r=t.transform(null!=e?e:t.defaultValue);return i[n]=r,r!==s}}),y=b,x=a.extend((function(){this._services={}}),{getService:function(t){var e=this._services[t];if(!e)throw new Error("Service is not being managed with name: "+t);return e},setService:function(t,e){if(this._services[t])throw new Error("Service is already managed with name: "+t);e&&(this._services[t]=e)}}),w=new y([new m("background",!0,"white"),new m("backgroundAlpha",!0,1,v.abs),new m("element"),new m("foreground",!0,"black"),new m("foregroundAlpha",!0,1,v.abs),new m("level",!0,"L",v.toUpperCase),new m("mime",!0,"image/png"),new m("padding",!0,null,v.abs),new m("size",!0,100,v.abs),new m("value",!0,"")]),C=new x,S=a.extend((function(t){w.init(t,this,this.update.bind(this));var e=w.get("element",this),i=C.getService("element"),n=e&&i.isCanvas(e)?e:i.createCanvas(),s=e&&i.isImage(e)?e:i.createImage();this._canvasRenderer=new l(this,n,!0),this._imageRenderer=new g(this,s,s===e),this.update()}),{get:function(){return w.getAll(this)},set:function(t){w.setAll(t,this)&&this.update()},toDataURL:function(t){return this.canvas.toDataURL(t||this.mime)},update:function(){var t=new p({level:this.level,value:this.value});this._canvasRenderer.render(t),this._imageRenderer.render(t)}},{use:function(t){C.setService(t.getName(),t)}});Object.defineProperties(S.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var T=S,E=a.extend({getName:function(){}}).extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(t){},isImage:function(t){}}).extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(t){return t instanceof HTMLCanvasElement},isImage:function(t){return t instanceof HTMLImageElement}});return T.use(new E),T}()},933:(t,e,i)=>{var n;!function(){function s(t,e,i){return t.call.apply(t.bind,arguments)}function r(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function a(t,e,i){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:r).apply(null,arguments)}var o=Date.now||function(){return+new Date};function l(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var c=!!window.FontFace;function h(t,e,i,n){if(e=t.c.createElement(e),i)for(var s in i)i.hasOwnProperty(s)&&("style"==s?e.style.cssText=i[s]:e.setAttribute(s,i[s]));return n&&e.appendChild(t.c.createTextNode(n)),e}function d(t,e,i){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(i,t.lastChild)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),s=0;s<e.length;s+=1){for(var r=!1,a=0;a<n.length;a+=1)if(e[s]===n[a]){r=!0;break}r||n.push(e[s])}for(e=[],s=0;s<n.length;s+=1){for(r=!1,a=0;a<i.length;a+=1)if(n[s]===i[a]){r=!0;break}r||e.push(n[s])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function p(t,e){for(var i=t.className.split(/\s+/),n=0,s=i.length;n<s;n++)if(i[n]==e)return!0;return!1}function g(t,e,i){function n(){o&&s&&r&&(o(a),o=null)}e=h(t,"link",{rel:"stylesheet",href:e,media:"all"});var s=!1,r=!0,a=null,o=i||null;c?(e.onload=function(){s=!0,n()},e.onerror=function(){s=!0,a=Error("Stylesheet failed to load"),n()}):setTimeout((function(){s=!0,n()}),0),d(t,"head",e)}function m(t,e,i,n){var s=t.c.getElementsByTagName("head")[0];if(s){var r=h(t,"script",{src:e}),a=!1;return r.onload=r.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,i&&i(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&s.removeChild(r))},s.appendChild(r),setTimeout((function(){a||(a=!0,i&&i(Error("Script load timeout")))}),n||5e3),r}return null}function v(){this.a=0,this.c=null}function b(t){return t.a++,function(){t.a--,x(t)}}function y(t,e){t.c=e,x(t)}function x(t){0==t.a&&t.c&&(t.c(),t.c=null)}function w(t){this.a=t||"-"}function C(t,e){this.c=t,this.f=4,this.a="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function S(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var n=t[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?e.push("'"+n+"'"):e.push(n)}return e.join(",")}function T(t){return t.a+t.f}function E(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function A(t){var e=4,i="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),i+e}function I(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new w("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function O(t){if(t.g){var e=p(t.f,t.a.c("wf","active")),i=[],n=[t.a.c("wf","loading")];e||i.push(t.a.c("wf","inactive")),f(t.f,i,n)}k(t,"inactive")}function k(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,T(i)):t.h[e]())}function M(){this.c={}}function P(t,e){this.c=t,this.f=e,this.a=h(this.c,"span",{"aria-hidden":"true"},this.f)}function _(t){d(t.c,"body",t.a)}function D(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+S(t.c)+";font-style:"+E(t)+";font-weight:"+t.f+"00;"}function L(t,e,i,n,s,r){this.g=t,this.j=e,this.a=n,this.c=i,this.f=s||3e3,this.h=r||void 0}function B(t,e,i,n,s,r,a){this.v=t,this.B=e,this.c=i,this.a=n,this.s=a||"BESbswy",this.f={},this.w=s||3e3,this.u=r||null,this.m=this.j=this.h=this.g=null,this.g=new P(this.c,this.s),this.h=new P(this.c,this.s),this.j=new P(this.c,this.s),this.m=new P(this.c,this.s),t=D(t=new C(this.a.c+",serif",T(this.a))),this.g.a.style.cssText=t,t=D(t=new C(this.a.c+",sans-serif",T(this.a))),this.h.a.style.cssText=t,t=D(t=new C("serif",T(this.a))),this.j.a.style.cssText=t,t=D(t=new C("sans-serif",T(this.a))),this.m.a.style.cssText=t,_(this.g),_(this.h),_(this.j),_(this.m)}w.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},L.prototype.start=function(){var t=this.c.o.document,e=this,i=o(),n=new Promise((function(n,s){!function r(){o()-i>=e.f?s():t.fonts.load(function(t){return E(t)+" "+t.f+"00 300px "+S(t.c)}(e.a),e.h).then((function(t){1<=t.length?n():setTimeout(r,25)}),(function(){s()}))}()})),s=null,r=new Promise((function(t,i){s=setTimeout(i,e.f)}));Promise.race([r,n]).then((function(){s&&(clearTimeout(s),s=null),e.g(e.a)}),(function(){e.j(e.a)}))};var j={D:"serif",C:"sans-serif"},F=null;function R(){if(null===F){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);F=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return F}function N(t,e,i){for(var n in j)if(j.hasOwnProperty(n)&&e===t.f[j[n]]&&i===t.f[j[n]])return!0;return!1}function H(t){var e,i=t.g.a.offsetWidth,n=t.h.a.offsetWidth;(e=i===t.f.serif&&n===t.f["sans-serif"])||(e=R()&&N(t,i,n)),e?o()-t.A>=t.w?R()&&N(t,i,n)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?z(t,t.v):z(t,t.B):function(t){setTimeout(a((function(){H(this)}),t),50)}(t):z(t,t.v)}function z(t,e){setTimeout(a((function(){u(this.g.a),u(this.h.a),u(this.j.a),u(this.m.a),e(this.a)}),t),0)}function W(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}B.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=o(),H(this)};var V=null;function U(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&f(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),k(t,"active")):O(t.a))}function Y(t){this.j=t,this.a=new M,this.h=0,this.f=this.g=!0}function G(t,e,i,n,s){var r=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=s||null,o=n||{};if(0===i.length&&r)O(e.a);else{e.f+=i.length,r&&(e.j=r);var l,c=[];for(l=0;l<i.length;l++){var h=i[l],d=o[h.c],u=e.a,p=h;if(u.g&&f(u.f,[u.a.c("wf",p.c,T(p).toString(),"loading")]),k(u,"fontloading",p),u=null,null===V)if(window.FontFace){p=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);V=p?42<parseInt(p[1],10):!g}else V=!1;u=V?new L(a(e.g,e),a(e.h,e),e.c,h,e.s,d):new B(a(e.g,e),a(e.h,e),e.c,h,e.s,t,d),c.push(u)}for(l=0;l<c.length;l++)c[l].start()}}),0)}function q(t,e){this.c=t,this.a=e}function X(t,e){this.c=t,this.a=e}function Z(t,e){this.c=t||J,this.a=[],this.f=[],this.g=e||""}W.prototype.g=function(t){var e=this.a;e.g&&f(e.f,[e.a.c("wf",t.c,T(t).toString(),"active")],[e.a.c("wf",t.c,T(t).toString(),"loading"),e.a.c("wf",t.c,T(t).toString(),"inactive")]),k(e,"fontactive",t),this.m=!0,U(this)},W.prototype.h=function(t){var e=this.a;if(e.g){var i=p(e.f,e.a.c("wf",t.c,T(t).toString(),"active")),n=[],s=[e.a.c("wf",t.c,T(t).toString(),"loading")];i||n.push(e.a.c("wf",t.c,T(t).toString(),"inactive")),f(e.f,n,s)}k(e,"fontinactive",t),U(this)},Y.prototype.load=function(t){this.c=new l(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,i){var n=[],s=i.timeout;!function(t){t.g&&f(t.f,[t.a.c("wf","loading")]),k(t,"loading")}(e),n=function(t,e,i){var n,s=[];for(n in e)if(e.hasOwnProperty(n)){var r=t.c[n];r&&s.push(r(e[n],i))}return s}(t.a,i,t.c);var r=new W(t.c,e,s);for(t.h=n.length,e=0,i=n.length;e<i;e++)n[e].load((function(e,i,n){G(t,r,e,i,n)}))}(this,new I(this.c,t),t)},q.prototype.load=function(t){function e(){if(r["__mti_fntLst"+n]){var i,s=r["__mti_fntLst"+n](),a=[];if(s)for(var o=0;o<s.length;o++){var l=s[o].fontfamily;null!=s[o].fontStyle&&null!=s[o].fontWeight?(i=s[o].fontStyle+s[o].fontWeight,a.push(new C(l,i))):a.push(new C(l))}t(a)}else setTimeout((function(){e()}),50)}var i=this,n=i.a.projectId,s=i.a.version;if(n){var r=i.c.o;m(this.c,(i.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(s?"?v="+s:""),(function(s){s?t([]):(r["__MonotypeConfiguration__"+n]=function(){return i.a},e())})).id="__MonotypeAPIScript__"+n}else t([])},X.prototype.load=function(t){var e,i,n=this.a.urls||[],s=this.a.families||[],r=this.a.testStrings||{},a=new v;for(e=0,i=n.length;e<i;e++)g(this.c,n[e],b(a));var o=[];for(e=0,i=s.length;e<i;e++)if((n=s[e].split(":"))[1])for(var l=n[1].split(","),c=0;c<l.length;c+=1)o.push(new C(n[0],l[c]));else o.push(new C(n[0]));y(a,(function(){t(o,r)}))};var J="https://fonts.googleapis.com/css";function Q(t){this.f=t,this.a=[],this.c={}}var K={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},$={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},tt={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function it(t,e){this.c=t,this.a=e}var nt={Arimo:!0,Cousine:!0,Tinos:!0};function st(t,e){this.c=t,this.a=e}function rt(t,e){this.c=t,this.f=e,this.a=[]}it.prototype.load=function(t){var e=new v,i=this.c,n=new Z(this.a.api,this.a.text),s=this.a.families;!function(t,e){for(var i=e.length,n=0;n<i;n++){var s=e[n].split(":");3==s.length&&t.f.push(s.pop());var r="";2==s.length&&""!=s[1]&&(r=":"),t.a.push(s.join(r))}}(n,s);var r=new Q(s);!function(t){for(var e=t.f.length,i=0;i<e;i++){var n=t.f[i].split(":"),s=n[0].replace(/\+/g," "),r=["n4"];if(2<=n.length){var a;if(a=[],o=n[1])for(var o,l=(o=o.split(",")).length,c=0;c<l;c++){var h;if((h=o[c]).match(/^[\w-]+$/))if(null==(d=et.exec(h.toLowerCase())))h="";else{if(h=null==(h=d[2])||""==h?"n":tt[h],null==(d=d[1])||""==d)d="4";else var d=$[d]||(isNaN(d)?"4":d.substr(0,1));h=[h,d].join("")}else h="";h&&a.push(h)}0<a.length&&(r=a),3==n.length&&(a=[],0<(n=(n=n[2])?n.split(","):a).length&&(n=K[n[0]])&&(t.c[s]=n))}for(t.c[s]||(n=K[s])&&(t.c[s]=n),n=0;n<r.length;n+=1)t.a.push(new C(s,r[n]))}}(r),g(i,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],n=0;n<e;n++)i.push(t.a[n].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(n),b(e)),y(e,(function(){t(r.a,r.c,nt)}))},st.prototype.load=function(t){var e=this.a.id,i=this.c.o;e?m(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){e=i.Typekit.config.fn;for(var n=[],s=0;s<e.length;s+=2)for(var r=e[s],a=e[s+1],o=0;o<a.length;o++)n.push(new C(r,a[o]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(n)}}),2e3):t([])},rt.prototype.load=function(t){var e=this.f.id,i=this.c.o,n=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(e,i){for(var s=0,r=i.fonts.length;s<r;++s){var a=i.fonts[s];n.a.push(new C(a.name,A("font-weight:"+a.weight+";font-style:"+a.style)))}t(n.a)},m(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var at=new Y(window);at.a.c.custom=function(t,e){return new X(e,t)},at.a.c.fontdeck=function(t,e){return new rt(e,t)},at.a.c.monotype=function(t,e){return new q(e,t)},at.a.c.typekit=function(t,e){return new st(e,t)},at.a.c.google=function(t,e){return new it(e,t)};var ot={load:a(at.load,at)};void 0===(n=function(){return ot}.call(e,i,e,t))||(t.exports=n)}()},960:()=>{},759:()=>{},272:()=>{}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body;n===document.body&&n.classList.add("fpd-overflow-hidden"),"prompt"===i?t=`\n            <input type="text" placeholder="${t}" />\n            <span class="fpd-btn"></span>\n        `:"confirm"===i&&(t=`\n            <div class="fpd-confirm-msg">${t}</div>\n            <span class="fpd-btn fpd-confirm"></span>\n        `);let s=`\n        <div class="fpd-modal-inner fpd-shadow-3">\n            <div class="fpd-modal-close">\n                <span class="fpd-icon-close"></span>\n            </div>\n            <div class="fpd-modal-content">${t}</div>\n        </div>\n    `;const r=document.createElement("div");return r.className="fpd-modal-internal fpd-modal-overlay fpd-container "+(e?"fpd-fullscreen":""),r.innerHTML=s,r.dataset.type=i,n.append(r),G(r.querySelector(".fpd-modal-close"),["click"],(t=>{n.classList.remove("fpd-overflow-hidden"),r.remove()})),r},e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=document.body.querySelector(".fpd-snackbar-wrapper");i||(i=document.createElement("div"),i.className="fpd-snackbar-wrapper",document.body.append(i));let n=document.createElement("div");return n.className="fpd-snackbar fpd-shadow-1",n.innerHTML="<p>"+t+"</p>",n.addEventListener("click",(t=>{n.remove(),n=null})),i.append(n),e&&setTimeout((()=>{n&&(n.remove(),n=null)}),5e3),n},n=e;function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}window.FPDSnackbar=e;var r=/^\s+/,a=/\s+$/;function o(t,e){if(e=e||{},(t=t||"")instanceof o)return t;if(!(this instanceof o))return new o(t,e);var i=function(t){var e,i,n,o={r:0,g:0,b:0},l=1,c=null,h=null,d=null,u=!1,f=!1;return"string"==typeof t&&(t=function(t){t=t.replace(r,"").replace(a,"").toLowerCase();var e,i=!1;if(T[t])t=T[t],i=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=F.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=F.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=F.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=F.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=F.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=F.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=F.hex8.exec(t))?{r:k(e[1]),g:k(e[2]),b:k(e[3]),a:D(e[4]),format:i?"name":"hex8"}:(e=F.hex6.exec(t))?{r:k(e[1]),g:k(e[2]),b:k(e[3]),format:i?"name":"hex"}:(e=F.hex4.exec(t))?{r:k(e[1]+""+e[1]),g:k(e[2]+""+e[2]),b:k(e[3]+""+e[3]),a:D(e[4]+""+e[4]),format:i?"name":"hex8"}:!!(e=F.hex3.exec(t))&&{r:k(e[1]+""+e[1]),g:k(e[2]+""+e[2]),b:k(e[3]+""+e[3]),format:i?"name":"hex"}}(t)),"object"==s(t)&&(R(t.r)&&R(t.g)&&R(t.b)?(e=t.r,i=t.g,n=t.b,o={r:255*I(e,255),g:255*I(i,255),b:255*I(n,255)},u=!0,f="%"===String(t.r).substr(-1)?"prgb":"rgb"):R(t.h)&&R(t.s)&&R(t.v)?(c=P(t.s),h=P(t.v),o=function(t,e,i){t=6*I(t,360),e=I(e,100),i=I(i,100);var n=Math.floor(t),s=t-n,r=i*(1-e),a=i*(1-s*e),o=i*(1-(1-s)*e),l=n%6;return{r:255*[i,a,r,r,o,i][l],g:255*[o,i,i,a,r,r][l],b:255*[r,r,o,i,i,a][l]}}(t.h,c,h),u=!0,f="hsv"):R(t.h)&&R(t.s)&&R(t.l)&&(c=P(t.s),d=P(t.l),o=function(t,e,i){var n,s,r;function a(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}if(t=I(t,360),e=I(e,100),i=I(i,100),0===e)n=s=r=i;else{var o=i<.5?i*(1+e):i+e-i*e,l=2*i-o;n=a(l,o,t+1/3),s=a(l,o,t),r=a(l,o,t-1/3)}return{r:255*n,g:255*s,b:255*r}}(t.h,c,d),u=!0,f="hsl"),t.hasOwnProperty("a")&&(l=t.a)),l=A(l),{ok:u,format:t.format||f,r:Math.min(255,Math.max(o.r,0)),g:Math.min(255,Math.max(o.g,0)),b:Math.min(255,Math.max(o.b,0)),a:l}}(t);this._originalInput=t,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||i.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=i.ok}function l(t,e,i){t=I(t,255),e=I(e,255),i=I(i,255);var n,s,r=Math.max(t,e,i),a=Math.min(t,e,i),o=(r+a)/2;if(r==a)n=s=0;else{var l=r-a;switch(s=o>.5?l/(2-r-a):l/(r+a),r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s,l:o}}function c(t,e,i){t=I(t,255),e=I(e,255),i=I(i,255);var n,s,r=Math.max(t,e,i),a=Math.min(t,e,i),o=r,l=r-a;if(s=0===r?0:l/r,r==a)n=0;else{switch(r){case t:n=(e-i)/l+(e<i?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s,v:o}}function h(t,e,i,n){var s=[M(Math.round(t).toString(16)),M(Math.round(e).toString(16)),M(Math.round(i).toString(16))];return n&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function d(t,e,i,n){return[M(_(n)),M(Math.round(t).toString(16)),M(Math.round(e).toString(16)),M(Math.round(i).toString(16))].join("")}function u(t,e){e=0===e?0:e||10;var i=o(t).toHsl();return i.s-=e/100,i.s=O(i.s),o(i)}function f(t,e){e=0===e?0:e||10;var i=o(t).toHsl();return i.s+=e/100,i.s=O(i.s),o(i)}function p(t){return o(t).desaturate(100)}function g(t,e){e=0===e?0:e||10;var i=o(t).toHsl();return i.l+=e/100,i.l=O(i.l),o(i)}function m(t,e){e=0===e?0:e||10;var i=o(t).toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(-e/100*255))),i.g=Math.max(0,Math.min(255,i.g-Math.round(-e/100*255))),i.b=Math.max(0,Math.min(255,i.b-Math.round(-e/100*255))),o(i)}function v(t,e){e=0===e?0:e||10;var i=o(t).toHsl();return i.l-=e/100,i.l=O(i.l),o(i)}function b(t,e){var i=o(t).toHsl(),n=(i.h+e)%360;return i.h=n<0?360+n:n,o(i)}function y(t){var e=o(t).toHsl();return e.h=(e.h+180)%360,o(e)}function x(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var i=o(t).toHsl(),n=[o(t)],s=360/e,r=1;r<e;r++)n.push(o({h:(i.h+r*s)%360,s:i.s,l:i.l}));return n}function w(t){var e=o(t).toHsl(),i=e.h;return[o(t),o({h:(i+72)%360,s:e.s,l:e.l}),o({h:(i+216)%360,s:e.s,l:e.l})]}function C(t,e,i){e=e||6,i=i||30;var n=o(t).toHsl(),s=360/i,r=[o(t)];for(n.h=(n.h-(s*e>>1)+720)%360;--e;)n.h=(n.h+s)%360,r.push(o(n));return r}function S(t,e){e=e||6;for(var i=o(t).toHsv(),n=i.h,s=i.s,r=i.v,a=[],l=1/e;e--;)a.push(o({h:n,s,v:r})),r=(r+l)%1;return a}o.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,i,n=this.toRgb();return t=n.r/255,e=n.g/255,i=n.b/255,.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},setAlpha:function(t){return this._a=A(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=c(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=c(this._r,this._g,this._b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+n+"%)":"hsva("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=l(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=l(this._r,this._g,this._b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.l);return 1==this._a?"hsl("+e+", "+i+"%, "+n+"%)":"hsla("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(t){return h(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,i,n,s){var r=[M(Math.round(t).toString(16)),M(Math.round(e).toString(16)),M(Math.round(i).toString(16)),M(_(n))];return s&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)&&r[3].charAt(0)==r[3].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0)+r[3].charAt(0):r.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*I(this._r,255))+"%",g:Math.round(100*I(this._g,255))+"%",b:Math.round(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*I(this._r,255))+"%, "+Math.round(100*I(this._g,255))+"%, "+Math.round(100*I(this._b,255))+"%)":"rgba("+Math.round(100*I(this._r,255))+"%, "+Math.round(100*I(this._g,255))+"%, "+Math.round(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(E[h(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+d(this._r,this._g,this._b,this._a),i=e,n=this._gradientType?"GradientType = 1, ":"";if(t){var s=o(t);i="#"+d(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,n=this._a<1&&this._a>=0;return e||!n||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex4"===t&&(i=this.toHex8String(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return o(this.toString())},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(g,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(v,arguments)},desaturate:function(){return this._applyModification(u,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(y,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(w,arguments)},triad:function(){return this._applyCombination(x,[3])},tetrad:function(){return this._applyCombination(x,[4])}},o.fromRatio=function(t,e){if("object"==s(t)){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]="a"===n?t[n]:P(t[n]));t=i}return o(t,e)},o.equals=function(t,e){return!(!t||!e)&&o(t).toRgbString()==o(e).toRgbString()},o.random=function(){return o.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},o.mix=function(t,e,i){i=0===i?0:i||50;var n=o(t).toRgb(),s=o(e).toRgb(),r=i/100;return o({r:(s.r-n.r)*r+n.r,g:(s.g-n.g)*r+n.g,b:(s.b-n.b)*r+n.b,a:(s.a-n.a)*r+n.a})},o.readability=function(t,e){var i=o(t),n=o(e);return(Math.max(i.getLuminance(),n.getLuminance())+.05)/(Math.min(i.getLuminance(),n.getLuminance())+.05)},o.isReadable=function(t,e,i){var n,s,r,a,l,c=o.readability(t,e);switch(s=!1,(r=i,"AA"!==(a=((r=r||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==a&&(a="AA"),"small"!==(l=(r.size||"small").toLowerCase())&&"large"!==l&&(l="small"),n={level:a,size:l}).level+n.size){case"AAsmall":case"AAAlarge":s=c>=4.5;break;case"AAlarge":s=c>=3;break;case"AAAsmall":s=c>=7}return s},o.mostReadable=function(t,e,i){var n,s,r,a,l=null,c=0;s=(i=i||{}).includeFallbackColors,r=i.level,a=i.size;for(var h=0;h<e.length;h++)(n=o.readability(t,e[h]))>c&&(c=n,l=o(e[h]));return o.isReadable(t,l,{level:r,size:a})||!s?l:(i.includeFallbackColors=!1,o.mostReadable(t,["#fff","#000"],i))};var T=o.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E=o.hexNames=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}(T);function A(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function I(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var i=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=Math.min(e,Math.max(0,parseFloat(t))),i&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function O(t){return Math.min(1,Math.max(0,t))}function k(t){return parseInt(t,16)}function M(t){return 1==t.length?"0"+t:""+t}function P(t){return t<=1&&(t=100*t+"%"),t}function _(t){return Math.round(255*parseFloat(t)).toString(16)}function D(t){return k(t)/255}var L,B,j,F=(B="[\\s|\\(]+("+(L="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",j="[\\s|\\(]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")[,|\\s]+("+L+")\\s*\\)?",{CSS_UNIT:new RegExp(L),rgb:new RegExp("rgb"+B),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+B),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+B),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function R(t){return!!F.CSS_UNIT.exec(t)}const N=t=>"[object Object]"===Object.prototype.toString.call(t),H=(t,e)=>{if(t&&"object"==typeof t){let s=!0;for(var i=0;i<e.length;++i){var n=e[i];if(!t.hasOwnProperty(n)){s=!1;break}}return s}return!1},z=(t,e)=>{const i={...t,...e};if(Object.keys(e).length)for(const n of Object.keys(i))N(i[n])&&t[n]&&e[n]&&(i[n]=z(t[n],e[n]));return i},W=(t,e,i)=>{if(!e)return;const n=(Array.isArray(e)?e:e.match(/([^[.\]])+/g)).reduce(((t,e)=>t&&t[e]),t);return void 0===n?i:n},V=t=>/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t),U=t=>{for(var e=t.concat(),i=0;i<e.length;++i)for(var n=i+1;n<e.length;++n)e[i]===e[n]&&e.splice(n--,1);return e},Y=t=>0===t||"string"==typeof t&&"0"===t,G=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e="string"==typeof e?[e]:e;const s=new AbortController,{signal:r}=s;e.forEach((e=>{t instanceof HTMLElement||t instanceof window.constructor?(t.addEventListener(e,i,{capture:n,signal:r}),t.abortController=s):Array.from(t).length?t&&t.forEach&&t.forEach((t=>{t.addEventListener(e,i,{capture:n,signal:r}),t.abortController=s})):(t.addEventListener(e,i,{capture:n,signal:r}),t.abortController=s)}))},q=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};window&&t.dispatchEvent(new CustomEvent(e,{detail:i})),window.jQuery&&t.container&&jQuery(t.container).trigger(e,Object.values(i))},X=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t&&(t instanceof HTMLElement?e.forEach((e=>{t.classList.add(e)})):t.forEach((t=>{e.forEach((e=>{t.classList.add(e)}))}))),t},Z=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t&&(t instanceof HTMLElement?e.forEach((e=>{t.classList.remove(e)})):t.forEach((t=>{e.forEach((e=>{t.classList.remove(e)}))}))),t},J=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t&&(t instanceof HTMLElement?e.forEach((e=>{t.classList.toggle(e,i)})):t.forEach((t=>{e.forEach((e=>{t.classList.toggle(e,i)}))}))),t},Q=t=>void 0===t||null==t||("string"==typeof t?!t.trim().length:Array.isArray(t)?!t.length:"object"==typeof t&&!Object.keys(t).length),K=()=>{var t=!0;try{window.localStorage.length,window.localStorage.setItem(fpdInstance.mainOptions.uploadsStorageKey+"_test","just-testing")}catch(e){t=!1}return t},$=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.url)return;const e=document.createElement("div");e.className="fpd-item fpd-hover-thumbnail",e.dataset.source=t.url,t.disableDraggable||e.classList.add("fpd-draggable"),t.title&&(e.dataset.title=t.title,e.setAttribute("aria-label",t.title));const i=document.createElement("picture");i.dataset.img=t.thumbnailUrl?t.thumbnailUrl:t.url,e.append(i);const n=new Image;if(n.onerror=()=>{e.remove()},n.src=i.dataset.img,!t.disablePrice){const i=document.createElement("span");i.className="fpd-price",i.innerHTML=t.price,e.append(i),J(i,["fpd-hidden"],!Boolean(t.price))}if(t.removable){const t=document.createElement("span");t.className="fpd-delete fpd-icon-remove",e.append(t)}return e},tt=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t.currentViewInstance)return"";let n=t.currentViewInstance.options;if(document.querySelector(".fpd-upload-zone-content").contains(e)&&t.currentViewInstance.currentUploadZone){const e=t.currentViewInstance.fabricCanvas.getUploadZone(t.currentViewInstance.currentUploadZone);e&&e.price&&(i=e.price)}return null==i&&(i=W(n,"customImageParameters.price",0)),i?ht(i,t.mainOptions.priceFormat):""},et=(e,i,n)=>{const s=e.currentViewInstance;let r=s.options.customImageParameters;const a=s.fabricCanvas.getUploadZone(s.currentUploadZone);if(a&&(r=z(r,a)),i>r.maxW||i<r.minW||n>r.maxH||n<r.minH){e.loadingCustomImage=!1,e.mainBar&&(e.mainBar.toggleContentDisplay(!1),s.currentUploadZone&&e.mainBar.toggleUploadZonePanel(!1));let i=e.translator.getTranslation("misc","uploaded_image_size_alert");return i=i.replace("%minW",r.minW).replace("%minH",r.minH).replace("%maxW",r.maxW).replace("%maxH",r.maxH),t(i),!1}return!0},it=t=>t.split(".").pop().toLowerCase().split("?")[0],nt=t=>t.split("/").pop(),st=t=>["jpeg","jpg","png"].includes(it(t)),rt=(t,e)=>{var i=[];if("group"==t.type){const e=t.getObjects();1===e.length?i=!0===t.colors||1===t.colors?["#000"]:t.colors:(i=[],e.forEach((t=>{const e=o(t.fill);i.push(e.toHexString())})))}else{if(t.__editorMode)return["#000"];i=t.colorLinkGroup&&e.colorLinkGroups[t.colorLinkGroup]?e.colorLinkGroups[t.colorLinkGroup].colors:!0===t.colors||1===t.colors?["#000"]:t.colors}return i},at=t=>{let e=t.fill;return"string"==typeof e?e:"object"==typeof e?e.source?(e=e.source.src,"url("+e+")"):e[0]:!0===t.colors&&"group"===t.type?o(t.getObjects()[0].fill):!1===e&&t.colors&&t.colors[0]?t.colors[0]:void 0},ot=(t,e)=>{null!=t&&void 0!==t||n(e)},lt=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inch";const i=t*(arguments.length>2&&void 0!==arguments[2]?arguments[2]:72);return"cm"==e?Math.round(i/2.54):"mm"==e?Math.round(i/25.4):Math.round(i)},ct=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inch";const i=t/(arguments.length>2&&void 0!==arguments[2]?arguments[2]:72);return"cm"==e?Math.round(2.54*i):"mm"==e?Math.round(25.4*i):Math.round(i)},ht=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!isNaN(t)&&"object"==typeof e){const n=e.thousandSep||",",s=e.decimalSep||".";let r=t.toString().split("."),a=r[0],o=r[1],l="";if(void 0!==a){for(var i=a.length-1;i>=0;i--)l+=a.charAt(i);for(l=l.replace(/(\d{3})/g,"$1"+n),l.slice(-n.length)==n&&(l=l.slice(0,-n.length)),a="",i=l.length-1;i>=0;i--)a+=l.charAt(i);void 0!==o&&o.length>0&&(1==o.length&&(o+="0"),a+=s+o)}return a=(e.currency||"&#36;%d").replace("%d",a.toString()),a}return t};"undefined"!=typeof window&&(window.FPDUtils={},window.FPDUtils.showModal=function(){t(...arguments)},window.FPDUtils.showMessage=function(){n(...arguments)},window.FPDUtils.isUrl=V,window.FPDUtils.pixelToUnit=ct,window.FPDUtils.unitToPixel=lt);class dt{static defaults={imageLoadTimestamp:!1,stageWidth:900,stageHeight:600,editorMode:!1,editorBoxParameters:["left","top","angle","fill","width","height","fontSize","price"],fonts:[{name:"Arial"},{name:"Lobster",url:"google"}],facebookAppId:"",instagramClientId:"",instagramRedirectUri:"",instagramTokenUri:"",hexNames:{},selectedColor:"#f5f5f5",boundingBoxColor:"#2185d0",outOfBoundaryColor:"#990000",replaceInitialElements:!1,fileServerURL:null,responsive:!0,cornerIconColor:"#000000",langJSON:{},colorPickerPalette:[],actions:{left:["info","download","print","preview-lightbox","reset-product"],center:["undo","redo"],right:["zoom","ruler","guided-tour"]},mainBarModules:["products","images","text","designs","manage-layers"],initialActiveModule:"",maxValues:{},watermark:!1,priceFormat:{currency:"&#36;%d",decimalSep:".",thousandSep:","},mainBarContainer:!1,modalMode:!1,keyboardControl:!0,deselectActiveOnOutside:!0,uploadZonesTopped:!0,loadFirstProductInStage:!0,unsavedProductAlert:!1,hideDialogOnAdd:!0,toolbarPlacement:"smart",snapGridSize:[50,50],fabricCanvasOptions:{},namesNumbersDropdown:[],namesNumbersEntryPrice:0,colorSelectionPlacement:"",bulkVariationsPlacement:"",bulkVariations:{},toolbarDynamicContext:"body",boundingBoxProps:{strokeWidth:1},fitImagesInCanvas:!1,maxPrice:-1,inCanvasTextEditing:!0,openTextInputOnSelect:!1,designCategories:[],optionalView:!1,saveActionBrowserStorage:!0,pricingRules:[],uploadAgreementModal:!1,imageEditorSettings:{masks:[]},printingBox:null,autoOpenInfo:!1,guidedTour:null,replaceColorsInColorGroup:!1,allowedImageTypes:["jpeg","png","svg","pdf"],pixabayApiKey:"",pixabayHighResImages:!1,pixabayLang:"en",sizeTooltip:!1,highlightEditableObjects:"",applyFillWhenReplacing:!0,applySizeWhenReplacing:!1,layouts:[],dynamicViewsOptions:{unit:"mm",formats:[],pricePerArea:0,minWidth:0,minHeight:0,maxWidth:1e4,maxHeight:1e4},enableDynamicViews:!1,disableTextEmojis:!1,smartGuides:!0,usePrintingBoxAsBounding:!1,printingBox:{},productsJSON:null,designsJSON:null,customizationRequiredRule:"any",swapProductConfirmation:!1,textLinkGroupProps:[],textTemplates:[],multiSelection:!1,multiSelectionColor:"#54dfe6",canvasHeight:"auto",maxCanvasHeight:.8,mobileGesturesBehaviour:"none",imageQualityRatings:null,splitMultiSVG:!1,cornerControlsStyle:"advanced",downloadFilename:"Product",autoFillUploadZones:!1,dragDropImagesToUploadZones:!1,responsiveBreakpoints:{small:768,medium:1024},dynamicDesigns:{},customTextAsTextbox:!1,viewThumbnailsWrapper:"",rulerUnit:"px",rulerPosition:"canvas",rulerFixed:!1,aiService:{serverURL:null,removeBG:!0,superRes:!0,text2Img:!0},cropMasks:[],industry:{type:null,opts:{}},innerBleed:!1,elementParameters:{objectCaching:!1,z:-1,price:0,colors:!1,removable:!1,draggable:!1,rotatable:!1,resizable:!1,copyable:!1,zChangeable:!1,boundingBox:!1,boundingBoxMode:"clipping",autoCenter:!1,replace:"",replaceInAllViews:!1,autoSelect:!1,topped:!1,colorPrices:{},colorLinkGroup:!1,patterns:[],sku:"",excludeFromExport:!1,showInColorSelection:!1,locked:!1,uniScalingUnlockable:!1,fixed:!1,shadowColor:"",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,colorLink3DLayer:!1,originX:"center",originY:"center",cornerSize:24,fill:!1,lockUniScaling:!0,pattern:!1,top:0,left:0,angle:0,flipX:!1,flipY:!1,opacity:1,scaleX:1,scaleY:1},textParameters:{maxLength:0,curved:!1,curvable:!1,curveRadius:80,maxCurveRadius:400,curveReverse:!1,maxLines:0,textBox:!1,textPlaceholder:!1,numberPlaceholder:!1,letterSpacing:0,chargeAfterEditing:!1,minFontSize:1,textTransform:"none",widthFontSize:0,maxFontSize:200,textLinkGroup:"",strokeColors:[],neonText:!1,editable:!0,fontFamily:"Arial",fontSize:18,lineHeight:1,fontWeight:"normal",fontStyle:"normal",textDecoration:"normal",padding:10,textAlign:"left",stroke:null,strokeWidth:0,charSpacing:0},imageParameters:{uploadZone:!1,filter:null,colorMode:"tint",scaleMode:"fit",resizeToW:0,resizeToH:0,advancedEditing:!1,uploadZoneMovable:!1,uploadZoneRemovable:!1,padding:0,minScaleLimit:.01},customImageParameters:{minW:100,minH:100,maxW:1e4,maxH:1e4,minDPI:72,maxSize:10,autoCenter:!0},customTextParameters:{autoCenter:!0,copyable:!0},customAdds:{designs:!0,uploads:!0,texts:!0,drawing:!0},qrCodeProps:{autoCenter:!0,draggable:!0,removable:!0,resizable:!0},uploadsStorageKey:"fpd_uploaded_images"};static merge(){return z(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static getParameterKeys(){var t=Object.keys(this.defaults.elementParameters),e=Object.keys(this.defaults.imageParameters),i=Object.keys(this.defaults.textParameters);return(t=t.concat(e)).concat(i)}}function ut(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function ft(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}window&&(window.FPDOptions=dt);var pt=new WeakSet,gt=new WeakSet,mt=new WeakSet,vt=new WeakSet;class bt{constructor(t){ut(this,vt),ut(this,mt),ut(this,gt),ut(this,pt),this.fpdInstance=t,G(t,["elementModify","productCreate","elementAdd","elementRemove","viewCreate","viewRemove","elementFillChange","textLinkApply"],this.doPricingRules.bind(this))}doPricingRules(t){const e=this.fpdInstance.mainOptions.dynamicViewsOptions?this.fpdInstance.mainOptions.dynamicViewsOptions.unit:"mm";this.fpdInstance.pricingRulesPrice=0;var i=this.fpdInstance.mainOptions.pricingRules;i&&i.length>0&&i.forEach((t=>{if(t.property&&t.target){var i=[];"canvasSize"==t.property||"coverage"==t.property?i=this.fpdInstance.viewInstances:void 0!==t.target.elements&&"#"===t.target.elements.charAt(0)?i.push(this.fpdInstance.currentViewInstance.fabricCanvas.getElementByTitle(t.target.elements.replace("#",""),t.target.views)):i=void 0!==t.target.elements&&-1!==t.target.elements.search("custom")?this.fpdInstance.getCustomElements(t.target.elements.replace("custom","").toLowerCase(),t.target.views,!1):this.fpdInstance.getElements(t.target.views,t.target.elements,!1),i=i.filter((t=>!t.uploadZone));var n,s=!1;-1!==["elementsLength","colorsLength"].indexOf(t.property)&&(s=!0),i.forEach(((r,a)=>{!r||s&&a>0||(r.hasOwnProperty("element")&&(r=r.element),"textLength"===t.property?n=r.text?r.text.replace(/\s/g,"").length:null:"linesLength"===t.property&&(n=r.text?r.text.split("\n").length:null),"fontSize"===t.property?n=r.text?r.fontSize:null:"imageSize"===t.property?n="image"===r.getType()&&r.title?{width:r.width,height:r.height}:null:"imageSizeScaled"===t.property?n="image"===r.getType()&&r.title?{width:r.width*r.scaleX,height:r.height*r.scaleY}:null:"canvasSize"===t.property?n={width:ct(r.options.stageWidth,e),height:ct(r.options.stageHeight,e)}:"coverage"===t.property?n=ft(this,vt,Ct).call(this,r):"pattern"===t.property?n=r.pattern:"elementsLength"===t.property?n=i.length:"colorsLength"===t.property&&(n=this.fpdInstance.getUsedColors(t.target.views).length),null!=n&&(t.rules.forEach((t=>{t.property=n})),"any"===t.type?t.rules.some(ft(this,pt,yt).bind(this)):t.rules.forEach(ft(this,pt,yt).bind(this))))}))}})),this.fpdInstance.calculatePrice()}}function yt(t,e){return!!ft(this,gt,xt).call(this,t.operator,t.property,t.value)&&("number"==typeof t.price&&(this.fpdInstance.pricingRulesPrice+=t.price),!0)}function xt(t,e,i){if("object"==typeof i){var n=Object.keys(i),s=null;return n.forEach((n=>{!1!==s&&(s=ft(this,mt,wt).call(this,t,e[n],i[n]))})),s}return ft(this,mt,wt).call(this,t,e,i)}function wt(t,e,i){return"="===t?e===i:">"===t?e>i:"<"===t?e<i:">="===t?e>=i:"<="===t?e<=i:void 0}function Ct(t){if(!t||!t.fabricCanvas||!H(t.options.printingBox,["left","top","width","height"]))return null;let e,i,n,s;t.fabricCanvas.forEachObject((t=>{if(!t.excludeFromExport&&!t._ignore){var r=t.getBoundingRect(!0);(void 0===e||r.left<e)&&(e=r.left),(void 0===i||r.top<i)&&(i=r.top),(void 0===n||r.left+r.width>n)&&(n=r.left+r.width),(void 0===s||r.top+r.height>s)&&(s=r.top+r.height)}}));let r={};if(e&&(r={minX:e,minY:i,maxX:n,maxY:s}),!H(r,["minX","minY","maxX","maxY"]))return null;const a=t.options.printingBox,o=Math.max(a.left,r.minX),l=Math.min(a.left+a.width,r.maxX)-o,c=Math.max(a.top,r.minY);return l*(Math.min(a.top+a.height,r.maxY)-c)/(a.width*a.height)*100}var St=i(777);const Tt=(t,e,i,n,s)=>{n=n||{},t.save(),t.translate(e,i),t.rotate(St.fabric.util.degreesToRadians(s.angle)),t.fillStyle=n.cornerColor||s.cornerColor,t.beginPath(),t.roundRect?t.roundRect(-3,-7.5,6,15,4):t.rect(-3,-7.5,6,15),t.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",t.fill(),t.restore()},Et=(t,e,i,n,s)=>{n=n||{},t.save(),t.translate(e,i),t.rotate(St.fabric.util.degreesToRadians(s.angle)),t.fillStyle=n.cornerColor||s.cornerColor,t.beginPath(),t.roundRect?t.roundRect(-7.5,-3,15,6,4):t.rect(-7.5,-3,15,6),t.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",t.fill(),t.restore()};St.fabric.Control.prototype.touchSizeX=40,St.fabric.Control.prototype.touchSizeY=40,St.fabric.Object.prototype.transparentCorners=!1,St.fabric.Object.prototype.controls.ml.render=Tt,St.fabric.Object.prototype.controls.mr.render=Tt,St.fabric.Object.prototype.controls.mt.render=Et,St.fabric.Object.prototype.controls.mb.render=Et,St.fabric.Textbox.prototype.controls.ml.render=Tt,St.fabric.Textbox.prototype.controls.mr.render=Tt,St.fabric.Object.prototype.controls.bl.visible=!1,St.fabric.Object.prototype.controls.mtr.withConnection=!1,St.fabric.Object.prototype.controls.mtr.y=.5,St.fabric.Object.prototype.controls.mtr.offsetY=25,St.fabric.Object.prototype.controls.mtr.offsetX=-8,St.fabric.Object.prototype.controls.tl.render=St.fabric.Object.prototype.controls.tr.render=St.fabric.Object.prototype.controls.mtr.render=St.fabric.Object.prototype.controls.br.render=function(t,e,i,n,s){St.fabric.controlsUtils.renderCircleControl.call(this,t,e,i,n,s)},St.fabric.Object.prototype.controls.cropMaskDoneControl=new St.fabric.Control({x:.5,y:-.5,actionName:"crop-mask-done",offsetY:-20,offsetX:-45,cursorStyle:"pointer",mouseDownHandler:function(t,e){e.target.targetElement},render:(t,e,i,n,s)=>{"crop-mask"===s.name&&(n.cornerColor="#2ecc71",n.cornerIconColor="#fff")},cornerSize:24}),St.fabric.Object.prototype.controls.cropMaskCancelControl=new St.fabric.Control({x:.5,y:-.5,actionName:"crop-mask-cancel",offsetY:-20,offsetX:-12,cursorStyle:"pointer",mouseDownHandler:function(t,e){const i=e.target;i.targetElement&&(i.canvas.removeElement(i),i.targetElement.cropMask=null)},render:(t,e,i,n,s)=>{"crop-mask"===s.name&&(n.cornerColor="#c44d56",n.cornerIconColor="#fff")},cornerSize:24});const At=()=>{const t=function(t,e,i,n,s,r,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:8,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:8;s=s||{};let c=t.sizeX||s.cornerSize||r.cornerSize,h=t.sizeY||s.cornerSize||r.cornerSize,d=c/2,u=h/2;const f=.6*c,p=s.cornerIconColor||r.cornerIconColor||"#000000";e.save(),e.translate(i,n),e.rotate(St.fabric.util.degreesToRadians(r.angle)),e.fillStyle=s.cornerColor||r.cornerColor,e.beginPath(),e.roundRect?e.roundRect(-d+o,-u+l,c,h,4):e.rect(-d+o,-u+l,c,h),e.filter="drop-shadow(0px 0px 2px rgba(0,0,0, 0.3))",e.fill(),e.font=f+"px FontFPD",e.fillStyle=p,e.textAlign="left",e.textBaseline="top",e.filter="none",e.fillText(a,-.5*f+o,-.5*f+l),e.restore()};St.fabric.Object.prototype.controls.tl.cursorStyleHandler=()=>"pointer",St.fabric.Object.prototype.controls.tl.mouseDownHandler=function(t,e){const i=e.target;"advanced"===i.canvas.viewOptions.cornerControlsStyle&&i.canvas.duplicateElement(i)},St.fabric.Object.prototype.controls.tl.actionHandler=null,St.fabric.Object.prototype.controls.tl.render=function(e,i,n,s,r){t(this,e,i,n,s,r,String.fromCharCode("0xe94d"),-8,-8)},St.fabric.Object.prototype.controls.tr.cursorStyleHandler=()=>"pointer",St.fabric.Object.prototype.controls.tr.mouseDownHandler=function(t,e){const i=e.target;i.canvas.removeElement(i)},St.fabric.Object.prototype.controls.tr.actionHandler=null,St.fabric.Object.prototype.controls.tr.render=function(e,i,n,s,r){t(this,e,i,n,s,r,String.fromCharCode("0xe907"),8,-8)},St.fabric.Object.prototype.controls.mtr.render=function(e,i,n,s,r){t(this,e,i,n,s,r,String.fromCharCode("0xe957"))},St.fabric.Object.prototype.controls.br.render=function(e,i,n,s,r){t(this,e,i,n,s,r,String.fromCharCode("0xe922"))}};var It;St.fabric.Group.prototype.changeObjectColor=function(t,e){let i=[];return this.getObjects().forEach((t=>{const e=o(t.fill);i.push(e.toHexString())})),i[t]=e,this.changeColor(i),i},St.fabric.Text.prototype.initialize=(It=St.fabric.Text.prototype.initialize,function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return It.call(this,...e),this._TextInit(),this}),St.fabric.Text.prototype.toImageSVG=function(t){let e=this.clipPath;this.clipPath=null;let i=1;if(this?.canvas?.viewOptions?.printingBox&&this?.canvas?.viewOptions?.output){const t=Math.ceil(25.4*this.canvas.viewOptions.printingBox.width/this.canvas.viewOptions.output.width);i=parseInt(300/t)}let n=this,s=n.width,r=n.height;if(this.shadow?.color){var a=this.shadow;s+=2*(Math.abs(a.offsetX)+a.blur),r+=2*(Math.abs(a.offsetY)+a.blur)}let o=n.toDataURL({withoutShadow:!1,withoutTransform:!0,multiplier:i,enableRetinaScaling:!1});return this.clipPath=e,this._createBaseSVGMarkup([`<image href="${o}" width = "${s}" height = "${r}" x = "${-s/2}" y="${-r/2}" style="scale: ${1/this.scaleX} ${1/this.scaleY}"/>`],{reviver:t[0],noStyle:!0,withShadow:!1})},St.fabric.Text.prototype.toSVG=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this.canvas.printMode&&(1!=this.opacity||this.shadow?.color||this.pattern)?this.toImageSVG(i):t.call(this,...i)}}(St.fabric.Text.prototype.toSVG),St.fabric.Text.prototype._constrainScale=function(t){return function(e){return e=t.call(this,e),void 0!==this.minFontSize&&parseFloat(Number(e*this.fontSize).toFixed(0))<this.minFontSize?this.minFontSize/this.fontSize:void 0!==this.maxFontSize&&parseFloat(Number(e*this.fontSize).toFixed(0))>this.maxFontSize?this.maxFontSize/this.fontSize:e}}(St.fabric.Text.prototype._constrainScale),St.fabric.Text.prototype._TextInit=function(){this.on({modified:t=>{(t=>{if(!t.curved&&!t.uniScalingUnlockable){let e=t.fontSize*t.scaleX;e=parseFloat(Number(e).toFixed(0)),t.scaleX=1,t.scaleY=1,t._clearCache(),t.set("fontSize",e),t.canvas&&t.canvas.fire("elementModify",{element:t,options:{fontSize:e}})}})(this)}})},St.fabric.Text.prototype._createTextCharSpan=function(t,e,i,n){e.fontWeight=this.fontWeight,e.fontStyle=this.fontStyle;var s=t!==t.trim()||t.match(/  +/g),r=this.getSvgSpanStyles(e,s);let a=(r+="underline"===this.textDecoration?" text-decoration: underline;":"")?'style="'+r+'"':"",o=e.deltaY,l="",c=St.fabric.Object.NUM_FRACTION_DIGITS;return o&&(l=' dy="'+St.fabric.util.toFixed(o,c)+'" '),['<tspan x="',St.fabric.util.toFixed(i,c),'" y="',St.fabric.util.toFixed(n,c),'" ',l,a,">",St.fabric.util.string.escapeXml(t),"</tspan>"].join("")},St.fabric.Text.prototype._getSVGLeftTopOffsets=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];const s=t.call(this,...i);return"rtl"===this.direction&&(s.textLeft=this.width/2),s}}(St.fabric.Text.prototype._getSVGLeftTopOffsets),St.fabric.Text.prototype._renderChars=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];if("rtl"===this.direction){const t=i[1];t&&(t.direction="rtl")}t.call(this,...i)}}(St.fabric.Text.prototype._renderChars),St.fabric.IText.prototype.initialize=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._ITextInit(),this}}(St.fabric.IText.prototype.initialize),St.fabric.IText.prototype._ITextInit=function(){this.on({added:()=>{this.setTextPath&&this.setTextPath()},"editing:entered":()=>{this.canvas.viewOptions.inCanvasTextEditing||this.exitEditing(),this.curved&&this.exitEditing()},changed:()=>{if(0!=this.maxLines&&this.textLines.length>this.maxLines){let t=this.textLines.slice(0,this.maxLines);this.set("text",t.join("\n")),this.exitEditing()}if(0!=this.maxLength&&this.text.length>this.maxLength&&(this.set("text",this.text.substr(0,this.maxLength)),this.exitEditing()),this.canvas.viewOptions.disableTextEmojis){let t=this.text.replace(FPDEmojisRegex,"");t=t.replace(String.fromCharCode(65039),""),this.set("text",t)}if(this.widthFontSize){let t;t=this.width>this.widthFontSize?this.fontSize*(this.widthFontSize/(this.width+1)):this.fontSize*(this.widthFontSize/(this.width-1)),t<this.minFontSize?t=this.minFontSize:t>this.maxFontSize&&(t=this.maxFontSize),t=parseInt(t),this.set("fontSize",t)}}})},St.fabric.Textbox.prototype.initialize=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._TextboxInit(),this}}(St.fabric.Textbox.prototype.initialize),St.fabric.Textbox.prototype._TextboxInit=function(){this.on({added:()=>{if(this._calcWidth){this.set("width",1e3);const t=this.calcTextWidth();this.set("width",t),delete this._calcWidth}}})};const Ot=St.fabric.util.createClass(St.fabric.Group,{type:"neon-text",text:"",fontFamily:"Arial",fontSize:40,lineHeight:1,charSpacing:0,textAlign:"left",initialize:function(t,e){e||(e={}),this.text=t,this.texts=[],[{color:"#fff",offsetX:0,offsetY:0,blur:5},{color:"#fff",offsetX:0,offsetY:0,blur:10},{color:e.fill,offsetX:0,offsetY:0,blur:40},{color:e.fill,offsetX:0,offsetY:0,blur:80}].forEach(((i,n)=>{const s=new St.fabric.IText(t,{left:0,top:0,originX:"center",originY:"center",fontSize:e.fontSize,fontFamily:e.fontFamily,fill:"#fff",shadow:new St.fabric.Shadow(i)});this.texts.push(s)})),this.callSuper("initialize",this.texts,e)},set:function(t,e){["fill","fontFamily","text","fontSize","lineHeight","charSpacing","textAlign"].includes(t)&&this.texts.forEach((i=>{"text"==t?i[t]=e:"fill"==t?(this.texts[2].shadow.color=e,this.texts[3].shadow.color=e):i[t]=e})),setTimeout((()=>{this.width=this.texts[0].width,this.height=this.texts[0].height,this.canvas&&this.canvas.renderAll()}),10),this.callSuper("set",t,e)}});St.fabric.NeonText=Ot,St.fabric.NeonText.fromObject=function(t,e){return St.fabric.Object._fromObject("NeonText",t,e)};const kt=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i="number"!=typeof i?0:i,n="number"!=typeof n?0:n;let s=1,r=0!==i,a=0!==n;return s="cover"===(arguments.length>4&&void 0!==arguments[4]?arguments[4]:"fit")?i-t<n-e?r?Math.max(i/t,n/e):1:a?Math.max(i/t,n/e):1:t>e?r?Math.min(i/t,n/e):1:a?Math.min(i/t,n/e):1,parseFloat(s.toFixed(10))},Mt=t=>/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(t);window&&(window.FPDFabricUtils={getScaleByDimesions:kt}),fabric.CurvedText=fabric.util.createClass(fabric.IText,{type:"curved-text",initialize:function(t,e){e||(e={}),this.callSuper("initialize",t,e),this.curveRadius=e.curveRadius||50,this.curveReverse=e.curveReverse||!1,this.effect=e.effect||"curved",this.startAngle=e.startAngle||-Math.PI/2,this.on({selected:()=>{this.path&&(this.path.visible=!0)},deselected:()=>{this.path&&(this.path.visible=!1)}})},_set:function(t,e){return this.callSuper("_set",t,e),this},_escapeXml:function(t){return t.replace(/[<>&'"]/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";default:return t}}))},_getLetterPositions:function(){if(!(this.textLines?.length>0&&this.textLines[0].length>0&&this.curveRadius>0))return console.error("ERROR: Can't calculate letter positions."),[];const t=this.textLines[0],e=fabric.util.createCanvasElement().getContext("2d");e.font=this.fontSize+"px "+this.fontFamily;const i=[],n=.1*this.letterSpacing*this.fontSize;let s=0,r=0;for(let a=0;a<t.length;a++){const o=e.measureText(t[a]).width;s+=0===a?o/2:n+(e.measureText(t[a-1]+t[a]).width-o/2-r/2),r=o,i.push({char:t[a],distance:s})}const a=this.calcTextWidth()/this.curveRadius/2+Math.PI,o=this.startAngle+(this.curveReverse?a:-a-Math.PI);return i.map((t=>{const e=o+t.distance/this.curveRadius*(this.curveReverse?-1:1);return{char:t.char,x:this.curveRadius*Math.cos(e),y:this.curveRadius*Math.sin(e),rotation:180*e/Math.PI+(this.curveReverse?270:90)}}))},toSVG:function(){if(this.canvas.printMode&&(1!=this.opacity||this.shadow?.color||this.pattern)){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.toImageSVG(e)}const n=["<g ",this.getSvgTransform(),this.getSvgFilter()];this.clipPath&&!this.clipPath.excludeFromExport&&n.push(' clip-path="url(#',this.clipPath.clipPathId,')"'),n.push(">");const s=this._getLetterPositions(),r=['font-family="',this.fontFamily?this._escapeXml(this.fontFamily):"Times New Roman",'" ','font-size="',this.fontSize,'" ','font-style="',this.fontStyle,'" ','font-weight="',this.fontWeight,'" ','text-decoration="',this.textDecoration||"",'" ','style="',this.getSvgStyles(!0),'"',this.addPaintOrder()].join("");return s.forEach((t=>{n.push("<text ",r,'text-anchor="middle" ','dominant-baseline="middle" ','transform="translate(',t.x.toFixed(2),",",t.y.toFixed(2),") rotate(",t.rotation.toFixed(2),')"',">",this._escapeXml(t.char),"</text>\n")})),n.push("</g>\n"),n.join("")},setTextPath:function(){const t=new fabric.Path((0,0,"M0,0m"+-(e=this.curveRadius)+",0a"+e+","+e+" 0 1,0 "+2*e+",0a"+e+","+e+" 0 1,0 "+2*-e+",0"),{fill:"transparent",strokeWidth:1,stroke:"rgba(0,0,0, 0.1)",visible:!1});var e;this.set("path",t),this.updateTextPosition()},updateTextPosition:function(){if(this.path){this.pathSide=this.curveReverse?"left":"right";const t=this.curveReverse?Math.PI*this.curveRadius*2*.25:Math.PI*this.curveRadius/2;this.pathStartOffset=t-this.calcTextWidth()/2,this.pathAlign="center"}},toObject:function(t){return fabric.util.object.extend(this.callSuper("toObject",t),{curveRadius:this.curveRadius,curveReverse:this.curveReverse,effect:this.effect,startAngle:this.startAngle})}}),fabric.CurvedText.fromObject=function(t,e){return fabric.Object._fromObject("CurvedText",t,e)},St.fabric.Object.propertiesToInclude=["_isInitial","lockMovementX","lockMovementY","lockRotation","lockScalingX","lockScalingY","lockScalingFlip","lockUniScaling","resizeType","boundingBox","boundingBoxMode","selectable","evented","title","editable","cornerColor","cornerIconColor","borderColor","isEditable","hasUploadZone","cornerSize","source","_optionsSet"],St.fabric.Object.prototype._limitModifyOpts={},St.fabric.Object.prototype.__editorMode=!1,St.fabric.Object.prototype.initialize=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._elementInit(),this}}(St.fabric.Object.prototype.initialize),St.fabric.Object.prototype._elementInit=function(){this.on({added:()=>{!this.isCustom||this.hasUploadZone||this.replace||(this.copyable=this.originParams.copyable=!0)},moving:()=>{this._checkContainment()},rotating:()=>{this._checkContainment()},scaling:()=>{this._checkContainment()},selected:()=>{this._elementControls()}})},St.fabric.Object.prototype._elementControls=function(){let t=Boolean(!this.lockUniScaling||this.__editorMode),e=Boolean(!this.lockUniScaling||this.__editorMode),i=Boolean(this.copyable||this.__editorMode),n=Boolean(this.removable||this.__editorMode),s=Boolean((this.resizable||this.__editorMode)&&!this.curved&&!this.widthFontSize),r=Boolean(this.rotatable||this.__editorMode);this.textBox&&!this.curved&&(t=!0),this.canvas&&"basic"==this.canvas.viewOptions.cornerControlsStyle&&(this.controls.mtr.offsetX=0,this.cornerSize=16),"printing-boxes"!=this.name&&"view-mask"!=this.name||(t=!1,e=!1,r=!1,i=!1,n=!1),this.setControlsVisibility({ml:t,mr:t,mt:e,mb:e,tr:n,tl:i,mtr:r,br:s})},St.fabric.Object.prototype._checkContainment=function(){if(this.canvas&&this.canvas.currentBoundingObject&&!this.hasUploadZone)if(this.setCoords(),"limitModify"===this.boundingBoxMode){let t=this.getBoundingRect(),e=this.canvas.currentBoundingObject.getBoundingRect(),i=e.left,n=e.left+e.width-t.width,s=e.top,r=e.top+e.height-t.height;this.isContainedWithinObject(this.canvas.currentBoundingObject)?(this._limitModifyOpts={left:this.left,top:this.top,angle:this.angle,scaleX:this.scaleX,scaleY:this.scaleY},"text"==this.getType()&&(this._limitModifyOpts.fontSize=this.fontSize,this._limitModifyOpts.lineHeight=this.lineHeight,this._limitModifyOpts.charSpacing=this.charSpacing)):(t.left>i&&t.left<n&&(this._limitModifyOpts.left=this.left),t.top>s&&t.top<r&&(this._limitModifyOpts.top=this.top),this.setOptions(this._limitModifyOpts))}else if("inside"===this.boundingBoxMode||"clipping"===this.boundingBoxMode){var t,e=this.isOut;(t=!this.isContainedWithinObject(this.canvas.currentBoundingObject))?("inside"===this.boundingBoxMode&&(this.borderColor=this.canvas.viewOptions.outOfBoundaryColor),this.isOut=!0):("inside"===this.boundingBoxMode&&(this.borderColor=this.canvas.viewOptions.selectedColor),this.isOut=!1),e!=this.isOut&&null!=e&&(t?this.canvas.fire("elementOut",{target:this}):this.canvas.fire("elementIn",{target:this})),this.canvas.fire("elementCheckContainemt",{target:this,boundingBoxMode:this.boundingBoxMode})}},St.fabric.Object.prototype._clipElement=function(){var t=this.getClippingObject();if(t){if(t.type)t.clone((t=>{t.set({absolutePositioned:!0,opacity:1}),this.clipPath=t}));else{const e=new St.fabric.Rect({originX:"left",originY:"top",angle:t.angle||0,left:t.left,top:t.top,width:t.width,height:t.height,fill:"#DDD",absolutePositioned:!0,rx:t.borderRadius,ry:t.borderRadius});this.clipPath=e}this.canvas.renderAll()}},St.fabric.Object.prototype.getType=function(t){return"text"===(t=t||this.type)||"i-text"===t||"textbox"===t||"neon-text"===t||"engraved-text"===t||"curved-text"===t?"text":"image"},St.fabric.Object.prototype.isSVG=function(){return"group"===this.type||"path"===this.type||this.source&&this.source.includes(".svg")},St.fabric.Object.prototype.isColorizable=function(){return"text"===this.getType()?"text":!!this.source&&(1==this.source.split(".").length?this.source.includes("data:image/png;")?"dataurl":(this.fill=this.colors=!1,!1):(t=>this.source.replace(/\?.*$/,""))().includes(".png")||this.isSVG()?this.isSVG()?"svg":"png":(this.fill=this.colors=!1,!1))},St.fabric.Object.prototype.isBitmap=function(){return"image"===this.type},St.fabric.Object.prototype.hasColorSelection=function(){return(Array.isArray(this.colors)||Boolean(this.colors)||this.colorLinkGroup||this.__editorMode)&&!1!==this.isColorizable()},St.fabric.Object.prototype.checkEditable=function(t){return"object"==typeof(t=t||this).colors||!0===t.colors||1==t.colors||t.removable||t.draggable||t.resizable||t.rotatable||t.zChangeable||t.advancedEditing||t.editable||t.uploadZone||t.colorLinkGroup&&t.colorLinkGroup.length>0||t.__editorMode},St.fabric.Object.prototype.changeColor=function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this.isColorizable();if("string"==typeof t&&Mt(t)&&(t=o(t).toHexString()),"text"===this.getType())"object"==typeof t&&(t=t[0]),this.set("fill",t),this.canvas.renderAll(),this.pattern=null;else if("group"==this.type&&"object"==typeof t){const e=this.getObjects();t.forEach(((t,i)=>{e[i]&&e[i].set("fill",t)})),this.canvas.renderAll(),this.svgFill=t,delete this.fill}else"object"==typeof t&&(t=t[0]),"string"!=typeof t&&(t=!1),"png"!=i&&"dataurl"!=i||!t?"svg"==i&&(this.set("fill",t),this.canvas.renderAll()):(this.filters=[],this.filters.push(new St.fabric.Image.filters.BlendColor({mode:this.colorMode,color:t,alpha:1})),this.applyFilters(),this.canvas.renderAll(),this.fill=t);this.canvas.fire("elementFillChange",{element:this,colorLinking:e})},St.fabric.Object.prototype.setPattern=function(t){t&&(this.canvas.proxyFileServer&&(t=this.canvas.proxyFileServer+t),St.fabric.util.loadImage(t,(t=>{if(this.isSVG())if(this.hasOwnProperty("getObjects")){const i=this.getObjects();for(var e=0;e<i.length;++e)i[e].set("fill",new St.fabric.Pattern({source:t,repeat:"repeat"}))}else this.set("fill",new St.fabric.Pattern({source:t,repeat:"repeat"}));else if("text"==this.getType())this.set("fill",new St.fabric.Pattern({source:t,repeat:"repeat"}));else{let t=this.fill?this.fill:this.colors[0];t=t||"#000000",this.set("fill",t)}this.canvas.renderAll(),this.canvas.fire("elementFillChange",{element:this})})),this.pattern=t)},St.fabric.Object.prototype.getZIndex=function(){return this.canvas.getObjects().indexOf(this)},St.fabric.Object.prototype.centerElement=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getBoundingBoxCoords(),n=this.left,s=this.top;t&&(n=i?i.cp?i.cp.x:i.left+.5*i.width:.5*this.canvas.viewOptions.stageWidth),e&&(s=i?i.cp?i.cp.y:i.top+.5*i.height:.5*this.canvas.viewOptions.stageHeight),this.setPositionByOrigin(new St.fabric.Point(n,s),"center","center"),this.canvas.renderAll(),this.setCoords(),this._checkContainment(),this.autoCenter=!1},St.fabric.Object.prototype.getBoundingBoxCoords=function(){if(this.boundingBox||this.uploadZone){if("object"==typeof this.boundingBox)return!!(this.boundingBox.hasOwnProperty("x")&&this.boundingBox.hasOwnProperty("y")&&this.boundingBox.width&&this.boundingBox.height)&&{left:this.boundingBox.x,top:this.boundingBox.y,width:this.boundingBox.width,height:this.boundingBox.height,borderRadius:this.boundingBox.borderRadius||0};{const t=this.canvas.getElementByTitle(this.boundingBox);if(t){const e=t.getPointByOrigin("left","top");return{left:e.x,top:e.y,width:t.width*t.scaleX,height:t.height*t.scaleY,angle:t.angle||0,cp:t.getCenterPoint()}}}}return!1},St.fabric.Object.prototype.getClippingObject=function(){if(this.boundingBox||this.uploadZone){if("object"==typeof this.boundingBox)return this.getBoundingBoxCoords();{const t=this.canvas.getElementByTitle(this.boundingBox);if(t)return"image"==t.type?this.getBoundingBoxCoords():t}}return!1},St.fabric.Object.prototype.getElementJSON=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.canvas&&(e=Object.keys(this.canvas.viewOptions.elementParameters),e="text"===this.getType()?e.concat(Object.keys(this.canvas.viewOptions.textParameters)):e.concat(Object.keys(this.canvas.viewOptions.imageParameters))),t&&(e=e.concat(St.fabric.Object.propertiesToInclude)),this.uploadZone&&(e.push("customAdds"),e.push("designCategories"),e.push("designCategories[]")),"text"===this.getType()&&(e.push("text"),e.push("_initialText")),"group"===this.type&&e.push("svgFill"),e.push("width"),e.push("height"),e.push("isEditable"),e.push("hasUploadZone"),e.push("evented"),e.push("isCustom"),e.push("currentColorPrice"),e.push("_isPriced"),e.push("originParams"),e.push("originSource"),e.push("_printingBox"),e.push("_optionsSet"),e.push("_isQrCode"),e.push("cropMask"),e.push("isCustomImage"),e=e.sort();let i={};return e.forEach((t=>{void 0!==this[t]&&(i[t]=this[t])})),i},St.fabric.Object.prototype.alignToPosition=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left",e=this.getPointByOrigin("left","top"),i=this.getBoundingBoxCoords(),n="left",s="top";"left"===t?(e.x=i?i.left:0,e.x+=this.padding+1):"top"===t?(e.y=i?i.top:0,e.y+=this.padding+1):"right"===t?(e.x=i?i.left+i.width-this.padding:this.canvas.viewOptions.stageWidth-this.padding,n="right"):(e.y=i?i.top+i.height-this.padding:this.canvas.viewOptions.stageHeight,s="bottom"),this.setPositionByOrigin(e,n,s),this.canvas.renderAll(),this._checkContainment()},St.fabric.Object.prototype.toggleUploadZone=function(){if(this.hasUploadZone&&this.canvas){let i=this.canvas.getObjects(),n=!0;for(var t=0;t<i.lenth;++t)if(i[t].replace==this.replace){n=!1;break}var e=this.canvas.getUploadZone(this.replace);e&&(e.set("opacity",n?1:0),e.evented=n),this.canvas.renderAll()}},i(106),fabric.Canvas.prototype.panCanvas=!1;fabric.Canvas.prototype.snapToObjects=!1,fabric.Canvas.prototype.snapToGrid=!1,fabric.Canvas.prototype.snapGridSize=[50,50];fabric.Canvas.prototype.enableRuler=!1,fabric.Canvas.prototype.rulerBg="rgba(0,0,0, 0.6)",fabric.Canvas.prototype.rulerTickColor="#ccc";St.fabric.Canvas.prototype.viewOptions={},St.fabric.Canvas.prototype.elements=[],St.fabric.Canvas.prototype.currentElement=null,St.fabric.Canvas.prototype.responsiveScale=1,St.fabric.Canvas.prototype.currentBoundingObject=null,St.fabric.Canvas.prototype.initialElementsLoaded=!1,St.fabric.Canvas.prototype.isCustomized=!1,St.fabric.Canvas.prototype.printingBoxObject=null,St.fabric.Canvas.prototype._canvasCreated=!1,St.fabric.Canvas.prototype._doHistory=!1,St.fabric.Canvas.prototype.forbiddenTextChars=/<|>/g,St.fabric.Canvas.prototype.proxyFileServer="",St.fabric.Canvas.prototype.initialize=function(t){return function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.call(this,...i),this._fpdCanvasInit(),this}}(St.fabric.Canvas.prototype.initialize),St.fabric.Canvas.prototype._onTouchStart=function(t){return function(e){const i=this.findTarget(e);(!this.allowTouchScrolling||i||this.isDrawingMode)&&t.call(this,e)}}(St.fabric.Canvas.prototype._onTouchStart),St.fabric.Canvas.prototype._fpdCanvasInit=function(){if(this.containerClass.includes("fpd-hidden-canvas"))return;let t=null;this.on({"after:render":()=>{this._canvasCreated||this._onCreated(),this.viewOptions&&this.viewOptions.highlightEditableObjects&&this.viewOptions.highlightEditableObjects.length>3&&(this.contextContainer.strokeStyle=this.viewOptions.highlightEditableObjects,this.forEachObject((t=>{if(t!==this.getActiveObject()&&!t.isMoving&&("text"===t.getType()&&t.editable||t.uploadZone)){const e=t.getBoundingRect();this.contextContainer.setLineDash([5,15]),this.contextContainer.strokeRect(e.left,e.top,e.width,e.height)}else this.contextContainer.setLineDash([])})))},"object:added":t=>{let{target:e}=t;this._bringToppedElementsToFront()},"object:moving":e=>{let{target:i}=e;t="moving",this.fire("elementChange",{type:"moving",element:i})},"object:rotating":e=>{let{target:i}=e;t="rotating",this.fire("elementChange",{type:"rotating",element:i})},"object:scaling":e=>{let{target:i}=e;t="scaling",this.fire("elementChange",{type:"scaling",element:i})},"object:modified":e=>{let{target:i}=e;const n=i;if(null!==t){let e={};switch(t){case"moving":e.left=Number(n.left),e.top=Number(n.top);break;case"scaling":"text"!==n.getType()||n.curved||n.uniScalingUnlockable?(e.scaleX=parseFloat(n.scaleX),e.scaleY=parseFloat(n.scaleY)):e.fontSize=parseInt(n.fontSize);break;case"rotating":e.angle=n.angle}this.fire("elementModify",{element:n,options:e})}t=null},"selection:created":t=>{let{selected:e}=t;1==e.length?this._onSelected(e[0]):this._onMultiSelected(e)},"selection:updated":t=>{let{selected:e}=t;1==e.length?this._onSelected(e[0]):this._onMultiSelected(e)},"mouse:down":t=>{t.target&&t.target.__corner&&"function"==typeof t.target.exitEditing&&t.target.exitEditing(),null==t.target&&this.deselectElement()},elementAdd:()=>{this.forEachObject((t=>{!t.clipPath&&(t.boundingBox&&"clipping"===t.boundingBoxMode||t.hasUploadZone)&&t._clipElement()}))},"text:changed":t=>{let{target:e}=t;this.fire("elementModify",{element:e,options:{text:e.text}})}})},St.fabric.Canvas.prototype._onCreated=function(){var t;this._canvasCreated=!0,((t,e)=>{let i,n,s,r,a=!1,o=null;t.on({"mouse:down":e=>{a=!0,e.e.touches&&(i=e.e.touches[0].clientX,n=e.e.touches[0].clientY,t.currentElement&&(s=t.currentElement.scaleX,r=t.currentElement.scaleY))},"mouse:up":function(t){a=!1,o=null},"mouse:move":function(l){let c=null;if(("pinchImageScale"==e||"pinchPanCanvas"==e)&&l.e.touches&&2==l.e.touches.length){let t=l.e.touches[0],e=l.e.touches[1];null===o&&(o=Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))),c=Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))/o}if("pinchImageScale"==e&&null!==c&&t.currentElement&&"image"==t.currentElement.getType()&&t.currentElement.resizable)t.setElementOptions({scaleX:s*c,scaleY:r*c},t.currentElement);else if("pinchPanCanvas"==e&&l.e.touches&&null!==c)t.setResZoom(c);else if(t.panCanvas)if(l.e.touches){if(1==l.e.touches.length){let e=l.e.touches[0].clientX,s=l.e.touches[0].clientY;t.relativePan(new fabric.Point(e-i,s-n)),i=e,n=s}}else a&&t.relativePan(new fabric.Point(l.e.movementX,l.e.movementY))}})})(this,this.viewOptions.mobileGesturesBehaviour),(t=>{let e,i=t.getSelectionContext(),n=4,s=1,r="rgba(255,0,241,0.5)",a=1;function o(e){c(e-s,0,e-s,t.getHeight()/a)}function l(e){c(0,e-s,t.getWidth()/a,e-s)}function c(n,o,l,c){i.save(),i.lineWidth=s,i.strokeStyle=r,i.beginPath(),t.snapToGrid||i.setLineDash([5,10]),i.moveTo((n+e[4])*a,(o+e[5])*a),i.lineTo((l+e[4])*a,(c+e[5])*a),i.stroke(),i.restore()}function h(t,e){t=Math.round(t),e=Math.round(e);for(var i=t-n,s=t+n;i<=s;i++)if(i===e)return!0;return!1}var d=[],u=[];t.on("mouse:down",(()=>{e=t.viewportTransform,a=t.getZoom()})),t.on("object:moving",(i=>{let n=i.target,s=t.getObjects(),r=n.getCenterPoint(),a=r.x,o=r.y,l=n.getBoundingRect(),c=l.height/e[3],f=l.width/e[0],p=!1,g=!1,m=t._currentTransform;if(t.snapToGrid,t.snapToObjects&&!t.snapToGrid&&m){for(var v=s.length;v--;)if(s[v]!==n){var b=s[v].getCenterPoint(),y=b.x,x=b.y,w=s[v].getBoundingRect(),C=w.height/e[3],S=w.width/e[0];h(y,a)&&(g=!0,d.push({x:y,y1:x<o?x-C/2-1:x+C/2+1,y2:o>x?o+c/2+1:o-c/2-1}),n.setPositionByOrigin(new fabric.Point(y,o),"center","center")),h(y-S/2,a-f/2)&&(g=!0,d.push({x:y-S/2,y1:x<o?x-C/2-1:x+C/2+1,y2:o>x?o+c/2+1:o-c/2-1}),n.setPositionByOrigin(new fabric.Point(y-S/2+f/2,o),"center","center")),h(y+S/2,a+f/2)&&(g=!0,d.push({x:y+S/2,y1:x<o?x-C/2-1:x+C/2+1,y2:o>x?o+c/2+1:o-c/2-1}),n.setPositionByOrigin(new fabric.Point(y+S/2-f/2,o),"center","center")),h(x,o)&&(p=!0,u.push({y:x,x1:y<a?y-S/2-1:y+S/2+1,x2:a>y?a+f/2+1:a-f/2-1}),n.setPositionByOrigin(new fabric.Point(a,x),"center","center")),h(x-C/2,o-c/2)&&(p=!0,u.push({y:x-C/2,x1:y<a?y-S/2-1:y+S/2+1,x2:a>y?a+f/2+1:a-f/2-1}),n.setPositionByOrigin(new fabric.Point(a,x-C/2+c/2),"center","center")),h(x+C/2,o+c/2)&&(p=!0,u.push({y:x+C/2,x1:y<a?y-S/2-1:y+S/2+1,x2:a>y?a+f/2+1:a-f/2-1}),n.setPositionByOrigin(new fabric.Point(a,x+C/2-c/2),"center","center"))}p||(u.length=0),g||(d.length=0)}})),t.on("before:render",(()=>{t.contextTop&&t.clearContext(t.contextTop)})),t.on("after:render",(()=>{if(!t.panCanvas)if(t.snapToGrid){if(e=t.viewportTransform,a=t.getZoom(),t.snapGridSize){const e=Math.round(t.width/a/t.snapGridSize[0]);for(let i=0;i<e;++i)o(i*t.snapGridSize[0]);const i=Math.round(t.height/a/t.snapGridSize[1]);for(let e=0;e<i;++e)l(e*t.snapGridSize[1])}}else{for(var i=d.length;i--;)o(d[i].x);for(i=u.length;i--;)l(u[i].y);d.length=u.length=0}})),t.on("mouse:up",(()=>{d.length=u.length=0,t.renderAll()}))})(this),(t=this).on("after:render",(()=>{if(t.viewOptions&&t.enableRuler){const n=10,s=100,r=t.viewOptions.rulerUnit,a=t.viewOptions.rulerPosition,o=t.viewOptions.printingBox,l=t.getZoom(),c=t.getSelectionContext();if(!c)return;const h=t.viewOptions.stageWidth,d=t.viewOptions.stageHeight,u=t=>{const e=t/n,i=Math.pow(10,Math.floor(Math.log10(e))),s=e/i;return s>=5?5*i:s>=2?2*i:i};let f,p="cm"==r?10:1,g=1,m=1;"px"!=r&&H(o,["left","top","width","height"])&&H(t.viewOptions.output,["width","height"])?(f=t.viewOptions.output,g=f.width/o.width,m=f.height/o.height):p=1;let v=20*l,b=20*l,y=0,x=0,w=t.width-b,C=0,S=h,T=d,E=h*g,A=d*m;"pb"==a&&f&&(y=o.left*l,x=(o.top-v)*l,S=o.width*l,w=(o.left+o.width)*l,C=o.top*l,T=o.height*l,E=f.width,A=f.height),c.fillStyle=t.rulerBg,c.fillRect(y,x,S,v);for(var e=0;e<=E;e+=u(E)){const i=e%s==0?v:v/3,n=e*l/g;if(c.fillRect(y+n,x,1,i),e%s==0){c.fillStyle=t.rulerTickColor,c.font="10px Arial";let i=y+n;const s=c.measureText(Math.round(e/p));i+=0==e?2:-(s.width+2),c.fillText(Math.round(e/p)+(0==e?" "+r.toUpperCase():""),i,x+v-2)}}c.fillStyle=t.rulerBg,c.fillRect(w,C,b,T);for(var i=0;i<=A;i+=u(A)){const e=i%s==0?b:b/3,n=i*l/m;if(c.fillRect(w,C+n,e,1),i%s==0){c.fillStyle=t.rulerTickColor,c.font="10px Arial";let e=C+n;e+=0==i?12:-2,c.fillText(Math.round(i/p),w,e)}}}})),t.on("before:render",(()=>{t.contextTop&&t.clearContext(t.contextTop)})),this._renderPrintingBox()},St.fabric.Canvas.prototype._onSelected=function(t){if("crop-mask"!==t.name){const t=this.getObjects().find((t=>"crop-mask"===t.name));t&&this.remove(t)}if(this.deselectElement(!1),this.dragStage)return this.deselectElement(),!1;this.currentElement=t,this.fire("elementSelect",{element:t}),this.hoverCursor=t.draggable?"move":"pointer",t.boundingBox&&!t.uploadZone&&this._renderElementBoundingBox(t)},St.fabric.Canvas.prototype._onMultiSelected=function(t){const e=this.getActiveObject();this.viewOptions.multiSelection&&(e.set({lockScalingX:!Boolean(this.viewOptions.editorMode),lockScalingY:!Boolean(this.viewOptions.editorMode),lockRotation:!Boolean(this.viewOptions.editorMode),hasControls:Boolean(this.viewOptions.editorMode),borderDashArray:[8,8],cornerSize:24,transparentCorners:!1,borderColor:this.viewOptions.multiSelectionColor,borderScaleFactor:3}),t.forEach((t=>{(t.draggable||this.viewOptions.editorMode)&&t.evented||e.removeWithUpdate(t)})),e.setControlsVisibility({tr:!1,tl:!1,mtr:!1}),this.fire("multiSelect",{activeSelection:e}))},St.fabric.Canvas.prototype._renderElementBoundingBox=function(t){var e=this;this.currentBoundingObject&&(this.remove(this.currentBoundingObject),this.currentBoundingObject=null);const i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(e.add(t),t.bringToFront(),e.fire("boundingBoxToggle",{currentBoundingObject:e.currentBoundingObject,state:!0}))};if(t&&(!t._printingBox||!this.viewOptions.printingBox.visibility)){var n=t.getBoundingBoxCoords();if(n&&"none"!=t.boundingBoxMode){let e={stroke:this.viewOptions.boundingBoxColor,strokeWidth:1,strokeLineCap:"square",strokeDashArray:[10,10],fill:!1,selectable:!1,evented:!1,name:"bounding-box",excludeFromExport:!0,_ignore:!0,rx:n.borderRadius,ry:n.borderRadius};e=z(e,this.viewOptions.boundingBoxProps),t.clipPath&&"rect"!=t.clipPath.type?t.clipPath&&t.clipPath.clone((n=>{e=z(e,{fill:"transparent"}),n.set(e),"group"==n.type&&n.forEachObject((t=>{t.set("fill","transparent")})),this.currentBoundingObject=n,i(this.currentBoundingObject),t._checkContainment()})):(e=z(e,{left:n.left,top:n.top,width:n.width,height:n.height,angle:n.angle||0,originX:"left",originY:"top"}),this.currentBoundingObject=new St.fabric.Rect(e),i(this.currentBoundingObject))}t._checkContainment()}},St.fabric.Canvas.prototype._renderPrintingBox=function(){if(this.printingBoxObject&&(this.remove(this.printingBoxObject),this.printingBoxObject=null),H(this.viewOptions.printingBox,["left","top","width","height"])){const t=this.viewOptions.printingBox.width,e=this.viewOptions.printingBox.height,i=1,n=this.viewOptions.printingBox.visibility||this.viewOptions.editorMode,s=new St.fabric.Rect({width:t+i,height:e+i,stroke:n?"#db2828":"transparent",strokeWidth:i,strokeLineCap:"square",fill:!1,originX:"left",originY:"top",name:"printing-box",visible:!this.printMode});this.printingBoxObject=new St.fabric.Group([s],{left:this.viewOptions.printingBox.left-i,top:this.viewOptions.printingBox.top-i,evented:!1,resizable:!0,removable:!1,copyable:!1,rotatable:!1,uniformScaling:!1,lockRotation:!0,borderColor:"transparent",transparentCorners:!0,cornerColor:this.viewOptions.selectedColor,cornerIconColor:this.viewOptions.cornerIconColor,cornerSize:24,originX:"left",originY:"top",name:"printing-boxes",excludeFromExport:!this.printMode,selectable:!1,_ignore:!0});const r=this.viewOptions?.output?.bleed;if(r&&this.viewOptions.innerBleed&&n){const n=this.viewOptions.printingBox.width/this.viewOptions.output.width*r,a=t-n,o=e-n,l=new St.fabric.Rect({left:s.left,top:s.top,width:a+i,height:o+i,stroke:"#db2828",strokeWidth:n,opacity:.2,strokeLineCap:"square",fill:!1,originX:"left",originY:"top",name:"bleed-box",visible:!this.printMode});this.printingBoxObject.add(l);const c=[4,4],h="#000000",d=[new St.fabric.Line([.5*-t,.5*-e+n-1,.5*-t+n,.5*-e+n-1],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*-t+n-1,.5*-e,.5*-t+n-1,.5*-e+n],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*t,.5*-e+n-1,.5*t-n,.5*-e+n-1],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*t-n,.5*-e,.5*t-n,.5*-e+n],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*-t,.5*e-n,.5*-t+n,.5*e-n],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*-t+n-1,.5*e,.5*-t+n-1,.5*e-n],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*t,.5*e-n,.5*t-n,.5*e-n],{stroke:h,strokeDashArray:c}),new St.fabric.Line([.5*t-n,.5*e,.5*t-n,.5*e-n],{stroke:h,strokeDashArray:c})],u=new St.fabric.Group(d,{evented:!1,selectable:!1,name:"crop-marks"});this.printingBoxObject.add(u)}this.add(this.printingBoxObject),this.printingBoxObject.setCoords(),this.renderAll()}},St.fabric.Canvas.prototype._bringToppedElementsToFront=function(){let t=this.getObjects(),e=[];t.forEach((t=>{(t.topped||t.uploadZone&&this.viewOptions.uploadZonesTopped)&&e.push(t)})),e.forEach((t=>{t.bringToFront()})),this.currentBoundingObject&&this.currentBoundingObject.bringToFront(),this.printingBoxObject&&this.printingBoxObject.bringToFront()},St.fabric.Canvas.prototype.addElements=function(t,e){let i=-1;const n=()=>{if(i++,i<t.length){const e=t[i];s(e)||this.addElement(e.type,e.source,e.title,e.parameters)}else this.off("elementAdd",n),void 0!==e&&e.call(e,this),this.initialElementsLoaded=!0},s=e=>{if(void 0===e.type||void 0===e.source||void 0===e.title){const i=t.indexOf(e);if(-1!==i)return console.log("Element index "+i+" from elements removed, its not a valid element object!","info"),n(),!0}else this.elements.push(e);return!1};t[0]?(this.on("elementAdd",n),n()):(void 0!==e&&e.call(e,this),this.initialElementsLoaded=!0)},St.fabric.Canvas.prototype.addElement=function(t,e,i){var n=this;let s,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(void 0===t||void 0===e||void 0===i)return;if(Q(i)&&(i=Date.now().toString()),this.fire("beforeElementAdd",{type:t,source:e,title:i,params:r}),"text"===t&&(e=(e=e.replace(/(<([^>]+)>)/gi,"")).replace(this.forbiddenTextChars,""),i=i.replace(/(<([^>]+)>)/gi,"")),r.colorLinkGroup){let t=this.getElements();if(t){const e=t.find((t=>t.colorLinkGroup===r.colorLinkGroup));e&&e.fill&&(r.fill=e.fill)}}if("string"==typeof r.fill||Array.isArray(r.fill)||(r.fill=!1),s=t.toLowerCase().includes("text")?z(this.viewOptions.elementParameters,this.viewOptions.textParameters):z(this.viewOptions.elementParameters,this.viewOptions.imageParameters),r=z(s,r),r.colors&&"string"==typeof r.colors&&0==r.colors.indexOf("#")){var a=r.colors.replace(/\s+/g,"").split(",");r.colors=a}if(r._isInitial=!this.initialElementsLoaded,t.toLowerCase().includes("text")){var l=r.colors[0]?r.colors[0]:"#000000";r.fill=r.fill?r.fill:l}let c={source:e,title:i,id:String((new Date).getTime())};this.viewOptions.editorMode?(r.__editorMode=this.viewOptions.editorMode,c.selectable=c.evented=!0):c=z(c,{selectable:!1,lockRotation:!0,hasRotatingPoint:!1,lockScalingX:!0,lockScalingY:!0,lockMovementX:!0,lockMovementY:!0,hasControls:!1,evented:!1,lockScalingFlip:!0}),c=z(r,c),c.isCustom&&("engraving"==W(this.viewOptions,"industry.type")&&(c.opacity=W(this.viewOptions,"industry.opts.opacity",.5)),this.isCustomized=!0);let h=!1;if(("string"==typeof c.boundingBox&&c.boundingBox.length>0||"object"==typeof c.boundingBox&&H(c.boundingBox,["width","height"])&&c.boundingBox.width>0&&c.boundingBox.height>0)&&(h=!0),this.viewOptions.usePrintingBoxAsBounding&&!h&&H(this.viewOptions.printingBox,["left","top","width","height"])&&(c.boundingBox={x:this.viewOptions.printingBox.left-1,y:this.viewOptions.printingBox.top-1,width:this.viewOptions.printingBox.width+1,height:this.viewOptions.printingBox.height+1},c._printingBox=c.boundingBox),"image"==t||"path"==t||"group"==t){if(-1===e.search("<svg ")){var d=e.split("?");e=c.source=d[0]}const t=function(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t?(e.originParams=z(e,s),t.setOptions(e),n.add(t),n.setElementOptions(e,t),t.originParams.angle=t.angle,t.originParams.z=t.getZIndex()):n.fire("imageFail",{url:e.source}),n.fire("elementAdd",{element:t})};if(void 0===e||0===e.length)return void console.log("No image source set for: "+i);const s=(t,e,i)=>{if(t.fill)t.svgFill||(t.svgFill=t.fill);else if(!t.fill&&!t.svgFill){if(i){e.colors=[];for(var n=0;n<i.length;++n){var s=i[n].fill.length>0?o(i[n].fill).toHexString():"transparent";e.colors.push(s)}e.svgFill=e.colors}t.svgFill=e.svgFill}return t};if(-1!==e.search("<svg"))St.fabric.loadSVGFromString(e,((e,i)=>{var n=St.fabric.util.groupSVGElements(e,i);c=s(c,r,e),delete c.boundingBox,delete c.originParams,delete c.width,delete c.height,delete c.originX,delete c.originY,delete c.objectCaching,t(n,c,!0,{svgFill:r.svgFill})}));else if(e.split(".").includes("svg")){let i=Date.now().toString(),n=V(e)?new URL(this.proxyFileServer+e):e;!e.includes(".cloudfront.net/")&&!this.viewOptions.imageLoadTimestamp||this.proxyFileServer||n.searchParams.append("t",i),"object"==typeof n&&(n=n.toString()),St.fabric.loadSVGFromURL(n,((e,i)=>{var n=e?St.fabric.util.groupSVGElements(e,i):null;c=s(c,r,e),t(n,c,!0,{svgFill:r.svgFill})}))}else{let i,n=Date.now().toString();e.includes("data:image/")?i=e:(i=V(e)?new URL(this.proxyFileServer+e):e,this.viewOptions.imageLoadTimestamp&&!this.proxyFileServer&&i.searchParams.append("t",n),"object"==typeof i&&(i=i.toString())),new St.fabric.Image.fromURL(i,(function(e){e=""===e.getSrc()?null:e,t(e,c,!1)}),{crossOrigin:"anonymous"})}}else if(t.toLowerCase().includes("text")){var u;e=e.replace(/\\n/g,"\n"),r.text=r.text?r.text:e,c._initialText=r.hasOwnProperty("_initialText")?r._initialText:r.text,c.originParams={...r},r.originParams&&r.originParams.text&&(c.originParams.text=c._initialText),u=r.curved?new St.fabric.CurvedText(e.replace(/(?:\r\n|\r|\n)/g,""),c):r.textBox?new St.fabric.Textbox(e,{...c,splitByGrapheme:!0}):r.neonText?new St.fabric.NeonText(e,c):new St.fabric.IText(e,c),(c.textPlaceholder||c.numberPlaceholder)&&(this[c.textPlaceholder?"textPlaceholder":"numberPlaceholder"]=u),this.add(u),this.setElementOptions(c,u),u.originParams=z(u.toJSON(),u.originParams),u.originParams.z=u.getZIndex(),this.fire("elementAdd",{element:u})}},St.fabric.Canvas.prototype.deselectElement=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.currentBoundingObject&&(this.remove(this.currentBoundingObject),this.fire("boudingBoxToggle",{boundingBox:this.currentBoundingObject,state:!1}),this.currentBoundingObject=null),t&&this.discardActiveObject(),this.currentElement=null,this.fire("elementSelect",{element:null})},St.fabric.Canvas.prototype.resetSize=function(){if(!this.wrapperEl||!this.wrapperEl.parentNode)return;const t=this.wrapperEl.parentNode.clientWidth;let e=window.innerHeight*parseFloat(this.viewOptions.maxCanvasHeight||1),i=this.viewOptions.stageHeight,n=null;this.responsiveScale=t<this.viewOptions.stageWidth?t/this.viewOptions.stageWidth:1;let s=i*this.responsiveScale;return this.viewOptions.canvasHeight&&"auto"!==this.viewOptions.canvasHeight&&this.viewOptions.canvasHeight.includes("px")&&(n=parseInt(this.viewOptions.canvasHeight),e=n),s>e&&(this.responsiveScale=e/i),this.responsiveScale=parseFloat(Number(this.responsiveScale.toFixed(7))),this.responsiveScale=Math.min(this.responsiveScale,1),this.viewOptions.responsive||(this.responsiveScale=1),this.setDimensions({width:this.viewOptions.stageWidth*this.responsiveScale,height:this.viewOptions.stageHeight*this.responsiveScale}).setZoom(this.responsiveScale).calcOffset().renderAll(),this.fire("sizeUpdate",{responsiveScale:this.responsiveScale,canvasHeight:n||i*this.responsiveScale||i}),this.responsiveScale},St.fabric.Canvas.prototype.setResZoom=function(t){this.deselectElement();var e=new St.fabric.Point(.5*this.getWidth(),.5*this.getHeight());this.zoomToPoint(e,t*this.responsiveScale),1==t&&this.resetZoom()},St.fabric.Canvas.prototype.resetZoom=function(){this.deselectElement(),this.zoomToPoint(new St.fabric.Point(0,0),this.responsiveScale),this.absolutePan(new St.fabric.Point(0,0))},St.fabric.Canvas.prototype.getElements=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.deselectElement();let e=this.getObjects();return e=e.filter((t=>!t._ignore)),"text"===t?e.filter((t=>"text"===t.getType())):"image"===t?e.filter((t=>"image"===t.getType())):e},St.fabric.Canvas.prototype.getElementsJSON=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getElements("all",e),n=[];return i.forEach((e=>{if(void 0!==e.title&&void 0!==e.source){var i={title:e.title,source:e.source,parameters:e.getElementJSON(),type:e.getType()};const s=this.viewOptions&&this.viewOptions.printingBox?this.viewOptions.printingBox:null;if(s&&s.hasOwnProperty("left")&&s.hasOwnProperty("top")){let t=e.getPointByOrigin("left","top");i.printingBoxCoords={left:t.x-s.left,top:t.y-s.top}}t?e.isEditable&&n.push(i):n.push(i)}})),n},St.fabric.Canvas.prototype.getElementByTitle=function(t){const e=this.getObjects();for(var i=0;i<e.length;++i)if(e[i].title===t)return e[i]},St.fabric.Canvas.prototype.getElementByID=function(t){const e=this.getObjects();for(var i=0;i<e.length;++i)if(e[i].id==t)return e[i];return!1},St.fabric.Canvas.prototype.reset=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.clear(),t&&this.wrapperEl.remove(),this.fire("clear")},St.fabric.Canvas.prototype.removeElement=function(t){"string"==typeof t&&(t=this.getElementByTitle(t)),this.deselectElement(),t.toggleUploadZone&&t.toggleUploadZone(),this.remove(t),this.fire("elementRemove",{element:t})},St.fabric.Canvas.prototype.getElementByReplace=function(t){const e=this.getObjects();for(var i=0;i<e.length;++i){const n=e[i];if(n.replace===t)return n}return null},St.fabric.Canvas.prototype.setElementOptions=function(t,e){if(!(e=void 0===e?this.getActiveObject():e)||void 0===t)return!1;"string"==typeof e&&(e=this.getElementByTitle(e));const i=e.getType();if(void 0!==t.scale&&(t.scaleX=t.scaleY=Number(t.scale)),"image"==i&&!e._isInitial&&!e._optionsSet&&!e._addToUZ&&1===e.scaleX){let i=null;if(Y(e.resizeToW)&&Y(e.resizeToH)){if(e.boundingBox){const t=e.getBoundingBoxCoords();i=kt(e.width,e.height,t.width,t.height,e.scaleMode)}else if(this.viewOptions.fitImagesInCanvas&&e.isCustom){const t=3*e.cornerSize;(e.width*e.scaleX+t>this.viewOptions.stageWidth||e.height*e.scaleY+t>this.viewOptions.stageHeight)&&(i=kt(e.width,e.height,this.viewOptions.stageWidth-t,this.viewOptions.stageHeight-t))}}else{let t=e.resizeToW,n=e.resizeToH;t=isNaN(t)?parseFloat(t)/100*this.viewOptions.stageWidth:parseInt(t),n=isNaN(n)?parseFloat(n)/100*this.viewOptions.stageHeight:parseInt(n),i=kt(e.width,e.height,t,n,e.scaleMode)}null!==i&&(t=z(t,{scaleX:i,scaleY:i}))}if(Boolean(e._addToUZ)){t.z=-1;let i=this.getElementByTitle(e._addToUZ),n=1;"image"==e.getType()&&(n=kt(e.width,e.height,i.width*i.scaleX,i.height*i.scaleY,i.scaleMode)),(t=z(t,{boundingBox:e._addToUZ,boundingBoxMode:"clipping",scaleX:n,scaleY:n,autoCenter:!0,removable:!0,zChangeable:!1,autoSelect:!1,copyable:!1,hasUploadZone:!0,z:this.getElementByTitle(e._addToUZ).getZIndex(),rotatable:i.rotatable,draggable:i.draggable,resizable:i.resizable,price:i.price?i.price:t.price,replace:e._addToUZ,lockUniScaling:i.lockUniScaling,uniScalingUnlockable:i.uniScalingUnlockable,advancedEditing:i.advancedEditing,originX:i.originX,originY:i.originY,angle:i.angle})).originParams=z(t.originParams,{boundingBox:t.boundingBox,replace:t.replace,rotatable:t.rotatable,draggable:t.draggable,resizable:t.resizable,lockUniScaling:t.lockUniScaling,uniScalingUnlockable:t.uniScalingUnlockable,price:t.price,scaleX:t.scaleX,scaleY:t.scaleY,hasUploadZone:!0,autoCenter:!0,originX:t.originX,originY:t.originY,angle:t.angle}),delete t[""],delete e._addToUZ}if(t.topped&&(t.zChangeable=!1),e.checkEditable(t)&&(t.isEditable=t.evented=t.selectable=!0),t.uploadZone&&!this.viewOptions.editorMode||(t.draggable&&(t.lockMovementX=t.lockMovementY=!1),t.rotatable&&(t.lockRotation=!1,t.hasRotatingPoint=!0),t.resizable&&(t.lockScalingX=t.lockScalingY=!1),(t.resizable||t.rotatable||t.removable)&&(t.hasControls=!0)),t.uploadZone&&(this.viewOptions.editorMode||(t.uploadZoneMovable&&(t.lockMovementX=t.lockMovementY=!1),t.uploadZoneRemovable&&(t.removable=!0,t.copyable=!1,t.hasControls=!0)),t.borderColor="transparent",t.excludeFromExport=!0),t.fixed&&Q(t.replace)&&(t.replace=e.title),!this.viewOptions.editorMode&&t.replace&&""!=t.replace){let i=this.getElementByReplace(t.replace);if(null!==i&&i!==e){if(t.z=i.getZIndex(),t.left=e.originParams.left=i.left,t.top=e.originParams.top=i.top,t.autoCenter=!1,this.viewOptions.applySizeWhenReplacing){const n=i.getScaledWidth()/e.getScaledWidth();t.scaleX=e.originParams.scaleX=n,t.scaleY=e.originParams.scaleY=n}this.viewOptions.applyFillWhenReplacing&&!e._isQrCode&&(t.fill=t.svgFill=i.fill),this.removeElement(i)}}if("text"===i){if("string"==typeof t.text){let i=t.text;if(i=i.replace(this.forbiddenTextChars,""),0!=e.maxLength&&i.length>e.maxLength&&(i=i.substr(0,e.maxLength),e.set("text",i)),0!=e.maxLines&&0!=e.maxLines&&i.split("\n").length>e.maxLines){let t=i.split("\n").slice(0,e.maxLines);i=t.join("\n")}"uppercase"===e.textTransform?i=i.toUpperCase():"lowercase"===e.textTransform&&(i=i.toLowerCase()),e.curved&&(i=i.replace(/[\n\r\t]/gm,"")),t.text=i}if(t.hasOwnProperty("textDecoration")&&(t.underline="underline"===t.textDecoration),void 0!==t.letterSpacing&&(t.charSpacing=100*t.letterSpacing),t.fontSize&&t.fontSize<e.minFontSize?t.fontSize=e.minFontSize:t.fontSize&&t.fontSize>e.maxFontSize&&(t.fontSize=e.maxFontSize),t.textTransform){let i=e.text;"uppercase"===t.textTransform?i=i.toUpperCase():"lowercase"===t.textTransform&&(i=i.toLowerCase()),t.text=i}}if(t.hasOwnProperty("shadowColor")||t.hasOwnProperty("shadowBlur")||t.hasOwnProperty("shadowOffsetX")||t.hasOwnProperty("shadowOffsetY")&&!e.neonText)if(null===t.shadowColor)e.set("shadow",null);else{let i={};e.shadow&&(i=e.shadow.toObject());let n={color:t.hasOwnProperty("shadowColor")?t.shadowColor:i.color,blur:t.hasOwnProperty("shadowBlur")?t.shadowBlur:i.blur,offsetX:t.hasOwnProperty("shadowOffsetX")?t.shadowOffsetX:i.offsetX,offsetY:t.hasOwnProperty("shadowOffsetY")?t.shadowOffsetY:i.offsetY};e.set("shadow",n)}if(delete t.paths,e.setOptions(t),(t.fontSize||t.fontFamily||t.letterSpacing)&&e.updateTextPosition&&e.updateTextPosition(),"i-text"==e.type&&e.widthFontSize&&e.text.length>0){let t;t=e.width>e.widthFontSize?e.fontSize*(e.widthFontSize/(e.width+1)):e.fontSize*(e.widthFontSize/(e.width-1)),t<e.minFontSize?t=e.minFontSize:t>e.maxFontSize&&(t=e.maxFontSize),t=parseInt(t),e.set("fontSize",t)}if(e.updateTextPosition&&e.updateTextPosition(),t.autoCenter&&e.centerElement(),t.hasOwnProperty("lockUniScaling")&&e._elementControls(),t.filter){const i=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t)switch(t=t.toLowerCase()){case"grayscale":return new St.fabric.Image.filters.Grayscale;case"sepia":return new St.fabric.Image.filters.Sepia;case"kodachrome":return new St.fabric.Image.filters.Kodachrome;case"black_white":return new St.fabric.Image.filters.BlackWhite;case"vintage":return new St.fabric.Image.filters.Vintage;case"technicolor":return new St.fabric.Image.filters.Technicolor;case"brightness":return new St.fabric.Image.filters.Brightness(e);case"contrast":return new St.fabric.Image.filters.Contrast(e);case"removewhite":return new St.fabric.Image.filters.RemoveColor(e)}else if(Array.isArray(t))return new St.fabric.Image.filters.ColorMatrix({matrix:t});return null}(t.filter);i&&e.applyFilters?(e.filters=[i],e.applyFilters()):e.applyFilters&&(e.filters=[],e.applyFilters())}if(void 0!==t.fill||void 0!==t.svgFill){const i=void 0!==t.svgFill?t.svgFill:t.fill;e.changeColor(i),e.pattern=void 0}if(void 0!==t.pattern&&e.setPattern(t.pattern),e.canvas&&t.z>=0&&(e.moveTo(t.z),this._bringToppedElementsToFront()),t.hasOwnProperty("curved"))if(t.curved){if("i-text"==e.type||"textbox"==e.type){let t=e.getElementJSON();return delete t.width,this.addElement("text",t.text,e.title,t),void this.removeElement(e)}e.setTextPath(),e==this.getActiveObject()&&e.path&&(e.path.visible=!0),e.textAlign="left",e.set("text",e.text.replace(/[\r\n]+/g,"")),e.updateTextPosition()}else e.set("path",null);t.hasOwnProperty("curveRadius")&&e.setTextPath&&(e.setTextPath(),e==this.getActiveObject()&&e.path&&(e.path.visible=!0)),e.uploadZone?e.evented=0!==e.opacity:e.isEditable&&!this.viewOptions.editorMode&&(e.evented=!t.locked),(e.textPlaceholder||e.numberPlaceholder)&&(e.removable=!1);for(var n=this.getObjects(),s=0;s<n.length;++s){var r=n[s];r.uploadZone&&r.title==t.replace&&(r.opacity=0,r.evented=!1)}e.setCoords(),this.renderAll().calcOffset(),this.fire("elementModify",{element:e,options:t}),e._checkContainment(),this._doHistory&&this.historySaveAction(),t.autoSelect&&e.isEditable&&!this.editorMode&&this.wrapperEl.offsetParent&&setTimeout((()=>{this.setActiveObject(e),this.renderAll()}),200),e._optionsSet=!0},St.fabric.Canvas.prototype.duplicateElement=function(t){var e=t.getElementJSON();e.top=e.top+30,e.left=e.left+30,this.viewOptions.editorMode||(e.autoSelect=!0),this.addElement(t.getType(),t.source,"Copy "+t.title,e)},St.fabric.Canvas.prototype.getUploadZone=function(t){const e=this.getObjects();for(var i=0;i<e.length;++i)if(e[i].uploadZone&&e[i].title==t)return e[i]},St.fabric.Canvas.prototype.setMask=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(t&&t.url&&t.url.includes(".svg")){const i=this.proxyFileServer+t.url;this.maskOptions=t,St.fabric.loadSVGFromURL(i,((i,n)=>{let s=null;i&&(s=i?St.fabric.util.groupSVGElements(i,n):null,s.setOptions({left:t.left?Number(t.left):0,top:t.top?Number(t.top):0,scaleX:t.scaleX?Number(t.scaleX):1,scaleY:t.scaleY?Number(t.scaleY):1,selectable:!0,evented:!1,resizable:!0,lockUniScaling:!1,lockRotation:!0,borderColor:"transparent",fill:"rgba(0,0,0,0)",transparentCorners:!0,cornerColor:this.viewOptions.selectedColor,cornerIconColor:this.viewOptions.cornerIconColor,cornerSize:24,originX:"left",originY:"top",name:"view-mask",objectCaching:!1,excludeFromExport:!0,_ignore:!0}),this.maskObject=s,this.clipPath=s,this.resetSize()),e(s)}))}else this.maskObject=this.maskOptions=this.clipPath=null,this.renderAll(),e(null)};var Pt=i(933),_t=i.n(Pt);const Dt=t=>{let e="";if(t.hasOwnProperty("url")){let i=t.name,n=-1!==t.url.search(".woff")?"woff":"TrueType",s=FancyProductDesigner.proxyFileServer+t.url;if(i+=":n4",e+='@font-face {font-family:"'+t.name+'"; font-style: normal; font-weight: normal; src:url("'+s+'") format("'+n+'");}\n',t.variants){for(const i in t.variants){let r={n7:"font-style: normal; font-weight: bold;",i4:"font-style: italic; font-weight: normal;",i7:"font-style: italic; font-weight: bold;"};s=FancyProductDesigner.proxyFileServer+t.variants[i],e+='@font-face {font-family:"'+t.name+'"; '+r[i]+' src:url("'+s+'") format("'+n+'");}\n'}i+=","+Object.keys(t.variants).toString()}}return e},Lt=(t,e)=>{let i=t.mainOptions.fonts;if(i&&i.length>0&&"object"==typeof i[0]){i.sort(((t,e)=>{let i=t.name.toUpperCase(),n=e.name.toUpperCase();return i<n?-1:i>n?1:0}));let r=[],a=[],o=0;const l=document.createElement("style");l.id="fpd-fonts",t.container.before(l),i.forEach((t=>{if(t.hasOwnProperty("url"))if("google"==t.url)r.push(t.name+":400,400i,700,700i");else{let e=t.name;e+=":n4",t.variants&&(e+=","+Object.keys(t.variants).toString()),a.push(e),l.append(Dt(t))}}));var n=function(t,n,s){"inactive"==t&&console.log(n+" font could not be loaded."),o==r.length+a.length-1&&e(i),o++},s={fontactive:function(t,e){n("active",t)},fontinactive:function(t,e){n("inactive",t)},timeout:3e3};r.length>0&&(s.google={families:r}),a.length>0&&(s.custom={families:a}),r.length>0||a.length>0?_t().load(s):e(i)}else e(i)};function Bt(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function jt(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ft(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Rt=new WeakSet,Nt=new WeakSet;class Ht extends EventTarget{constructor(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),Bt(this,Nt),Bt(this,Rt),jt(this,"totalPrice",0),jt(this,"truePrice",0),jt(this,"additionalPrice",0),jt(this,"locked",!1),jt(this,"mask",null),jt(this,"viewData",void 0),jt(this,"onCreatedCallback",void 0),jt(this,"title",void 0),jt(this,"thumbnail",void 0),jt(this,"options",void 0),jt(this,"names_numbers",void 0),jt(this,"canvasElem",null),jt(this,"fabricCanvas",null),jt(this,"elementsAdded",!1),this.viewData=i,this.onCreatedCallback=n,this.title=i.title,this.thumbnail=i.thumbnail,this.options=i.options,this.mask=i.mask,this.locked=void 0!==i.locked?i.locked:this.options.optionalView,this.names_numbers=i.names_numbers?i.names_numbers:null,fabric.Canvas.prototype.snapGridSize=this.options.snapGridSize,fabric.Canvas.prototype.snapToObjects=this.options.smartGuides;const r=this.options.selectedColor;fabric.Object.prototype.borderColor=r,fabric.Object.prototype.cornerColor=r,fabric.Object.prototype.cornerIconColor=this.options.cornerIconColor,s=z({containerClass:"fpd-view-stage fpd-hidden",selection:this.options.multiSelection,selectionBorderColor:this.options.multiSelectionColor,selectionColor:o(this.options.multiSelectionColor).setAlpha(.1).toRgbString(),hoverCursor:"pointer",controlsAboveOverlay:!0,centeredScaling:!0,allowTouchScrolling:!0,preserveObjectStacking:!0,enablePointerEvents:!1},s),this.fabricOptions=s,this.canvasElem=document.createElement("canvas"),e.append(this.canvasElem),fabric.Canvas.prototype.forbiddenTextChars=FancyProductDesigner.forbiddenTextChars,fabric.Canvas.prototype.proxyFileServer=FancyProductDesigner.proxyFileServer,this.fabricCanvas=new fabric.Canvas(this.canvasElem,s),this.fabricCanvas.viewOptions=this.options,this.fabricCanvas.setDimensions({width:this.options.stageWidth,height:this.options.stageHeight}),this.fabricCanvas.on({imageFail:e=>{let{url:i}=e;t(`\n                    <p>The image with the URL<br /><i style='font-size: 10px;'>${i}</i><br />can not be loaded into the canvas.</p>\n                    <p><b>Troubleshooting</b>\n                        <ul>\n                            <li>The URL is not correct!</li>\n                            <li>The image has been blocked by <a href='https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS' target='_blank'>CORS policy</a>. You need to host the image under the same protocol and domain or enable 'Access-Control-Allow-Origin' on the server where you host the image. <a href='http://enable-cors.org/' target='_blank'>Read more about it here.</a><\n                            /li>\n                        </ul>\n                    </p>\n                `)}}),this.toggleLock(Boolean(this.locked));const a=t=>{t.chargeAfterEditing&&(t._isPriced||(this.changePrice(t.price,"+"),t._isPriced=!0),t._initialText===t.text&&t._isPriced&&(this.changePrice(t.price,"-"),t._isPriced=!1))};this.fabricCanvas.on({"object:added":t=>{let e=t.target,i=e.price;if(e._addToUZ&&""!=e._addToUZ){var n=this.fabricCanvas.getElementByTitle(e._addToUZ);i=n&&n.price?n.price:i}void 0===i||0===i||e.uploadZone||e._ignore||e.chargeAfterEditing&&!e._isPriced||this.changePrice(i,"+")},"object:removed":t=>{const e=t.target;void 0===e.price||0===e.price||e.uploadZone||e.chargeAfterEditing&&!e._isPriced||this.changePrice(e.price,"-")},"text:changed":t=>{a(t.target)},elementModify:t=>{this.elementsAdded&&t.options.hasOwnProperty("text")&&a(t.element)},elementFillChange:t=>{Ft(this,Nt,Wt).call(this,t.element)}})}init(){this.loadElements(this.viewData.elements,Ft(this,Rt,zt).bind(this))}loadElements(t,e){this.fabricCanvas.initialElementsLoaded&&this.fabricCanvas.reset(!1),this.fabricCanvas.offHistory(),this.fabricCanvas.addElements(t,e)}toDataURL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=void 0===t?function(){}:t,e.onlyExportable=void 0!==e.onlyExportable&&e.onlyExportable,e.multiplier=void 0===e.multiplier?1:e.multiplier,e.backgroundColor=void 0===e.backgroundColor?"transparent":e.backgroundColor,e.watermarkImg=void 0===e.watermarkImg?null:e.watermarkImg;let n=[],s=this.options.highlightEditableObjects;this.options.highlightEditableObjects="transparent",this.fabricCanvas.getObjects().forEach((t=>{t.excludeFromExport&&e.onlyExportable&&(t.visible=!1,n.push(t))})),i&&this.fabricCanvas.deselectElement(),this.fabricCanvas.setDimensions({width:this.options.stageWidth,height:this.options.stageHeight}).setZoom(1),this.fabricCanvas.setBackgroundColor(e.backgroundColor,(()=>{e.watermarkImg&&(this.fabricCanvas.add(e.watermarkImg),e.watermarkImg.center(),e.watermarkImg.bringToFront()),t(this.fabricCanvas.toDataURL(e)),e.watermarkImg&&this.fabricCanvas.remove(e.watermarkImg),this.fabricCanvas.wrapperEl.offsetParent&&this.fabricCanvas.resetSize(),this.fabricCanvas.setBackgroundColor("transparent",(()=>{this.fabricCanvas.renderAll()}));for(var i=0;i<n.length;++i)n[i].visible=!0;this.fabricCanvas.renderAll(),this.options.highlightEditableObjects=s}))}toSVG(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.respectPrintingBox=void 0!==e.respectPrintingBox&&e.respectPrintingBox,e.watermarkImg=void 0===e.watermarkImg?null:e.watermarkImg,this.fabricCanvas.deselectElement(),e.respectPrintingBox&&H(this.options.printingBox,["left","top","width","height"])){let t=0,i=0;H(this.options.output,["bleed","width","height"])&&(t=this.options.output.bleed/this.options.output.width*this.options.printingBox.width,i=this.options.output.bleed/this.options.output.height*this.options.printingBox.height),e.viewBox={x:this.options.printingBox.left-t,y:this.options.printingBox.top-i,width:this.options.printingBox.width+2*t,height:this.options.printingBox.height+2*i},this.fabricCanvas.setDimensions({width:this.options.printingBox.width,height:this.options.printingBox.height}).setZoom(1)}else this.fabricCanvas.setDimensions({width:this.options.stageWidth,height:this.options.stageHeight}).setZoom(1);let n=this.fabricCanvas.backgroundColor;"transparent"==n&&(this.fabricCanvas.backgroundColor=!1),e.watermarkImg&&(this.fabricCanvas.add(e.watermarkImg),e.watermarkImg.center(),e.watermarkImg.bringToFront()),t=this.fabricCanvas.toSVG(e,e.reviver),e.watermarkImg&&this.fabricCanvas.remove(e.watermarkImg),this.fabricCanvas.backgroundColor=n,this.fabricCanvas.wrapperEl.offsetParent&&this.fabricCanvas.resetSize();const s=document.createElement("div");s.innerHTML=t;const r=s.querySelector("defs");s.querySelectorAll("clipPath").forEach((t=>{r.appendChild(t)}));const a=document.createElement("style");let o="",l="";i.forEach((t=>{t.hasOwnProperty("url")&&("google"==t.url?o+=t.name.replace(/\s/g,"+")+":ital,wght@0,400;0,700;1,700&":l+=Dt(t))})),o.length>0&&a.insertAdjacentHTML("beforeend",'@import url("https://fonts.googleapis.com/css2?family='+o.replace(/&/g,"&amp;")+'display=swap");'),l.length>0&&a.insertAdjacentHTML("beforeend",l),r.appendChild(a);let c=s.innerHTML;return c=c.replace(/(?:\r\n|\r|\n)/g,""),c}toggleLock(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.locked=t,J(this.fabricCanvas.wrapperEl,["fpd-disabled"],t),this.dispatchEvent(new CustomEvent("priceChange",{detail:{elementPrice:0,truePrice:this.truePrice}})),t}changePrice(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("number"!=typeof t&&(t=Number(t)),"+"===e?this.totalPrice+=t:this.totalPrice-=t,null!==i){let t=this.additionalPrice;this.totalPrice-=t,this.additionalPrice=i,this.totalPrice+=i}return this.truePrice=this.totalPrice,"number"==typeof this.options.maxPrice&&-1!=this.options.maxPrice&&this.truePrice>this.options.maxPrice&&(this.truePrice=Number(this.options.maxPrice)),this.truePrice%1!=0&&(this.truePrice=Number(this.truePrice.toFixed(2))),this.dispatchEvent(new CustomEvent("priceChange",{detail:{elementPrice:t,truePrice:this.truePrice}})),this.truePrice}}function zt(){this.elementsAdded=!0,this.fabricCanvas._doHistory=!0,this.mask&&this.fabricCanvas.setMask(this.mask),this.onCreatedCallback&&this.onCreatedCallback(this),this.dispatchEvent(new CustomEvent("priceChange",{detail:{elementPrice:0,truePrice:this.truePrice}}))}function Wt(t){if(this.elementsAdded&&t.colorPrices&&"object"==typeof t.colors&&t.colors.length>1){void 0!==t.currentColorPrice&&(t.price-=t.currentColorPrice,this.changePrice(t.currentColorPrice,"-"));const n=t.fill;if("string"==typeof n){var e=n.replace("#","");if(t.colorPrices.hasOwnProperty(e)||t.colorPrices.hasOwnProperty(e.toUpperCase())){var i=void 0===t.colorPrices[e]?t.colorPrices[e.toUpperCase()]:t.colorPrices[e];t.currentColorPrice=i,t.price+=t.currentColorPrice,this.changePrice(t.currentColorPrice,"+")}else t.currentColorPrice=0}else t.currentColorPrice=0}}jt(Ht,"relevantOptions",["stageWidth","stageHeight","selectedColor","boundingBoxColor","outOfBoundaryColor","cornerIconColor","customAdds","elementParameters","imageParameters","textParameters","customImageParameters","customTextParameters","maxPrice","optionalView","designCategories","printingBox","output","layouts","usePrintingBoxAsBounding","threeJsPreviewModel","editorMode","imageLoadTimestamp","fitImagesInCanvas","inCanvasTextEditing","applyFillWhenReplacing","disableTextEmojis","cornerControlsStyle","responsive","canvasHeight","maxCanvasHeight","boundingBoxProps","highlightEditableObjects","multiSelection","multiSelectionColor","mobileGesturesBehaviour","smartGuides","snapGridSize","rulerUnit","namesNumbersEntryPrice","applySizeWhenReplacing","rulerPosition","rulerFixed","industry","innerBleed"]),window.FancyProductDesigner=Ht;const Vt=t=>{let e=t.url;t.params&&(e+="?"+new URLSearchParams(t.params).toString());const i=new XMLHttpRequest;return i.responseType="json",i.open("GET",e),i.onreadystatechange=e=>{4==i.readyState&&200==i.status?t.onSuccess&&t.onSuccess(i.response):200!==i.status&&t.onError&&t.onError(i)},i.send(),i},Ut=t=>{let e=t.url,i={Accept:"application/json"};return t.body instanceof FormData||(i["Content-Type"]="application/json"),fetch(e,{method:"POST",redirect:"follow",headers:i,body:t.body instanceof FormData?t.body:JSON.stringify(t.body)}).then((t=>t.json())).then((e=>{t.onSuccess&&t.onSuccess(e)})).catch((e=>{t.onError&&t.onError(e)}))};class Yt extends EventTarget{langJSON=null;constructor(){super()}loadLangJSON(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};!1!==t?"object"==typeof t?(this.langJSON=t,e.call(this)):Vt({url:t,onSuccess:t=>{this.langJSON=t,e.call(this)},onError:i=>{alert('Language JSON "'+t+'" could not be loaded or is not valid. Make sure you set the correct URL in the options and the JSON is valid!'),e.call(this)}}):e.call(this)}translateElement(t){let e="";if(this.langJSON){let i="";if(i=t.getAttribute("placeholder")?t.getAttribute("placeholder"):t.getAttribute("title")?t.getAttribute("title"):t.dataset.title?t.dataset.title:t.innerHTML,!i.includes(".")||/\s/.test(i))e=i;else{let n=i.toLowerCase().split("."),s=this.langJSON[n[0]];s?(e=s[n[1]],void 0===e&&(console.log("FPD label not found: "+t.dataset.defaulttext,n),e=t.dataset.defaulttext)):e=t.dataset.defaulttext}}else e=t.dataset.defaulttext;return t.getAttribute("placeholder")?(t.setAttribute("placeholder",e),t.innerText=""):t.getAttribute("title")?t.setAttribute("title",e):t.dataset.title?t.dataset.title=e:t.innerHTML=e,e}getTranslation(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=i;return Q(this.langJSON)||(t=this.langJSON[t])&&(n=t[e]?t[e]:i),n.replace(/\n/g,""),n}translateArea(t){const e=t.querySelectorAll("[data-defaulttext]");Array.from(e).forEach((t=>{this.translateElement(t)}))}}function Gt(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function qt(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Xt=new WeakSet;class Zt extends HTMLElement{constructor(){var t,e;super(),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=Xt),e.add(t),Gt(this,"placeholder",""),Gt(this,"value",""),Gt(this,"searchable",!1),Gt(this,"inputElem",null),Gt(this,"listElem",null)}connectedCallback(){this.innerHTML='<input type="text" class="fpd-dropdown-current"/> <div class="fpd-dropdown-arrow"><span class="fpd-icon-arrow-dropdown"></span></div> <div class="fpd-dropdown-list"> <div class="fpd-scroll-area"></div> </div> ',this.inputElem=this.querySelector("input.fpd-dropdown-current"),this.listElem=this.querySelector(".fpd-dropdown-list"),document.addEventListener("click",(t=>{this.contains(t.target)||this.classList.remove("fpd-active")})),this.addEventListener("click",(()=>{qt(this,Xt,Jt).call(this),this.classList.toggle("fpd-active")})),this.querySelector(".fpd-dropdown-arrow").addEventListener("click",(t=>{t.stopPropagation(),qt(this,Xt,Jt).call(this),this.classList.toggle("fpd-active")})),this.inputElem.addEventListener("keyup",(t=>{if(this.searchable){const e=t.currentTarget.value;this.listElem.querySelectorAll(".fpd-item").forEach((t=>{0==e.length?t.classList.remove("fpd-hidden"):t.classList.toggle("fpd-hidden",!t.innerText.toLowerCase().includes(e.toLowerCase()))}))}})),window.addEventListener("scroll",(()=>{qt(this,Xt,Jt).call(this)}));const t=e=>{var i=e.parentNode;i&&(e.addEventListener("scroll",(()=>{qt(this,Xt,Jt).call(this)})),t(i))};t(this),this.inputElem.setAttribute("placeholder",this.getAttribute("placeholder")||""),qt(this,Xt,Jt).call(this)}static get observedAttributes(){return["searchable","placeholder","value"]}attributeChangedCallback(t,e,i){e!==i&&(this.inputElem&&("placeholder"===t?this.inputElem.setAttribute("placeholder",i):"value"===t&&(this.inputElem.value=i)),"searchable"===t&&(this.searchable=this.hasAttribute("searchable")))}}function Jt(){const t=this.getBoundingClientRect();this.listElem.style.width=t.width+"px",this.listElem.style.left=t.left+"px",this.listElem.style.top=t.top+t.height+"px"}customElements.define("fpd-dropdown",Zt),i(653);class Qt extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-pos="left"> <fpd-actions-menu data-font-icon="fpd-icon-menu"></fpd-actions-menu> </div> <div data-pos="center"> <fpd-actions-menu class="fpd-only-uncollapsed"></fpd-actions-menu> </div> <div data-pos="right"> <fpd-actions-menu data-font-icon="fpd-icon-more"></fpd-actions-menu> </div> <div data-pos="modal"> <span class="fpd-btn fpd-btn-fill fpd-close fpd-done"> <i class="fpd-icon-done"></i> <span class="fpd-label" data-defaulttext="Done">actions.modal_done</span> <span class="fpd-total-price">10.00$</span> </span> <span class="fpd-btn fpd-close"> <i class="fpd-icon-close"></i> </span> </div>'}}customElements.define("fpd-actions-bar",Qt);class Kt extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div> <input type="text" data-defaulttext="Enter a URL, some text..." placeholder="modules.qr_code_input"/> <div class="fpd-qr-code-colors"> <div class="fpd-qr-code-color-dark"></div> <div class="fpd-qr-code-color-light"></div> </div> <span class="fpd-add-qr-code fpd-btn" data-defaulttext="Add QR-Code">modules.qr_code_add_btn</span> </div> '}}customElements.define("fpd-module-qr-code",Kt);var $t=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},te=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),ee=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){s=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(s)throw r}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var i=this;i.length<t;)i=e+i;return i};var ie={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e>0?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}var se=function(){function t(e,i,n,s){$t(this,t);var r=this;if(void 0===e);else if(Array.isArray(e))this.rgba=e;else if(void 0===n){var a=e&&""+e;a&&function(e){if(e.startsWith("hsl")){var i=e.match(/([\-\d\.e]+)/g).map(Number),n=ee(i,4),s=n[0],a=n[1],o=n[2],l=n[3];void 0===l&&(l=1),s/=360,a/=100,o/=100,r.hsla=[s,a,o,l]}else if(e.startsWith("rgb")){var c=e.match(/([\-\d\.e]+)/g).map(Number),h=ee(c,4),d=h[0],u=h[1],f=h[2],p=h[3];void 0===p&&(p=1),r.rgba=[d,u,f,p]}else e.startsWith("#")?r.rgba=t.hexToRgb(e):r.rgba=t.nameToRgb(e)||t.hexToRgb(e)}(a.toLowerCase())}else this.rgba=[e,i,n,void 0===s?1:s]}return te(t,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map((function(t,e){return ne(t,3===e?3:0)}));return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var e=[360,100,100,1],i=["","%","%",""],n=(t?this.hsla:this.hsla.slice(0,3)).map((function(t,n){return ne(t*e[n],3===n?3:1)+i[n]}));return t?"hsla("+n+")":"hsl("+n+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=t.hslToRgb(this._hsla)},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=t.rgbToHsl(this._rgba)},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map((function(t,e){return e<3?t.toString(16):Math.round(255*t).toString(16)})).map((function(t){return t.padStart(2,"0")})).join("")},set:function(e){this.rgba=t.hexToRgb(e)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!e.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var i=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map((function(t){return parseInt(t,16)}));return i[3]=i[3]/255,i}},{key:"nameToRgb",value:function(e){var i=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),n=ie[i];return void 0===n?n:t.hexToRgb(n.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=ee(t,4),i=e[0],n=e[1],s=e[2],r=e[3];i/=255,n/=255,s/=255;var a=Math.max(i,n,s),o=Math.min(i,n,s),l=void 0,c=void 0,h=(a+o)/2;if(a===o)l=c=0;else{var d=a-o;switch(c=h>.5?d/(2-a-o):d/(a+o),a){case i:l=(n-s)/d+(n<s?6:0);break;case n:l=(s-i)/d+2;break;case s:l=(i-n)/d+4}l/=6}return[l,c,h,r]}},{key:"hslToRgb",value:function(t){var e=ee(t,4),i=e[0],n=e[1],s=e[2],r=e[3],a=void 0,o=void 0,l=void 0;if(0===n)a=o=l=s;else{var c=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},h=s<.5?s*(1+n):s+n-s*n,d=2*s-h;a=c(d,h,i+1/3),o=c(d,h,i),l=c(d,h,i-1/3)}var u=[255*a,255*o,255*l].map(Math.round);return u[3]=r,u}}]),t}(),re=function(){function t(){$t(this,t),this._events=[]}return te(t,[{key:"add",value:function(t,e,i){t.addEventListener(e,i,!1),this._events.push({target:t,type:e,handler:i})}},{key:"remove",value:function(e,i,n){this._events=this._events.filter((function(s){var r=!0;return e&&e!==s.target&&(r=!1),i&&i!==s.type&&(r=!1),n&&n!==s.handler&&(r=!1),r&&t._doRemove(s.target,s.type,s.handler),!r}))}},{key:"destroy",value:function(){this._events.forEach((function(e){return t._doRemove(e.target,e.type,e.handler)})),this._events=[]}}],[{key:"_doRemove",value:function(t,e,i){t.removeEventListener(e,i,!1)}}]),t}();function ae(t,e,i){var n=!1;function s(t,e,i){return Math.max(e,Math.min(t,i))}function r(t,r,a){if(a&&(n=!0),n){t.preventDefault();var o=e.getBoundingClientRect(),l=o.width,c=o.height,h=r.clientX,d=r.clientY,u=s(h-o.left,0,l),f=s(d-o.top,0,c);i(u/l,f/c)}}function a(t,e){1===(void 0===t.buttons?t.which:t.buttons)?r(t,t,e):n=!1}function o(t,e){1===t.touches.length?r(t,t.touches[0],e):n=!1}t.add(e,"mousedown",(function(t){a(t,!0)})),t.add(e,"touchstart",(function(t){o(t,!0)})),t.add(window,"mousemove",a),t.add(e,"touchmove",o),t.add(window,"mouseup",(function(t){n=!1})),t.add(e,"touchend",(function(t){n=!1})),t.add(e,"touchcancel",(function(t){n=!1}))}var oe="keydown",le="mousedown",ce="focusin";function he(t,e){return(e||document).querySelector(t)}function de(t){t.preventDefault(),t.stopPropagation()}function ue(t,e,i,n,s){t.add(e,oe,(function(t){i.indexOf(t.key)>=0&&(s&&de(t),n(t))}))}var fe=function(){function t(e){$t(this,t),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new re,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return te(t,[{key:"setOptions",value:function(t){var e=this;if(t){var i=this.settings;if(t instanceof HTMLElement)i.parent=t;else{i.parent&&t.parent&&i.parent!==t.parent&&(this._events.remove(i.parent),this._popupInited=!1),function(t,e,i){for(var n in t)e[n]=t[n]}(t,i),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var n=t.color||t.colour;n&&this._setColor(n)}var s=i.parent;if(s&&i.popup&&!this._popupInited){var r=function(t){return e.openHandler(t)};this._events.add(s,"click",r),ue(this._events,s,[" ","Spacebar","Enter"],r),this._popupInited=!0}else t.parent&&!i.popup&&this.show()}}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var e=t&&t.type===oe?this._domEdit:this.domElement;setTimeout((function(){return e.focus()}),100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var e=t&&t.type,i=!1;if(t)if(e===le||e===ce){var n=(this.__containedEvent||0)+100;t.timeStamp>n&&(i=!0)}else de(t),i=!0;else i=!0;i&&this.hide()&&(this.settings.parent.style.pointerEvents="",e!==le&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if("string"==typeof t&&(t=t.trim()),t){e=e||{};var i=void 0;try{i=new se(t)}catch(t){if(e.failSilently)return;throw t}if(!this.settings.alpha){var n=i.hsla;n[3]=1,i.hsla=n}this.colour=this.color=i,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var t=this._toggleDOM(!0);return this._setPosition(),t}var e,i,n=(e=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',(i=document.createElement("div")).innerHTML=e,i.firstElementChild);return this.domElement=n,this._domH=he(".picker_hue",n),this._domSL=he(".picker_sl",n),this._domA=he(".picker_alpha",n),this._domEdit=he(".picker_editor input",n),this._domSample=he(".picker_sample",n),this._domOkay=he(".picker_done button",n),this._domCancel=he(".picker_cancel button",n),n.classList.add("layout_"+this.settings.layout),this.settings.alpha||n.classList.add("no_alpha"),this.settings.editor||n.classList.add("no_editor"),this.settings.cancelButton||n.classList.add("no_cancel"),this._ifPopup((function(){return n.classList.add("popup")})),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,e=this,i=this.domElement,n=this._events;function s(t,e,i){n.add(t,e,i)}s(i,"click",(function(t){return t.preventDefault()})),ae(n,this._domH,(function(t,i){return e._setHSLA(t)})),ae(n,this._domSL,(function(t,i){return e._setHSLA(null,t,1-i)})),this.settings.alpha&&ae(n,this._domA,(function(t,i){return e._setHSLA(null,null,null,1-i)}));var r=this._domEdit;s(r,"input",(function(t){e._setColor(this.value,{fromEditor:!0,failSilently:!0})})),s(r,"focus",(function(t){var e=this;e.selectionStart===e.selectionEnd&&e.select()})),this._ifPopup((function(){var e=function(e){return t.closeHandler(e)};s(window,le,e),s(window,ce,e),ue(n,i,["Esc","Escape"],e);var r=function(e){t.__containedEvent=e.timeStamp};s(i,le,r),s(i,ce,r),s(t._domCancel,"click",e)}));var a=function(e){t._ifPopup((function(){return t.closeHandler(e)})),t.onDone&&t.onDone(t.colour)};s(this._domOkay,"click",a),ue(n,i,["Enter"],a)}},{key:"_setPosition",value:function(){var t=this.settings.parent,e=this.domElement;t!==e.parentNode&&t.appendChild(e),this._ifPopup((function(i){"static"===getComputedStyle(t).position&&(t.style.position="relative");var n=!0===i?"popup_right":"popup_"+i;["popup_top","popup_bottom","popup_left","popup_right"].forEach((function(t){t===n?e.classList.add(t):e.classList.remove(t)})),e.classList.add(n)}))}},{key:"_setHSLA",value:function(t,e,i,n,s){s=s||{};var r=this.colour,a=r.hsla;[t,e,i,n].forEach((function(t,e){(t||0===t)&&(a[e]=t)})),r.hsla=a,this._updateUI(s),this.onChange&&!s.silent&&this.onChange(r)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,i=e.hsla,n="hsl("+360*i[0]+", 100%, 50%)",s=e.hslString,r=e.hslaString,a=this._domH,o=this._domSL,l=this._domA,c=he(".picker_selector",a),h=he(".picker_selector",o),d=he(".picker_selector",l);b(0,c,i[0]),this._domSL.style.backgroundColor=this._domH.style.color=n,b(0,h,i[1]),y(0,h,1-i[2]),o.style.color=s,y(0,d,1-i[3]);var u=s,f=u.replace("hsl","hsla").replace(")",", 0)"),p="linear-gradient("+[u,f]+")";if(this._domA.style.background=p+", linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!t.fromEditor){var g=this.settings.editorFormat,m=this.settings.alpha,v=void 0;switch(g){case"rgb":v=e.printRGB(m);break;case"hsl":v=e.printHSL(m);break;default:v=e.printHex(m)}this._domEdit.value=v}this._domSample.style.color=r}function b(t,e,i){e.style.left=100*i+"%"}function y(t,e,i){e.style.top=100*i+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e=this.domElement;if(!e)return!1;var i=t?"":"none",n=e.style.display!==i;return n&&(e.style.display=i),n}}]),t}(),pe=i(331),ge=i.n(pe);class me extends EventTarget{constructor(t,e){super(),this.fpdInstance=t,this.darkColor="#000",this.lightColor="#fff",this.container=document.createElement("fpd-module-qr-code"),e.append(this.container);const i=this.container.querySelector(".fpd-qr-code-color-dark");i.style.backgroundColor="#000",new fe({parent:i,popup:"bottom",alpha:!1,color:this.darkColor,onChange:t=>{this.darkColor=o(t.rgbaString).toHexString(),i.style.backgroundColor=this.darkColor}});const n=this.container.querySelector(".fpd-qr-code-color-light");n.style.backgroundColor=this.lightColor,new fe({parent:n,popup:"bottom",alpha:!1,color:this.lightColor,onChange:t=>{this.lightColor=o(t.rgbaString).toHexString(),n.style.backgroundColor=this.lightColor}}),G(this.container.querySelector(".fpd-btn"),"click",(e=>{q(this,"qrCodeModuleBtnClick");const i=this.container.querySelector('input[type="text"]').value;if(i&&i.length>0){const e=new(ge())({background:this.lightColor,backgroundAlpha:1,foreground:this.darkColor,foregroundAlpha:1,size:500,value:this.container.querySelector('input[type="text"]').value}),n=z(t.mainOptions.qrCodeProps,{_addToUZ:t.currentViewInstance.currentUploadZone,_isQrCode:!0});t._addCanvasImage(e.toDataURL(),"QR-Code: "+i,n)}}))}}var ve=i(729),be=i.n(ve);class ye extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-save" data-defaulttext="Saved Designs" data-title="modules.save_load"> <div class="fpd-save-design"> <input type="text" data-defaulttext="Optional: Enter a title" placeholder="modules.save_load_input_placeholder"> <div class="fpd-btn"> <span data-defaulttext="Save Design">modules.save_load_add_btn</span> </div> </div> <div class="fpd-saved-designs fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain"></div> </div> </div>'}}function xe(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-save-load",ye);var we=new WeakSet;class Ce extends EventTarget{constructor(t,e){if(super(),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(i=this,s=we),s.add(i),this.fpdInstance=t,this.container=document.createElement("fpd-module-save-load"),e.append(this.container),this.inputElem=this.container.querySelector("input"),this.gridElem=this.container.querySelector(".fpd-grid"),G(this.container.querySelector(".fpd-btn"),"click",(e=>{const i=kt(this.fpdInstance.currentViewInstance.options.stageWidth,this.fpdInstance.currentViewInstance.options.stageHeight,300,300,"cover");t.viewInstances[0].toDataURL((t=>{const e=this.fpdInstance.getProduct(),i={thumbnail:t,product:e,title:this.inputElem.value||""};if(e&&this.fpdInstance.mainOptions.saveActionBrowserStorage){let t=xe(this,we,Se).call(this);t||(t=[]),this.addSavedProduct(i),t.push(i),window.localStorage.setItem(this.fpdInstance.container.id,JSON.stringify(t)),n(this.fpdInstance.translator.getTranslation("misc","product_saved"))}e&&(this.fpdInstance.dispatchEvent(new CustomEvent("actionSave",{detail:i})),this.fpdInstance.doUnsavedAlert=!1)}),{multiplier:i,format:"png",backgroundColor:"transparent"})})),this.fpdInstance.mainOptions.saveActionBrowserStorage){let t=xe(this,we,Se).call(this);t&&t.length>0&&t.forEach((t=>{this.addSavedProduct(t)}))}var i,s}addSavedProduct(t){let{thumbnail:e,product:i,title:n=""}=t;const s=$({url:e,title:n,removable:!0,disablePrice:!0,disableDraggable:!0});return this.fpdInstance.lazyBackgroundObserver.observe(s.querySelector("picture")),s.product=i,this.gridElem.append(s),G(s,"click",(t=>{this.fpdInstance.loadProduct(s.product),this.fpdInstance.currentProductIndex=-1})),G(s.querySelector(".fpd-delete"),"click",(t=>{t.stopPropagation();const e=t.currentTarget.parentNode,i=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(e);if(this.fpdInstance.mainOptions.saveActionBrowserStorage){let t=xe(this,we,Se).call(this);t.splice(i,1),window.localStorage.setItem(this.fpdInstance.container.id,JSON.stringify(t))}this.fpdInstance.dispatchEvent(new CustomEvent("actionLoad:Remove",{detail:{index:i,item:e}})),e.remove()})),s}}function Se(){return!!K()&&JSON.parse(window.localStorage.getItem(this.fpdInstance.container.id))}function Te(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ee(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}window.FPDSaveLoadModule=Ce;var Ae=new WeakSet;class Ie extends EventTarget{constructor(t){var e,i;super(),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,i=Ae),i.add(e),Te(this,"currentActions",{}),this.fpdInstance=t,this.container=document.createElement("fpd-actions-bar"),t.container.append(this.container),this.leftActionsMenu=this.container.querySelector('[data-pos="left"] fpd-actions-menu'),this.leftActionsMenu.setAttribute("placeholder",this.fpdInstance.translator.getTranslation("actions","menu_file")),this.centerActionsMenu=this.container.querySelector('[data-pos="center"] fpd-actions-menu'),this.rightActionsMenu=this.container.querySelector('[data-pos="right"] fpd-actions-menu'),this.rightActionsMenu.setAttribute("placeholder",this.fpdInstance.translator.getTranslation("actions","menu_more")),G(t.container.querySelectorAll(".fpd-close"),"click",(t=>{Z(this.fpdInstance.modalWrapper,["fpd-show"]),this.fpdInstance.dispatchEvent(new CustomEvent("modalDesignerClose"))})),G(t.container.querySelector(".fpd-done"),"click",(t=>{this.fpdInstance.dispatchEvent(new CustomEvent("modalDesignerDone"))})),G(t,["viewSelect"],(t=>{this.reset()})),G(window,"resize",(e=>{t.inTextField||this.reset()})),G(window,["resize","fpdModalDesignerOpen"],(()=>{this.leftActionsMenu&&this.leftActionsMenu.toggleMenus(),this.rightActionsMenu&&this.rightActionsMenu.toggleMenus()})),this.setup(t.mainOptions.actions)}addActionBtn(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ie.availableActions.hasOwnProperty(e)){const n=Ie.availableActions[e],s=this.fpdInstance.translator.getTranslation("actions",e.replace(/-/g,"_"),n.title);if(i)n.type=e,n.title=s,n.handler=t=>{const e=t.currentTarget.querySelector(".fpd-switch");e&&!t.target.classList.contains("fpd-switch")&&(e.checked=!e.checked),this.doAction(t.currentTarget.dataset.action)},t.items=[...t.items,n];else{const i=document.createElement("div");i.className="fpd-btn fpd-tooltip",i.setAttribute("aria-label",s),i.dataset.action=e,i.innerHTML=`<i class="${n.icon}"></i><span>${s}</span>`,Ie.toggleActions.includes(e)&&i.insertAdjacentHTML("beforeend",'<input type="checkbox" class="fpd-switch" />'),t.append(i),G(i,"click",(t=>{const e=t.currentTarget.querySelector(".fpd-switch");e&&!t.target.classList.contains("fpd-switch")&&(e.checked=!e.checked),this.doAction(t.currentTarget.dataset.action)}))}}}doAction(e){if(this.fpdInstance.currentViewInstance){if(this.fpdInstance.deselectElement(),"print"===e)this.fpdInstance.print();else if("reset-product"===e){var i=t(this.fpdInstance.translator.getTranslation("misc","reset_confirm"),!1,"confirm",this.fpdInstance.container);const e=i.querySelector(".fpd-confirm");e.innerText=this.fpdInstance.translator.getTranslation("actions","reset_product"),G(e,["click"],(()=>{this.fpdInstance.loadProduct(this.fpdInstance.productViews),i.remove()}))}else if("undo"===e)this.fpdInstance.currentViewInstance.fabricCanvas.undo();else if("redo"===e)this.fpdInstance.currentViewInstance.fabricCanvas.redo();else if("info"===e)t(this.fpdInstance.translator.getTranslation("actions","info_content"),!1,"",this.fpdInstance.container);else if("preview-lightbox"===e)this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler=!1,this.fpdInstance.getProductDataURL((e=>{const i=new Image;i.src=e,i.onload=()=>{const e=t('<div style="background: url('+i.src+'); height: 90vh; width:100%; background-size:contain; background-repeat:no-repeat; background-position:center;"></div>',!0);q(this.fpdInstance,"actionPreviewModalOpen",{modal:e})},this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler=this.fpdInstance.mainOptions.rulerFixed,this.fpdInstance.currentViewInstance.fabricCanvas.renderAll()}));else if("snap"===e)this.fpdInstance.currentViewInstance.fabricCanvas.snapToGrid=!this.fpdInstance.currentViewInstance.fabricCanvas.snapToGrid,this.fpdInstance.currentViewInstance.fabricCanvas.renderAll();else if("zoom"===e){const t=this.fpdInstance.mainWrapper.container.querySelector(".fpd-zoom-wrapper");if(t)return void t.remove();const e=document.createElement("div");e.className="fpd-zoom-wrapper fpd-shadow-1";const i=this.fpdInstance.currentViewInstance.fabricCanvas.getZoom()/this.fpdInstance.currentViewInstance.fabricCanvas.responsiveScale,n=document.createElement("fpd-range-slider");n.className="fpd-progress",n.setAttribute("value",i),n.setAttribute("step",.02),n.setAttribute("min",1),n.setAttribute("max",3),n.onInput=t=>{this.fpdInstance.currentViewInstance.fabricCanvas.setResZoom(Number(t.currentTarget.value))},e.append(n);const s=document.createElement("div");s.className="fpd-stage-pan fpd-toggle",s.innerHTML='<span class="fpd-icon-drag"></span>',e.append(s),G(s,"click",(t=>{this.fpdInstance.currentViewInstance.fabricCanvas.panCanvas=!this.fpdInstance.currentViewInstance.fabricCanvas.panCanvas,J(s,["fpd-active"],this.fpdInstance.currentViewInstance.fabricCanvas.panCanvas)}));const r=document.createElement("div");r.className="fpd-close",r.innerHTML='<span class="fpd-icon-close"></span>',e.append(r),G(r,"click",(t=>{e&&e.remove()})),this.fpdInstance.mainWrapper.container.append(e)}else if("download"===e){const e=`<div class="fpd-modal-download">\n\t\t\t<span data-value="jpeg">\n\t\t\t\t<span class="fpd-icon-jpg"></span>\n\t\t\t</span>\n\t\t\t<span data-value="png">\n\t\t\t\t<span class="fpd-icon-png"></span>\n\t\t\t</span>\n\t\t\t<span data-value="pdf">\n\t\t\t\t<span class="fpd-icon-pdf"></span>\n\t\t\t</span>\n\t\t\t<span data-value="svg">\n\t\t\t\t<span class="fpd-icon-svg"></span>\n\t\t\t</span>\n\t\t\t<div class="fpd-switch-wrapper">\n\t\t\t\t<input type="checkbox" class="fpd-switch" id="fpd-action-download-single-view" />\n\t\t\t\t<label for="fpd-action-download-single-view">${this.fpdInstance.translator.getTranslation("actions","download_current_view")}</label>\n\t\t\t</div>\n\t\t</div>`,i=t(e,!1,"",this.fpdInstance.container);G(i.querySelectorAll("span[data-value]"),"click",(t=>{this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler=!1,this.downloadFile(t.currentTarget.dataset.value,i.querySelector(".fpd-switch").checked),i.remove(),this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler=this.fpdInstance.mainOptions.rulerFixed,this.fpdInstance.currentViewInstance.fabricCanvas.renderAll()}))}else if("ruler"===e)this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler=!this.fpdInstance.currentViewInstance.fabricCanvas.enableRuler,this.fpdInstance.currentViewInstance.fabricCanvas.renderAll();else if("previous-view"===e)this.fpdInstance.selectView(this.fpdInstance.currentViewIndex-1);else if("next-view"===e)this.fpdInstance.selectView(this.fpdInstance.currentViewIndex+1);else if("guided-tour"===e&&this.fpdInstance.guidedTour)this.fpdInstance.guidedTour.start();else if("qr-code"===e){const e=this.fpdInstance.container.querySelector(".fpd-modal-internal");e&&e.remove();const i=t("",!1,"",this.fpdInstance.container),n=new me(this.fpdInstance,i.querySelector(".fpd-modal-content"));this.fpdInstance.translator.translateArea(i),G(n,"qrCodeModuleBtnClick",(()=>{i.remove()}))}else if("save-load"===e){const e=this.fpdInstance.container.querySelector(".fpd-modal-internal");e&&e.remove();const i=t("",!1,"",this.fpdInstance.container);new Ce(this.fpdInstance,i.querySelector(".fpd-modal-content")),this.fpdInstance.translator.translateArea(i)}q(this.fpdInstance,"actionClick",{action:e})}}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.fpdInstance.currentViewInstance)return;const i=this.fpdInstance.mainOptions.downloadFilename;if("jpeg"===t||"png"===t){document.createElement("a");var n="jpeg"===t?"#fff":"transparent";e?this.fpdInstance.currentViewInstance.toDataURL((e=>{be()(e,i+"."+t,"image/"+t)}),{format:t,backgroundColor:n,watermarkImg:this.fpdInstance.watermarkImg}):this.fpdInstance.getProductDataURL((e=>{be()(e,i+"."+t,"image/"+t)}),{format:t,backgroundColor:n})}else"svg"===t?be()(this.fpdInstance.currentViewInstance.toSVG({suppressPreamble:!1,watermarkImg:this.fpdInstance.watermarkImg}),"Product_"+this.fpdInstance.currentViewIndex+".svg","image/svg+xml"):(s="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",new Promise((function(t,e){if(null===document.querySelector("script[src='"+s+"']")){var i=document.createElement("script");i.onload=()=>{t()},i.onerror=()=>{e()},i.src=s,document.body.appendChild(i)}else t()}))).then((()=>{const t=t=>{let n;t="string"==typeof t?[t]:t;for(let i=0;i<t.length;++i){const s=e?this.fpdInstance.currentViewIndex:i;let r=this.fpdInstance.viewInstances[s].options.stageWidth,a=this.fpdInstance.viewInstances[s].options.stageHeight,o=r>a?"l":"p";0!=i?n.addPage([r,a],o):n=new jspdf.jsPDF({orientation:o,unit:"px",format:[r,a]}),n.addImage(t[i],"PNG",0,0,n.internal.pageSize.getWidth(),n.internal.pageSize.getHeight())}n.save(i+".pdf")};jspdf&&(e?this.fpdInstance.currentViewInstance.toDataURL(t,{format:"png",watermarkImg:this.fpdInstance.watermarkImg}):this.fpdInstance.getViewsDataURL(t,{format:"png"}))}));var s}reset(){const t=this.container.querySelectorAll(".fpd-switch");t&&t.forEach((t=>{t.checked=!1}));const e=this.fpdInstance.mainWrapper.container.querySelector(".fpd-zoom-wrapper");e&&e.remove(),this.fpdInstance.currentViewInstance&&this.fpdInstance.currentViewInstance.fabricCanvas.setResZoom(1)}setup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.currentActions=t,"object"==typeof t){this.container.querySelectorAll("fpd-actions-menu").forEach((t=>{t.items=[]}));for(const e in t)Ee(this,Ae,Oe).call(this,e,t[e])}this.fpdInstance.translator.translateArea(this.container)}}function Oe(t,e){Array.isArray(e)&&e.length?e.forEach((e=>{let i;"left"==t?i=this.leftActionsMenu:"center"==t?i=this.centerActionsMenu:"right"==t&&(i=this.rightActionsMenu),i&&this.addActionBtn(i,e,!0)})):"left"!=t&&"right"!=t||X(this.container.querySelector('[data-pos="'+t+'"]'),["fpd-visible-hidden"])}function ke(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Me(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}Te(Ie,"toggleActions",["ruler"]),Te(Ie,"availableActions",{print:{icon:"fpd-icon-print",title:"Print"},"reset-product":{icon:"fpd-icon-reset",title:"Reset Product"},undo:{icon:"fpd-icon-undo",title:"Undo"},redo:{icon:"fpd-icon-redo",title:"Redo"},info:{icon:"fpd-icon-info",title:"Info"},zoom:{icon:"fpd-icon-zoom-in",title:"Zoom"},download:{icon:"fpd-icon-download",title:"Download"},"preview-lightbox":{icon:"fpd-icon-preview-lightbox",title:"Preview Lightbox"},ruler:{icon:"fpd-icon-ruler",title:"Ruler"},"previous-view":{icon:"fpd-icon-back",title:"Previous View"},"next-view":{icon:"fpd-icon-forward",title:"Next View"},"guided-tour":{icon:"fpd-icon-guided-tour",title:"Guided Tour"},"qr-code":{icon:"fpd-icon-qrcode",title:"QR-Code"},"save-load":{icon:"fpd-icon-save",title:"Saved Designs"}}),window.FPDActions=Ie;var Pe=new WeakSet,_e=new WeakSet;class De extends HTMLElement{constructor(){super(),ke(this,_e),ke(this,Pe),this.items=[]}connectedCallback(){this.innerHTML='<div class="fpd-uncollapsed-menu fpd-visible-hidden fpd-hidden"></div> <div class="fpd-collapsed-menu fpd-hidden"> <div class="fpd-dropdown-btn"> <i></i> <span class="fpd-label"></span> <div class="fpd-dropdown-menu fpd-shadow-1"></div> </div> </div>',this.uncollapsedMenu=this.querySelector(".fpd-uncollapsed-menu"),this.collapsedMenu=this.querySelector(".fpd-collapsed-menu"),this.collapsedMenu.querySelector(".fpd-dropdown-btn > i").className=this.dataset.fontIcon||"",G(this.collapsedMenu.querySelectorAll(".fpd-dropdown-btn"),"click",(t=>{const e=t.currentTarget.querySelector(".fpd-dropdown-menu");J(e,["fpd-show"],!e.classList.contains("fpd-show"))}))}static get observedAttributes(){return["items","placeholder"]}attributeChangedCallback(t,e,i){e!==i&&"placeholder"==t&&this.collapsedMenu&&(this.collapsedMenu.querySelector(".fpd-dropdown-btn > .fpd-label").innerText=i)}get items(){return this._items}set items(t){this._items=t,Me(this,Pe,Le).call(this)}toggleMenus(){this.isConnected&&this.uncollapsedMenu&&(Z(this.uncollapsedMenu,["fpd-hidden"]),this.uncollapsedMenu.offsetWidth>this.offsetWidth&&!this.classList.contains("fpd-only-uncollapsed")?(X(this.uncollapsedMenu,["fpd-visible-hidden"]),X(this.uncollapsedMenu,["fpd-hidden"]),Z(this.collapsedMenu,["fpd-hidden"])):(Z(this.uncollapsedMenu,["fpd-visible-hidden"]),X(this.collapsedMenu,["fpd-hidden"])))}}function Le(){Me(this,_e,Be).call(this),this._items.forEach((t=>{const e=document.createElement("div");e.className="fpd-btn fpd-tooltip",e.setAttribute("aria-label",t.title),e.dataset.action=t.type,e.innerHTML=`<i class="${t.icon}"></i><span>${t.title}</span>`,Ie.toggleActions.includes(t.type)&&e.insertAdjacentHTML("beforeend",'<input type="checkbox" class="fpd-switch" />'),this.uncollapsedMenu.append(e);const i=e.cloneNode(!0);this.collapsedMenu.querySelector(".fpd-dropdown-menu").append(i),G([e,i],"click",t.handler)})),this.toggleMenus()}function Be(){this.isConnected&&this.uncollapsedMenu&&(this.uncollapsedMenu.innerHTML="",this.collapsedMenu.querySelector(".fpd-dropdown-menu").innerHTML="")}customElements.define("fpd-actions-menu",De);class je extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-navigation fpd-scrollbar-hidden"></div> <div class="fpd-module-content"></div> <div class="fpd-secondary-content"> <div class="fpd-upload-zone-panel"> <div class="fpd-upload-zone-content"></div> <div class="fpd-bottom-nav fpd-module-tabs"> <div class="fpd-add-image" data-module="images"> <span class="fpd-icon-photo"></span> </div> <div class="fpd-add-text" data-module="text"> <span class="fpd-icon-text-secondary"></span> </div> <div class="fpd-add-design" data-module="designs"> <span class="fpd-icon-design-library"></span> </div> </div> </div> </div> <div class="fpd-close"> <span class="fpd-icon-close"></span> </div> <div class="fpd-draggable-dialog fpd-container fpd-shadow-2"> <div class="fpd-dialog-head"> <div class="fpd-dialog-drag-handle"> <div> <span class="fpd-icon-drag"></span><span class="fpd-dialog-title"></span> </div> </div> <div class="fpd-close-dialog"> <span class="fpd-icon-close"></span> </div> </div> </div> '}}customElements.define("fpd-main-bar",je);class Fe extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-grid" data-defaulttext="Swap Product" data-title="modules.products"> <fpd-dropdown class="fpd-product-categories" searchable></fpd-dropdown> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain fpd-padding"> </div> </div> </div>'}}function Re(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Ne(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-products",Fe);var He=new WeakSet,ze=new WeakSet;class We extends EventTarget{constructor(t,e){var i,n,s;super(),Re(this,ze),Re(this,He),i=this,s=0,(n=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(n="currentCategoryIndex"))in i?Object.defineProperty(i,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[n]=s,this.fpdInstance=t,this.container=document.createElement("fpd-module-products"),e.append(this.container),t.addEventListener("productsSet",(t=>{const e=this.container.querySelector(".fpd-dropdown-list > .fpd-scroll-area");e.innerHTML="",this.fpdInstance.products&&this.fpdInstance.products.length>0&&(void 0!==this.fpdInstance.products[0].category&&this.fpdInstance.products.length>1&&(this.container.classList.add("fpd-categories-enabled"),this.fpdInstance.products.forEach(((t,i)=>{const n=document.createElement("span");n.className="fpd-item",n.dataset.index=i,n.innerText=t.category,n.addEventListener("click",(t=>{this.selectCategory(t.currentTarget.dataset.index)})),e.append(n)}))),Ne(this,He,Ve).call(this),this.selectCategory(0))})),t.addEventListener("productAdd",((t,e,i,n)=>{n==this.currentCategoryIndex&&Ne(this,ze,Ue).call(this,e)}))}selectCategory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.currentCategoryIndex=t,this.container.querySelector(".fpd-grid").innerHTML="",this.fpdInstance.products&&this.fpdInstance.products.length>0){let e;void 0!==this.fpdInstance.products[0].category?(e=this.fpdInstance.products[t].products,this.container.querySelector(".fpd-dropdown-current").value=this.fpdInstance.products[t].category):e=this.fpdInstance.products,e.forEach(((t,e)=>{Ne(this,ze,Ue).call(this,t,e)}))}}}function Ve(){if(this.fpdInstance.mainOptions.editorMode)return;let t=this.fpdInstance.products[0],e=void 0===t;void 0!==t&&(e=!!(!t.hasOwnProperty("category")&&this.fpdInstance.products.length<2||t.hasOwnProperty("category")&&t.products.length<2&&this.fpdInstance.products.length<2)),this.fpdInstance.container.classList.toggle("fpd-products-module-hidden",e);const i=this.fpdInstance.mainBar.navElem.querySelector(".fpd-active");e&&i&&"products"==i.dataset.module&&i.nextSibling&&i.nextSibling.click()}function Ue(e,i){let n=e[0].productThumbnail?e[0].productThumbnail:e[0].thumbnail,s=e[0].productTitle?e[0].productTitle:e[0].title;const r=document.createElement("div");r.className="fpd-item fpd-hover-thumbnail",r.dataset.title=s,r.dataset.source=n,r.dataset.index=i,r.addEventListener("click",(e=>{if(e.preventDefault(),this.fpdInstance.mainOptions.swapProductConfirmation){var n=t(this.fpdInstance.translator.getTranslation("modules","products_confirm_replacement"),!1,"confirm",this.fpdInstance.container);const e=n.querySelector(".fpd-confirm");e.innerText=this.fpdInstance.translator.getTranslation("modules","products_confirm_button"),G(e,["click"],(()=>{this.fpdInstance.selectProduct(i,this.currentCategoryIndex),n.remove()}))}else this.fpdInstance.selectProduct(Number(e.currentTarget.dataset.index),this.currentCategoryIndex)})),this.container.querySelector(".fpd-grid").append(r);const a=document.createElement("picture");a.dataset.img=n,r.append(a),this.fpdInstance.lazyBackgroundObserver.observe(a)}window.FPDProductsModule=We;class Ye extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-text-secondary" data-defaulttext="Add Text" data-title="modules.text"> <div class="fpd-add-text"> <textarea data-defaulttext="Enter some text" placeholder="modules.text_input_placeholder"></textarea> <div class="fpd-btn"> <span data-defaulttext="Add Text">modules.text_add_btn</span> <span class="fpd-price"></span> </div> </div> <div class="fpd-text-templates fpd-scroll-area"> <div class="fpd-grid fpd-padding"></div> </div> </div>'}}customElements.define("fpd-module-text",Ye);class Ge extends EventTarget{constructor(t,e){if(super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-text"),e.append(this.container),this.container.querySelector(".fpd-btn").addEventListener("click",(e=>{let i=this.container.querySelector("textarea"),n=i.value;if(t.currentViewInstance&&n.length>0){const e=t.currentViewInstance.options;let i=z(e.customTextParameters,{textBox:Boolean(this.fpdInstance.mainOptions.customTextAsTextbox),resizable:!0,isCustom:!0,_addToUZ:t.currentViewInstance.currentUploadZone,_calcWidth:!0});t.currentViewInstance.fabricCanvas.addElement("text",n,n,i)}i.value=""})),G(this.container.querySelector("textarea"),["input","change"],(e=>{const i=t.currentViewInstance.options;let n=e.currentTarget.value,s=i.customTextParameters.maxLength,r=i.customTextParameters.maxLines;n=n.replace(FancyProductDesigner.forbiddenTextChars,""),t.mainOptions.disableTextEmojis&&(n=n.replace(FPDEmojisRegex,""),n=n.replace(String.fromCharCode(65039),"")),0!=s&&n.length>s&&(n=n.substr(0,s)),0!=r&&n.split("\n").length>r&&(n=n.replace(/([\s\S]*)\n/,"$1")),e.currentTarget.value=n})),G(t,["viewSelect","secondaryModuleCalled"],(e=>{if(!t.currentViewInstance)return;const i=t.currentViewInstance.options;let n=null;if(t.currentViewInstance.currentUploadZone&&this.container.parentNode.classList.contains("fpd-upload-zone-content")){const e=t.currentViewInstance.fabricCanvas.getUploadZone(t.currentViewInstance.currentUploadZone);W(e,"price")&&(n=e.price)}const s=W(i,"customTextParameters.price",0);null==n&&s&&(n=s);const r=this.container.querySelector(".fpd-btn > .fpd-price");r&&(r.innerHTML=n?" - "+t.formatPrice(n):"")})),Array.isArray(t.mainOptions.textTemplates)){var i=this.container.querySelector(".fpd-text-templates .fpd-grid");t.mainOptions.textTemplates.forEach((e=>{var n=e.properties,s="font-family:"+(n.fontFamily?n.fontFamily:"Arial");s+="; text-align:"+(n.textAlign?n.textAlign:"left");const r=document.createElement("div");r.className="fpd-item",r.addEventListener("click",(i=>{if(t.currentViewInstance){const i=t.currentViewInstance.options;let n={...e.properties};n.isCustom=!0,n.textBox=Boolean(this.fpdInstance.mainOptions.customTextAsTextbox),n.resizable=!0,n._addToUZ=t.currentViewInstance.currentUploadZone,n._calcWidth=!0;let s=z(i.customTextParameters,n);t.currentViewInstance.fabricCanvas.addElement("text",e.text,e.text,s)}}));const a=document.createElement("div");a.setAttribute("style",s),a.innerHTML=e.text.replace(/(?:\r\n|\r|\n)/g,"<br>"),r.append(a),i.append(r)}))}}}window.FPDTextsModule=Ge;class qe extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-design-library" data-defaulttext="Add Designs" data-title="modules.designs"> <div class="fpd-head"> <div class="fpd-input-back-search"> <div class="fpd-back fpd-btn"> <span class="fpd-icon-back"></span> </div> <div class="fpd-input-search"> <input type="text"/> <span class="fpd-icon-magnify"></span> </div> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain fpd-padding"></div> </div> </div>'}}function Xe(t,e){Je(t,e),e.add(t)}function Ze(t,e,i){Je(t,e),e.set(t,i)}function Je(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qe(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Ke(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ti(t,e,"get"))}function $e(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,ti(t,e,"set"),i),i}function ti(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}customElements.define("fpd-module-designs",qe);var ei=new WeakMap,ii=new WeakMap,ni=new WeakMap,si=new WeakMap,ri=new WeakMap,ai=new WeakSet,oi=new WeakSet,li=new WeakSet,ci=new WeakSet;class hi extends EventTarget{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),Xe(this,ci),Xe(this,li),Xe(this,oi),Xe(this,ai),Ze(this,ei,{writable:!0,value:""}),Ze(this,ii,{writable:!0,value:!1}),Ze(this,ni,{writable:!0,value:[]}),Ze(this,si,{writable:!0,value:null}),Ze(this,ri,{writable:!0,value:null}),$e(this,ei,t.translator.getTranslation("modules","designs_search_in","Search in").toUpperCase()),this.fpdInstance=t,$e(this,ri,i),this.container=document.createElement("fpd-module-designs"),e.append(this.container),i&&(this.container.dataset.dynamicDesignsId=i),this.headElem=this.container.querySelector(".fpd-head"),this.gridElem=this.container.querySelector(".fpd-grid"),this.headElem.querySelector(".fpd-input-search input").addEventListener("keyup",(t=>{const e=t.currentTarget,i=this.gridElem.querySelectorAll(".fpd-item");if(""==e.value)for(let t of i)t.classList.remove("fpd-hidden");else{const t=e.value.toLowerCase().trim();for(let e of i)e.classList.add("fpd-hidden"),e.dataset.search.includes(t)&&e.classList.remove("fpd-hidden")}})),G(this.headElem.querySelector(".fpd-back"),"click",(t=>{this.gridElem.querySelectorAll(".fpd-category").length>0&&Ke(this,ni).pop();let e,i=this.fpdInstance.designs;Ke(this,ni).forEach((t=>{e=i[t],i=e.category})),$e(this,si,i),i&&Qe(this,ai,di).call(this,Ke(this,si),e),void 0===e&&this.toggleCategories()}));let n=!1;G(t,["designsSet"],(e=>{if(n)return;n=!0;const i=t.designs;Array.isArray(i)&&0!==i.length&&(i[0].hasOwnProperty("source")?(this.container.classList.add("fpd-single-cat"),Qe(this,li,fi).call(this,i)):i.length>1||i[0].category?($e(this,ii,!0),this.toggleCategories()):1===i.length&&i[0].designs&&(this.container.classList.add("fpd-single-cat"),Qe(this,li,fi).call(this,i[0].designs)))})),G(t,"viewSelect",(()=>{this.toggleCategories()}))}toggleCategories(){if(!Ke(this,ii))return;$e(this,ni,[]),this.container.classList.remove("fpd-head-visible","fpd-single-cat"),$e(this,si,this.fpdInstance.designs),Qe(this,ai,di).call(this,Ke(this,si));let t=[];if("string"==typeof Ke(this,ri))t=this.fpdInstance.mainOptions.dynamicDesigns[Ke(this,ri)].categories;else if(this.fpdInstance.currentViewInstance){const e=this.fpdInstance.currentElement;t=e&&e.uploadZone&&e.designCategories?this.fpdInstance.currentElement.designCategories:this.fpdInstance.currentViewInstance.options.designCategories}t=t.map((t=>t.toLowerCase()));var e=this.container.querySelectorAll(".fpd-category");if(t.length>0){let i=[];for(let n of e)t.includes(n.dataset.title.toLowerCase())?(n.classList.remove("fpd-hidden"),i.push(n)):n.classList.add("fpd-hidden");1===i.length&&(this.container.classList.add("fpd-single-cat"),i[0].click())}else for(let t of e)t.classList.remove("fpd-hidden")}}function di(t,e){this.gridElem.innerHTML="",this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-designs-active"),this.container.classList.add("fpd-categories-active"),t.forEach(((t,e)=>{Qe(this,oi,ui).call(this,t)})),e&&(this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",Ke(this,ei)+" "+e.title.toUpperCase()),this.container.classList.add("fpd-head-visible"))}function ui(t){const e=document.createElement("div");if(e.className="fpd-category fpd-item",e.dataset.title=t.title,e.dataset.search=t.title.toLowerCase(),t.thumbnail){const i=document.createElement("picture");i.dataset.img=t.thumbnail,e.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i);const n=document.createElement("span");n.innerText=t.title,e.append(n)}else e.innerHTML="<span>"+t.title+"</span>";e.addEventListener("click",(t=>{let e=t.currentTarget,i=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(e),n=Ke(this,si)[i];n.category?(Ke(this,ni).push(i),$e(this,si,n.category),Qe(this,ai,di).call(this,Ke(this,si),n)):Qe(this,li,fi).call(this,n.designs,n.parameters),this.headElem.querySelector(".fpd-input-search input").setAttribute("placeholder",Ke(this,ei)+" "+e.dataset.search.toUpperCase())})),this.gridElem.append(e)}function fi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gridElem.innerHTML="",this.headElem.querySelector(".fpd-input-search input").value="",this.container.classList.remove("fpd-categories-active"),this.container.classList.add("fpd-designs-active","fpd-head-visible"),t.forEach((t=>{t.parameters=z(e,t.parameters),Qe(this,ci,pi).call(this,t)}))}function pi(t){t.thumbnail=void 0===t.thumbnail?t.source:t.thumbnail;const e=tt(this.fpdInstance,this.container,t.parameters.price),i=$({url:t.source,thumbnailUrl:t.thumbnail,title:t.title,price:e,disablePrice:!Boolean(e)});i.dataset.search=t.title.toLowerCase(),i.parameters=t.parameters,i.addEventListener("click",(t=>{const e=t.currentTarget;this.fpdInstance.addCanvasDesign(e.dataset.source,e.dataset.title,e.parameters)})),this.gridElem.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i.querySelector("picture"))}window.FPDDesignsModule=hi;class gi extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-images" data-defaulttext="Add Image" data-title="modules.images"> <div class="fpd-module-tabs"> <div data-context="upload" class="fpd-active fpd-tooltip" data-defaulttext="Uploads" title="modules.uploads"> <span class="fpd-icon-cloud-upload"></span> </div> <div data-context="facebook" class="fpd-hidden fpd-tooltip" aria-label="Facebook"> <span class="fpd-icon-facebook"></span> </div> <div data-context="instagram" class="fpd-hidden fpd-tooltip" aria-label="Instagram"> <span class="fpd-icon-instagram"></span> </div> <div data-context="pixabay" class="fpd-hidden fpd-tooltip" aria-label="Pixabay"> <span class="fpd-icon-pixabay"></span> </div> <div data-context="qr-code" class="fpd-tooltip" data-defaulttext="QR-Code" title="actions.qr_code"> <span class="fpd-icon-qrcode"></span> </div> <div data-context="text2Img" class="fpd-hidden fpd-tooltip" data-defaulttext="Text to Images" title="modules.text_to_images"> <span class="fpd-icon-ai"></span> </div> </div> <div class="fpd-module-tabs-content"> <div data-context="upload" class="fpd-active"></div> <div data-context="facebook"></div> <div data-context="instagram"></div> <div data-context="pixabay"></div> <div data-context="qr-code"></div> <div data-context="text2Img"></div> </div> </div>'}}customElements.define("fpd-module-images",gi);class mi extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-upload-image"> <span data-defaulttext="Drop images here">modules.upload_zone</span> <span class="fpd-btn" data-defaulttext="Browse File">modules.browse_file</span> <span class="fpd-price"></span> </div> <input type="file" multiple="multiple" class="fpd-upload-input fpd-hidden" name="files[]" accept="image/jpeg,image/jpg,image/png,image/svg+xml,application/pdf"/> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}function vi(t,e){yi(t,e),e.add(t)}function bi(t,e,i){yi(t,e),e.set(t,i)}function yi(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function wi(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Si(t,e,"get"))}function Ci(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Si(t,e,"set"),i),i}function Si(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}customElements.define("fpd-module-uploads",mi);var Ti=new WeakMap,Ei=new WeakMap,Ai=new WeakMap,Ii=new WeakMap,Oi=new WeakMap,ki=new WeakMap,Mi=new WeakSet,Pi=new WeakSet,_i=new WeakSet,Di=new WeakSet,Li=new WeakSet,Bi=new WeakSet,ji=new WeakSet,Fi=new WeakSet,Ri=new WeakSet;class Ni extends EventTarget{constructor(t,e){super(),vi(this,Ri),vi(this,Fi),vi(this,ji),vi(this,Bi),vi(this,Li),vi(this,Di),vi(this,_i),vi(this,Pi),vi(this,Mi),bi(this,Ti,{writable:!0,value:void 0}),bi(this,Ei,{writable:!0,value:void 0}),bi(this,Ai,{writable:!0,value:0}),bi(this,Ii,{writable:!0,value:!1}),bi(this,Oi,{writable:!0,value:[]}),bi(this,ki,{writable:!0,value:0}),this.fpdInstance=t,this.container=document.createElement("fpd-module-uploads"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid");const i=this.container.querySelector(".fpd-upload-image");Ci(this,Ti,t.mainOptions.allowedImageTypes),wi(this,Ti).includes("jpeg")&&!wi(this,Ti).includes("jpg")&&wi(this,Ti).push("jpg"),Ci(this,Ei,t.mainOptions.uploadsStorageKey);const n=this.container.querySelector(".fpd-upload-input");let s=[];if(wi(this,Ti).forEach((t=>{"pdf"==t?s.push("application/pdf"):("svg"==t&&(t+="+xml"),s.push("image/"+t))})),n.setAttribute("accept",s.join()),G(i,"click",(async t=>{t.preventDefault(),n.click()})),G(n,"change",(t=>{xi(this,Mi,Hi).call(this,t.currentTarget.files)})),G(i,["dragover","dragleave"],(t=>{t.stopPropagation(),t.preventDefault(),t.currentTarget.classList.toggle("fpd-hover","dragover"===t.type)})),G(i,"drop",(t=>{t.stopPropagation(),t.preventDefault();const e=t.target.files||t.dataTransfer.files;xi(this,Mi,Hi).call(this,e)})),G(t,"productCreate",(t=>{Ci(this,Ii,!1)})),K()&&window.localStorage.getItem(wi(this,Ei))){const t=JSON.parse(window.localStorage.getItem(wi(this,Ei)));t.forEach((e=>{xi(this,ji,Gi).call(this,e.url,e.title);const i=new Image;i.src=e.url,i.onerror=()=>{t.forEach(((e,i)=>{t.splice(i,1)}))}})),window.localStorage.setItem(wi(this,Ei),JSON.stringify(t))}}}function Hi(e){if(this.fpdInstance.mainOptions.uploadAgreementModal){var i=t(this.fpdInstance.translator.getTranslation("modules","images_agreement"),!1,"confirm",this.fpdInstance.container);const n=i.querySelector(".fpd-confirm");n.innerText=this.fpdInstance.translator.getTranslation("modules","images_confirm_button"),G(n,["click"],(()=>{xi(this,Pi,zi).call(this,e),i.remove()}))}else xi(this,Pi,zi).call(this,e)}function zi(t){Ci(this,Ai,0),Ci(this,ki,t.length);for(var e=0;e<this.fpdInstance.viewInstances.length;++e)this.fpdInstance.getElements(e).forEach((t=>{t.uploadZone&&wi(this,Oi).push({uz:t.title,viewIndex:e})}));this.fpdInstance.loadingCustomImage=!0,Array.from(t).forEach(((t,e)=>{wi(this,Ti).includes(it(t.name))&&xi(this,_i,Wi).call(this,t,0==e)})),this.container.querySelector(".fpd-upload-image").classList.remove("fpd-hover"),this.container.querySelector(".fpd-upload-input").value=""}function Wi(t,e){const i=1024*this.fpdInstance.mainOptions.customImageParameters.maxSize*1024;if(t.size>i)return n(this.fpdInstance.translator.getTranslation("misc","maximum_size_info").replace("%filename",t.name).replace("%mb",this.fpdInstance.mainOptions.customImageParameters.maxSize)),void(this.fpdInstance.loadingCustomImage=!1);"application/pdf"===t.type?xi(this,Li,Ui).call(this,t,e):xi(this,Di,Vi).call(this,t,e)}function Vi(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.fpdInstance.mainOptions,s=new FileReader;s.onload=s=>{const r=s.currentTarget.result,a=xi(this,ji,Gi).call(this,r,t.name);if(FancyProductDesigner.uploadsToServer){if(!i.fileServerURL)return a.remove(),void alert("You need to set the fileServerURL in the option, otherwise file uploading does not work!");a.classList.add("fpd-loading"),a.insertAdjacentHTML("beforeend",'<div class="fpd-loading-bar"><div class="fpd-loading-progress"></div></div>')}const o=new Image;o.onload=i=>{const s=i.currentTarget;let r=s.height,o=s.width;if(et(this.fpdInstance,o,r))if(FancyProductDesigner.uploadsToServer){const i=new FormData;i.append("images[]",t);const s=new XMLHttpRequest;s.responseType="json",s.onreadystatechange=t=>{if(s.readyState===XMLHttpRequest.DONE){const t=s.status;if(0===t||t>=200&&t<400){const t=s.response;var i;t.image_src&&(xi(this,Bi,Yi).call(this,t.image_src,t.filename),a.dataset.source=t.image_src,a.classList.remove("fpd-loading"),a.querySelector(".fpd-loading-bar").remove(),xi(this,Fi,qi).call(this,a,e),Ci(this,Ai,(i=wi(this,Ai),++i)),a.xhr=null),this.fpdInstance.loadingCustomImage=!1}}},s.upload.onprogress=t=>{let e=t.total,i=t.loaded,n=parseInt(100*i/e);a.querySelector(".fpd-loading-progress").style.width=n+"%"},s.upload.onerror=t=>{this.fpdInstance.loadingCustomImage=!1,a.remove(),n("Upload failed. Please try again or check your web console!")},s.open("POST",this.fpdInstance.getFileServerURL()),s.send(i),a.xhr=s}else{var l;xi(this,Bi,Yi).call(this,s,t.name),xi(this,Fi,qi).call(this,a,e),Ci(this,Ai,(l=wi(this,Ai),++l))}else a.remove(),this.fpdInstance.currentViewInstance.currentUploadZone=null},o.src=r},s.readAsDataURL(t)}function Ui(t){this.fpdInstance.mainOptions;const e=n(this.fpdInstance.translator.getTranslation("modules","images_pdf_upload_info"),!1),i=new FormData;i.append("pdf",t);const s=new XMLHttpRequest;s.responseType="json",s.onreadystatechange=t=>{if(s.readyState===XMLHttpRequest.DONE){const t=s.status;if(0===t||t>=200&&t<400){var i,n;const t=s.response;Ci(this,ki,(i=wi(this,ki),--i)),t.pdf_images.forEach(((t,e)=>{var i;const n=xi(this,ji,Gi).call(this,t.image_url,t.filename);xi(this,Fi,qi).call(this,n,0==e),xi(this,Bi,Yi).call(this,t.image_url,t.filename),Ci(this,Ai,(i=wi(this,Ai),++i))})),e.remove(),Ci(this,ki,(n=wi(this,ki),++n)),this.fpdInstance.loadingCustomImage=!1}}},s.upload.onerror=()=>{this.fpdInstance.loadingCustomImage=!1,e.remove(),n("Upload failed. Please try again or check your web console!")},s.open("POST",this.fpdInstance.getFileServerURL()),s.send(i)}function Yi(t,e){if(K()){var i=window.localStorage.getItem(wi(this,Ei))?JSON.parse(window.localStorage.getItem(wi(this,Ei))):[],n={url:t,title:e};i.push(n),window.localStorage.setItem(wi(this,Ei),JSON.stringify(i))}}function Gi(t,e){const i=$({url:t,title:e,price:tt(this.fpdInstance,this.container),removable:!0});return xi(this,Ri,Xi).call(this,i,t),this.gridElem.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i.querySelector("picture")),G(i,["click"],(t=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(t.currentTarget,{},void 0,!1)})),G(i.querySelector(".fpd-delete"),"click",(t=>{t.stopPropagation(),t.preventDefault();const e=Array.from(this.gridElem.children).indexOf(i);if(!i.classList.contains("fpd-loading")){var n=JSON.parse(window.localStorage.getItem(wi(this,Ei)));n.splice(e,1),window.localStorage.setItem(wi(this,Ei),JSON.stringify(n)),i.xhr&&i.xhr.abort(),i.remove()}})),i}function qi(t,e){if(!wi(this,Ii)&&this.fpdInstance.mainOptions.autoFillUploadZones){const e=wi(this,Oi)[wi(this,Ai)]?wi(this,Oi)[wi(this,Ai)]:null;e&&this.fpdInstance._addGridItemToCanvas(t,{_addToUZ:e.uz},e.viewIndex,!1)}else e&&this.fpdInstance._addGridItemToCanvas(t,{},void 0,!1);wi(this,Ai)==wi(this,ki)-1&&Ci(this,Ii,!0)}function Xi(t,e){const i=this.fpdInstance.mainOptions.imageQualityRatings;if(i&&"object"==typeof i){let n=i.low?i.low:null,s=i.mid?i.mid:null,r=i.high?i.high:null,a="fpd-icon-star",o="fpd-icon-star-outline";const l=new Image;l.onload=()=>{const e=document.createElement("div");let i;if(e.className="fpd-image-quality-ratings",t.append(e),n&&2==n.length){const t=l.width<Number(n[0])||l.height<Number(n[1])?o:a,s=document.createElement("span");s.className=t,e.append(s),t==a&&(i=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_low"))}if(s&&2==s.length){const t=l.width<Number(s[0])||l.height<Number(s[1])?o:a,n=document.createElement("span");n.className=t,e.append(n),t==a&&(i=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_mid"))}if(r&&2==r.length){const t=l.width<Number(r[0])||l.height<Number(r[1])?o:a,n=document.createElement("span");n.className=t,e.append(n),t==a&&(i=this.fpdInstance.translator.getTranslation("misc","image_quality_rating_high"))}i&&(e.dataset.qualityLabel=i)},l.src=e}}window.FPDUploadsModule=Ni;class Zi extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-head"> <div class="fpd-facebook-login"> <fb:login-button data-max-rows="1" data-show-faces="false" data-scope="user_photos"> </fb:login-button> </div> <fpd-dropdown class="fpd-facebook-albums" placeholder="Select An Album" searchable></fpd-dropdown> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}function Ji(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Qi(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-facebook-images",Zi);var Ki=new WeakSet,$i=new WeakSet,tn=new WeakSet;class en extends EventTarget{constructor(t,e){super(),Ji(this,tn),Ji(this,$i),Ji(this,Ki),this.fpdInstance=t,this.container=document.createElement("fpd-module-facebook-images"),e.append(this.container),this.dropdown=this.container.querySelector("fpd-dropdown"),this.dropdownList=this.container.querySelector(".fpd-dropdown-list > .fpd-scroll-area"),this.gridElem=this.container.querySelector(".fpd-grid"),Qi(this,Ki,nn).call(this)}}function nn(){const t=document.createElement("script");t.src="//connect.facebook.com/en_US/sdk.js",t.addEventListener("load",(()=>{FB.init({appId:this.fpdInstance.mainOptions.facebookAppId,autoLogAppEvents:!0,xfbml:!0,version:"v16.0"}),FB.getLoginStatus(Qi(this,$i,sn).bind(this)),FB.Event.subscribe("auth.statusChange",Qi(this,$i,sn).bind(this))})),document.body.appendChild(t)}function sn(t){"connected"===t.status&&(X(this.container,["fpd-facebook-logged-in"]),FB.api("/me/albums?fields=name,count,id",(t=>{const e=t.data;e&&e.forEach((t=>{const e=document.createElement("span");e.className="fpd-item",e.dataset.albumid=t.id,e.innerText=t.name,e.addEventListener("click",(t=>{this.dropdown.setAttribute("value",t.currentTarget.innerText),Qi(this,tn,rn).call(this,t.currentTarget.dataset.albumid)})),this.dropdownList.append(e)})),Z(this.dropdown,["fpd-on-loading"])})))}function rn(t){this.gridElem.innerHTML="",X(this.dropdown,["fpd-on-loading"]),FB.api("/"+t+"?fields=count",(e=>{const i=e.count;FB.api("/"+t+"?fields=photos.limit("+i+").fields(source,images)",(t=>{Z(this.dropdown,["fpd-on-loading"]),t.error||t.photos.data.forEach((t=>{const e=t.images[0]?t.images[0].source:t.source,i=t.images[t.images.length-1]?t.images[t.images.length-1].source:t.source,n=$({url:e,thumbnailUrl:i,title:t.id,price:tt(this.fpdInstance,this.container)});G(n,["click"],(t=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(t.currentTarget)})),this.gridElem.append(n),this.fpdInstance.lazyBackgroundObserver.observe(n.querySelector("picture"))})),this.fpdInstance.toggleSpinner(!1)}))}))}class an extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}function on(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function ln(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cn(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-instagram-images",an);var hn=new WeakSet,dn=new WeakSet,un=new WeakSet;class fn extends EventTarget{constructor(t,e){super(),on(this,un),on(this,dn),on(this,hn),ln(this,"accessToken",null),ln(this,"nextStack",null),ln(this,"loadingStack",!1),ln(this,"scrollArea",null),this.fpdInstance=t,this.container=document.createElement("fpd-module-instagram-images"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),this.scrollArea=this.container.querySelector(".fpd-scroll-area"),this.scrollArea.addEventListener("scroll",cn(this,un,mn).bind(this))}authenticate(){const t=this.fpdInstance.mainOptions;if(K()){const t=window.localStorage.getItem("fpd_insta_access_token");if(!Q(t))return this.accessToken=t,void cn(this,dn,gn).call(this)}let e=(window.screen.width-700)/2,i=(window.screen.height-500)/2,n={app_id:t.instagramClientId,redirect_uri:t.instagramRedirectUri,scope:"user_profile,user_media",response_type:"code"},s=new URLSearchParams(n).toString();var r=window.open("https://api.instagram.com/oauth/authorize?"+s,"","width=700,height=500,left="+e+",top="+i),a=setInterval((()=>{r.closed&&clearInterval(a);try{if(r.location&&r.location.href){var t=new URL(r.location.href).searchParams.get("code");t&&(t=t.replace("#_",""),cn(this,hn,pn).call(this,t),r.close())}}catch(t){}}),500)}}function pn(t){const e=this.fpdInstance.mainOptions;this.fpdInstance.toggleSpinner(!0),Vt({url:e.instagramTokenUri,params:{code:t,client_app_id:e.instagramClientId,redirect_uri:e.instagramRedirectUri},onSuccess:t=>{t.access_token?(K()&&window.localStorage.setItem("fpd_insta_access_token",t.access_token),this.accessToken=t.access_token,cn(this,dn,gn).call(this)):t.error_message&&this.fpdInstance.toggleSpinner(!1)},onError:t=>{this.fpdInstance.toggleSpinner(!1)}})}function gn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://graph.instagram.com/me/media",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.loadingStack=!0,this.fpdInstance.toggleSpinner(!0);let i={url:t,onSuccess:t=>{t.data&&(this.nextStack=t.paging&&t.paging.next?t.paging.next:null,t.data.forEach((t=>{if("VIDEO"!==t.media_type){const e=$({url:t.media_url,thumbnailUrl:t.thumbnail_url?t.thumbnail_url:t.media_url,title:t.id,price:tt(this.fpdInstance,this.container)});G(e,["click"],(t=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(t.currentTarget)})),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture"))}}))),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1,cn(this,un,mn).call(this)},onError:t=>{t.response&&t.response.error&&t.response.error.code&&K()&&190==t.response.error.code&&(window.localStorage.removeItem("fpd_insta_access_token"),this.accessToken=null,this.authenticate()),this.fpdInstance.toggleSpinner(!1),this.loadingStack=!1}};e&&(this.gridElem.innerHTML="",i.params={fields:"id,caption,media_url,media_type",access_token:this.accessToken}),Vt(i)}function mn(){let t=this.scrollArea.scrollHeight;(this.scrollArea.clientHeight+this.scrollArea.scrollTop+100>t||this.gridElem.clientHeight<t)&&(null===this.nextStack||this.loadingStack||cn(this,dn,gn).call(this,this.nextStack,!1))}class vn extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> </div> </div> <div class="fpd-head"> <a href="https://pixabay.com/" target="_blank" class="fpd-pixabay-logo"> </a> <div class="fpd-input-search"> <input type="text" data-defaulttext="Search in Pixabay library" placeholder="modules.pixabay_search"/> <span class="fpd-icon-magnify"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}customElements.define("fpd-module-pixabay-images",vn);class bn extends EventTarget{loadingStack=!1;currentQuery="";pixabayPage=1;constructor(t,e){super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-pixabay-images"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),this.loader=this.container.querySelector(".fpd-loader-wrapper");const i=this.container.querySelector(".fpd-scroll-area");i.addEventListener("scroll",(t=>{let e=i.scrollHeight;i.clientHeight+i.scrollTop+100>e&&(this.loadingStack||(this.pixabayPage++,this.loadImages(void 0,!1)))})),G(this.container.querySelector("input"),["keypress"],(t=>{13==t.which&&(this.pixabayPage=1,this.loadImages(t.currentTarget.value))}))}loadImages(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.currentQuery===t)return!1;const i=this.fpdInstance.mainOptions;this.loadingStack=!0,this.currentQuery=void 0===t?this.currentQuery:t;var n=i.pixabayHighResImages?"&response_group=high_resolution":"",s="https://pixabay.com/api/?safesearch=true&key="+i.pixabayApiKey+"&page="+this.pixabayPage+"&per_page=40&min_width="+i.customImageParameters.minW+"&min_height="+i.customImageParameters.minH+n+"&q="+encodeURIComponent(this.currentQuery)+"&lang="+i.pixabayLang;e&&(this.gridElem.innerHTML=""),Z(this.loader,["fpd-hidden"]),Vt({url:s,onSuccess:t=>{X(this.loader,["fpd-hidden"]),t.hits.length>0&&t.hits.forEach((t=>{const e=$({url:t.imageURL?t.imageURL:t.webformatURL,thumbnailUrl:t.webformatURL,title:t.id?t.id:t.id_hash,price:tt(this.fpdInstance,this.container)});G(e,["click"],(t=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(t.currentTarget)})),this.gridElem.append(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture"))})),this.loadingStack=!1},onError:t=>{X(this.loader,["fpd-hidden"])}})}}class yn extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-head"> <div class="fpd-info" data-defaulttext="Describe your image">modules.text_to_images_info</div> <textarea placeholder="e.g. Beautiful sunset with a white sandy beach"></textarea> <span class="fpd-btn" data-defaulttext="Generate">modules.text_to_images_generate</span> </div> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-cover fpd-photo-grid"></div> </div>'}}function xn(t,e){wn(t,e),e.add(t)}function wn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cn(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function Sn(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Tn(t,e,"set"),i),i}function Tn(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}customElements.define("fpd-module-text-to-image",yn);var En=new WeakMap,An=new WeakSet,In=new WeakSet;class On extends EventTarget{constructor(t,e){var i,n;super(),xn(this,In),xn(this,An),n={writable:!0,value:!1},wn(this,i=En),i.set(this,n),this.fpdInstance=t,this.container=document.createElement("fpd-module-text-to-image"),e.append(this.container),this.inputElem=this.container.querySelector(".fpd-head textarea"),this.gridElem=this.container.querySelector(".fpd-grid"),this.container.querySelector(".fpd-head .fpd-btn").addEventListener("click",(e=>{const i=e.currentTarget;Q(this.inputElem.value)||function(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Tn(t,e,"get"))}(this,En)||(Sn(this,En,!0),i.classList.add("fpd-loading"),Ut({url:t.mainOptions.aiService.serverURL,body:{service:"text2Img",prompt:this.inputElem.value},onSuccess:e=>{e&&e.images?(Cn(this,In,Mn).call(this,e.images),e.images.forEach((t=>{if(K()){let e=window.localStorage.getItem("fpd_ai_images");e=e?JSON.parse(e):[],e.push(t),window.localStorage.setItem("fpd_ai_images",JSON.stringify(e))}}))):t.aiRequestError(e.error),Sn(this,En,!1),i.classList.remove("fpd-loading")},onError:()=>{Sn(this,En,!1),i.classList.remove("fpd-loading"),t.aiRequestError.bind(t)}}))})),G(t,"productCreate",Cn(this,An,kn).bind(this))}}function kn(){this.gridElem.innerHTML="";let t=window.localStorage.getItem("fpd_ai_images");K()&&t&&(t=JSON.parse(t),Cn(this,In,Mn).call(this,t))}function Mn(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>{const e=$({url:t,title:nt(t),price:tt(this.fpdInstance,this.container),removable:!0});this.gridElem.prepend(e),this.fpdInstance.lazyBackgroundObserver.observe(e.querySelector("picture")),G(e,["click"],(t=>{this.fpdInstance.loadingCustomImage||this.fpdInstance._addGridItemToCanvas(t.currentTarget)})),G(e.querySelector(".fpd-delete"),"click",(t=>{t.stopPropagation(),t.preventDefault();const i=Array.from(this.gridElem.children).indexOf(e);if(!e.classList.contains("fpd-loading")){let t=JSON.parse(window.localStorage.getItem("fpd_ai_images"));t.splice(i,1),window.localStorage.setItem("fpd_ai_images",JSON.stringify(t)),e.xhr&&e.xhr.abort(),e.remove()}}))}))}window.FPDTextToImageModule=On;class Pn extends EventTarget{constructor(t,e){super(),this.fpdInstance=t,this.container=document.createElement("fpd-module-images"),e.append(this.container);const i=Array.from(this.container.querySelectorAll(".fpd-module-tabs > div")),n=Array.from(this.container.querySelectorAll(".fpd-module-tabs-content > div"));let s=null,r=null;G(i,"click",(t=>{const e=t.currentTarget;Z(i,["fpd-active"]),Z(n,["fpd-active"]),X(e,["fpd-active"]),X(n.find((t=>t.dataset.context==e.dataset.context)),["fpd-active"]),"instagram"==e.dataset.context&&s&&!s.accessToken?s.authenticate():"pixabay"==e.dataset.context&&r&&r.loadImages()}));const a=t.mainOptions;new Ni(t,n.find((t=>"upload"==t.dataset.context))),G(t,["viewSelect","secondaryModuleCalled"],(e=>{const i=tt(t,this.container),n=this.container.querySelectorAll(".fpd-price");n&&(J(n,["fpd-hidden"],!Boolean(i)),n.forEach((t=>{t.innerHTML=i})))})),Q(a.facebookAppId)||(new en(t,n.find((t=>"facebook"==t.dataset.context))),i.find((t=>"facebook"==t.dataset.context)).classList.remove("fpd-hidden")),Q(a.instagramClientId)||(s=new fn(t,n.find((t=>"instagram"==t.dataset.context))),i.find((t=>"instagram"==t.dataset.context)).classList.remove("fpd-hidden")),Q(a.pixabayApiKey)||(r=new bn(t,n.find((t=>"pixabay"==t.dataset.context))),i.find((t=>"pixabay"==t.dataset.context)).classList.remove("fpd-hidden")),!Q(a.aiService.serverURL)&&a.aiService.text2Img&&(new On(t,n.find((t=>"text2Img"==t.dataset.context))),i.find((t=>"text2Img"==t.dataset.context)).classList.remove("fpd-hidden")),new me(t,n.find((t=>"qr-code"==t.dataset.context))),i.filter((t=>!t.classList.contains("fpd-hidden"))).length<2&&this.container.classList.add("fpd-hide-tabs")}}window.FPDImagesModule=Pn;class _n extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-layers" data-defaulttext="Manage Layers" data-title="modules.manage_layers"> <div class="fpd-scroll-area"> <div class="fpd-list"></div> </div> </div>'}}customElements.define("fpd-module-manage-layers",_n);const Dn=t=>{let e=!1,i=null;const n=document.createElement("div");n.className="fpd-colorpicker-wrapper";const s=new fe({parent:n,popup:!1,alpha:!1,color:o(t.initialColor).isValid()?t.initialColor:"#fff",onChange:n=>{const s=o(n.rgbaString).toHexString();e&&t.onMove&&t.onMove(s),"number"==typeof i&&clearTimeout(i),i=setTimeout((()=>{e&&t.onChange&&t.onChange(s),e=!0}),500)}});if(void 0!==window.EyeDropper){const t=s.domElement.querySelector(".picker_sample"),e=document.createElement("span");e.className="fpd-icon-color",t.append(e),G(t,"click",(t=>{(new EyeDropper).open().then((t=>{s.setColor(t.sRGBHex)})).catch((t=>{console.log(t)}))}))}if(t.palette&&Array.isArray(t.palette)){const e=Bn({colors:t.palette,colorNames:t.colorNames,onChange:e=>{t.onChange&&t.onChange(e)}});n.append(e)}return n},Ln=t=>{const e=document.createElement("div");e.className="fpd-scroll-area",(t.enablePicker||t.subPalette)&&X(e,["fpd-has-subpanel"]);const i=document.createElement("div");let n;return i.className="fpd-color-palette",e.append(i),t.colors&&Array.isArray(t.colors)&&t.colors.forEach(((e,s)=>{let r=e;if(t.colorNames){const i=t.colorNames[e.replace("#","").toLowerCase()];i&&(r=i.toUpperCase())}const a=document.createElement("span");a.className="fpd-item",a.style.backgroundColor=e,a.setAttribute("aria-label",r),a.dataset.hex=e,i.append(a),t.enablePicker||t.subPalette||X(a,["fpd-tooltip"]),G(a,"click",(r=>{if(r.stopPropagation(),t.enablePicker||t.subPalette){n&&(n.remove(),n=null);const r=a.classList.contains("fpd-active");r||(n=t.enablePicker?Dn({initialColor:e,colorNames:t.colorNames,palette:t.palette,onMove:e=>{t.onMove&&t.onMove(e,s)},onChange:e=>{a.style.backgroundColor=e,t.onChange&&t.onChange(e,s)}}):Ln({colors:t.palette,colorNames:t.colorNames,onChange:e=>{a.style.backgroundColor=e,t.onChange&&t.onChange(e,s)}}),i.append(n)),Z(i,["fpd-sub-show"]),Z(i.querySelectorAll(".fpd-item"),["fpd-active"]),r||(X(i,["fpd-sub-show"]),X(a,["fpd-active"]))}else t.onChange&&t.onChange(e)}))})),e},Bn=Ln,jn=(t,e)=>{if(!e.colors)return;const i=document.createElement("div");if(i.className="fpd-color-panel",1===e.colors.length){const n=Dn({initialColor:Mt(e.initialColor)?e.initialColor:e.colors[0],colorNames:t.mainOptions.hexNames,palette:t.mainOptions.colorPickerPalette,onMove:t=>{e.onMove&&e.onMove(t)},onChange:t=>{e.onChange&&e.onChange(t)}});i.append(n)}else{const n=Bn({colors:e.colors,colorNames:t.mainOptions.hexNames,palette:t.mainOptions.colorPickerPalette,onChange:t=>{e.onChange&&e.onChange(t)}});i.append(n)}if(e.patterns){const t=(t=>{const e=document.createElement("div");e.className="fpd-scroll-area";const i=document.createElement("div");return i.className="fpd-patterns-wrapper",e.append(i),t.images&&Array.isArray(t.images)&&t.images.forEach(((e,n)=>{const s=e.replace(/^.*[\\\/]/,"").replace(/\.[^/.]+$/,"").replace("_"," ").toUpperCase(),r=document.createElement("span");r.className="fpd-item fpd-tooltip",r.style.backgroundImage=`url("${e}")`,r.setAttribute("aria-label",s),i.append(r),G(r,"click",(i=>{t.onChange&&t.onChange(e)}))})),e})({images:e.patterns,onChange:t=>{e.onPatternChange&&e.onPatternChange(t)}});i.append(t)}return i};var Fn=i(148),Rn=i.n(Fn);function Nn(t,e){Hn(t,e),e.add(t)}function Hn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Wn(t,e,"get"))}function Wn(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Vn(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Un=new WeakMap,Yn=new WeakSet,Gn=new WeakSet,qn=new WeakSet,Xn=new WeakSet,Zn=new WeakSet,Jn=new WeakSet;class Qn extends EventTarget{constructor(t,e){var i,n;super(),Nn(this,Jn),Nn(this,Zn),Nn(this,Xn),Nn(this,qn),Nn(this,Gn),Nn(this,Yn),n={writable:!0,value:null},Hn(this,i=Un),i.set(this,n),this.fpdInstance=t,this.container=document.createElement("fpd-module-manage-layers"),e.append(this.container),this.listElem=this.container.querySelector(".fpd-list"),G(t,["elementAdd","elementRemove","viewSelect","productCreate"],(e=>{t.productCreated&&Vn(this,Yn,Kn).call(this)})),G(t,["elementModify","textLinkApply"],(e=>{if(t.productCreated){const{element:t,options:i}=e.detail,n=this.listElem.querySelector('.fpd-list-row[id="'+t.id+'"]');if(n){const t=n.querySelector("textarea");i.text&&t&&(t.value=i.text)}}})),G(t,["elementModify","elementChange"],(e=>{if(t.productCreated){const{element:t,options:i,type:n}=e.detail;(i&&i.scaleX||"scaling"==n)&&Vn(this,Jn,ns).call(this,t)}})),G(t,"elementFillChange",(e=>{if(t.productCreated){const t=e.detail.element,i=this.listElem.querySelector('.fpd-list-row[id="'+t.id+'"]');i&&i.querySelector(".fpd-current-color")&&(i.querySelector(".fpd-current-color").style.background=at(t))}}))}}function Kn(){var t,e,i;this.listElem.innerHTML="",this.fpdInstance.getElements(this.fpdInstance.currentViewIndex,"all",!1).forEach((t=>{t.checkEditable()&&Vn(this,Gn,$n).call(this,t)})),zn(this,Un)&&zn(this,Un).dispose(),t=this,e=Un,i=Rn()("vertical",{container:this.listElem,handle:"fpd-icon-reorder",item:"fpd-list-row",placeholder:"fpd-sortable-placeholder",activeItem:"fpd-sortable-dragged",closestItem:"fpd-sortable-closest",autoscroll:!0,animationMs:0,onStart:t=>{const e=window.pageYOffset||document.documentElement.scrollTop||0;window.onscroll=()=>{window.scrollTo({top:e})}},onChange:t=>{const e=this.fpdInstance.currentViewInstance.fabricCanvas,i=e.getElementByID(t.id);let n=this.listElem.querySelector(".fpd-sortable-closest"),s=e.getElementByID(n?n.id:t.id).getZIndex();n||s++,e.setElementOptions({z:s},i)},onEnd:t=>{window.onscroll=()=>{}}}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Wn(t,e,"set"),i)}function $n(t){const e=document.createElement("div");e.className="fpd-list-row",e.id=t.id;let i=document.createElement("span"),n=null;if(!t.uploadZone&&t.hasColorSelection()){n=rt(t,this.fpdInstance);const s=at(t);i.style.background=s,i.className="fpd-current-color",e.colors=n}const s=document.createElement("div");s.className="fpd-cell-0",s.append(i),e.append(s);let r=t.title;"text"===t.getType()&&t.editable&&(r=document.createElement("textarea"),r.value=t.text,G(r,"keyup",(e=>{e.stopPropagation();let i=e.target.value;i=i.replace(FancyProductDesigner.forbiddenTextChars,""),this.fpdInstance.mainOptions.disableTextEmojis&&(i=i.replace(FPDEmojisRegex,""),i=i.replace(String.fromCharCode(65039),"")),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({text:i},t)})),t.on({"editing:exited":()=>{r.value=t.text}}));const a=document.createElement("div");if(a.className="fpd-cell-1",a.append(r),t.isBitmap()){const t=document.createElement("div");t.className="fpd-img-meta",t.innerHTML='W: <span data-prop="width"></span>H: <span data-prop="height"></span>',t.innerHTML+='<div class="fpd-dpi">DPI: <span data-prop="dpi"></span></div>',a.append(t)}e.append(a);const o=document.createElement("div");if(o.className="fpd-cell-2",e.append(o),t.uploadZone){X(e,["fpd-add-layer"]);const t=document.createElement("span");t.className="fpd-icon-add",o.append(t)}else{if(t.zChangeable){const t=document.createElement("span");t.className="fpd-icon-reorder",o.append(t)}const i=t.locked?"fpd-icon-locked":"fpd-icon-unlocked",n=document.createElement("span");n.className="fpd-lock-element",n.innerHTML=`<span class="${i}"></span>`,o.append(n),G(n,"click",(i=>{i.stopPropagation(),Z(e,["fpd-show-colors"]),t.evented=!t.evented,t.locked=!t.evented;const n=i.currentTarget.querySelector("span");J(n,["fpd-icon-unlocked"],t.evented),J(n,["fpd-icon-locked"],!t.evented),J(e,["fpd-locked"],!t.evented)})),J(e,["fpd-locked"],t.locked);const s=t.visible?"fpd-icon-eye-hide":"fpd-icon-eye",r=document.createElement("span");r.className="fpd-visible-element",r.innerHTML=`<span class="${s}"></span>`,o.append(r),G(r,"click",(e=>{t.set("visible",!t.visible),t.canvas.renderAll(),J(r.querySelector("span"),["fpd-icon-eye-hide"],t.visible),J(r.querySelector("span"),["fpd-icon-eye"],!t.visible)}))}let l,c=t.removable||t.__editorMode;if(t.uploadZone&&(c=t.uploadZoneRemovable),c){const e=document.createElement("span");e.className="fpd-remove-element",e.innerHTML='<span class="fpd-icon-bin"></span>',o.append(e),G(e,"click",(e=>{e.stopPropagation(),this.fpdInstance.currentViewInstance.fabricCanvas.removeElement(t)}))}if(this.listElem.prepend(e),n){if(l=document.createElement("div"),"group"===t.type&&t.getObjects().length>1){const e=Array.isArray(t.colors)&&t.colors.length>1;let i=Bn({colors:n,colorNames:this.fpdInstance.mainOptions.hexNames,palette:t.colors,subPalette:e,enablePicker:!e,onChange:(e,i)=>{Vn(this,Zn,is).call(this,t,i,e)},onMove:(e,i)=>{t.changeObjectColor(i,e)}});l.append(i)}else l=jn(this.fpdInstance,{colors:n,patterns:Array.isArray(t.patterns)&&(t.isSVG()||"text"===t.getType())?t.patterns:null,onMove:e=>{Vn(this,qn,ts).call(this,t,e)},onChange:e=>{Vn(this,Xn,es).call(this,t,e)},onPatternChange:i=>{e.querySelector(".fpd-current-color").style.backgroundImage=`url("${i}")`,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:i},t)}});l&&(X(l,["fpd-cell-full"]),e.append(l)),G(e.querySelector(".fpd-current-color"),"click",(t=>{const i=!e.classList.contains("fpd-show-colors");Z(this.listElem.querySelectorAll(".fpd-list-row"),["fpd-show-colors"]),J(e,["fpd-show-colors"],i)}))}G(e.querySelector(".fpd-cell-1"),"click",(t=>{const e=t.currentTarget.parentNode;if(e.classList.contains("fpd-locked")||"TEXTAREA"==t.target.nodeName)return;const i=this.fpdInstance.currentViewInstance.fabricCanvas.getElementByID(e.id);i&&i.canvas.setActiveObject(i).renderAll()})),Vn(this,Jn,ns).call(this,t)}function ts(t,e){"png"!==t.isColorizable()&&t.changeColor(e)}function es(t,e){const i=this.listElem.querySelector('.fpd-list-row[id="'+t.id+'"]');i&&i.querySelector(".fpd-current-color")&&(i.querySelector(".fpd-current-color").style.background=at(t)),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:e},t)}function is(t,e,i){const n=t.changeObjectColor(e,i);this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:n},t)}function ns(t){const e=this.listElem.querySelector('.fpd-list-row[id="'+t.id+'"]');if(e&&t.isBitmap()){const i=this.fpdInstance.calcDisplaySize(t);e.querySelector('[data-prop="width"]')&&(e.querySelector('[data-prop="width"]').innerText=i.width+i.unit,e.querySelector('[data-prop="height"]').innerText=i.height+i.unit),i.dpi?e.querySelector('[data-prop="dpi"]').innerText=i.dpi:X(e,["fpd-hide-dpi"])}}window.FPDLayersModule=Qn;class ss extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-text-layers" data-defaulttext="Text Layers" data-title="modules.text_layers"> <div class="fpd-scroll-area"> <div class="fpd-list"></div> </div> </div>'}}function rs(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function as(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-text-layers",ss);var os=new WeakSet,ls=new WeakSet,cs=new WeakSet;class hs extends EventTarget{constructor(t,e){super(),rs(this,cs),rs(this,ls),rs(this,os),this.fpdInstance=t,this.container=document.createElement("fpd-module-text-layers"),e.append(this.container),this.listElem=this.container.querySelector(".fpd-list"),G(t,["elementAdd","elementRemove","viewSelect","productCreate"],(e=>{t.productCreated&&as(this,os,ds).call(this)})),G(t,["elementModify","textLinkApply"],(e=>{if(t.productCreated){const{element:t,options:i}=e.detail,n=this.listElem.querySelector('.fpd-list-row[id="'+t.id+'"]');if(n){const t=n.querySelector('[data-control="fontSize"]');i.fontSize&&t&&(t.value=i.fontSize);const e=n.querySelector("fpd-dropdown");i.fontFamily&&e&&e.setAttribute("value",i.fontFamily);const s=n.querySelector(".fpd-text-input");i.text&&s&&(s.value=i.text)}}}))}}function ds(){this.listElem.innerHTML="",this.fpdInstance.getElements(this.fpdInstance.currentViewIndex,"all",!1).forEach((t=>{t.checkEditable()&&"text"==t.getType()&&as(this,cs,fs).call(this,t)}))}function us(t,e,i){const n=document.createElement("fpd-dropdown");n.searchable=!0,e.append(n);const s=n.querySelector(".fpd-dropdown-list > .fpd-scroll-area");return t.forEach(((t,e)=>{if(!s)return;"object"==typeof t&&(t=t.name);const r=document.createElement("span");r.className="fpd-item",r.family=t,r.style.fontFamily=t,r.innerText=t,r.addEventListener("click",(e=>{n.setAttribute("value",e.currentTarget.innerText),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fontFamily:t},i)})),s.append(r)})),n}function fs(t){const e=document.createElement("div");if(e.className="fpd-list-row",e.id=t.id,this.listElem.prepend(e),t.editable){const i=document.createElement("div");i.className="fpd-cell-full fpd-title",i.innerText=t.title,e.append(i);const n=document.createElement("div");let s;n.className="fpd-cell-full",e.append(n),1==t.maxLines?(s=document.createElement("input"),s.value=t.text,n.append(s)):(s=document.createElement("textarea"),s.value=t.text,t.maxLines&&(s.rows=t.maxLines),n.append(s)),s.className="fpd-text-input";const r=document.createElement("span");r.className="fpd-clear-text",r.innerText=this.fpdInstance.translator.getTranslation("modules","text_layers_clear","Clear"),n.append(r),G(r,"click",(e=>{e.stopPropagation(),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({text:""},t),s.value=""})),t.on({"editing:exited":()=>{s.value=t.text}}),G(s,"keyup",(e=>{e.stopPropagation();let i=e.target.value;i=i.replace(FancyProductDesigner.forbiddenTextChars,""),this.fpdInstance.mainOptions.disableTextEmojis&&(i=i.replace(FPDEmojisRegex,""),i=i.replace(String.fromCharCode(65039),"")),this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({text:i},t)}));const a=Array.isArray(this.fpdInstance.mainOptions.fonts)?this.fpdInstance.mainOptions.fonts:[];if(a.length){const i=document.createElement("div");i.className="fpd-cell-1",e.append(i),as(this,ls,us).call(this,a,i,t).setAttribute("value",t.fontFamily)}}if(t.resizable||t.__editorMode){const i=document.createElement("div");i.className="fpd-cell-2",e.append(i);const n=document.createElement("input");n.className="fpd-tooltip",n.setAttribute("aria-label",this.fpdInstance.translator.getTranslation("toolbar","font_size","Font Size")),n.type="number",n.value=t.fontSize,n.dataset.control="fontSize",n.min=t.minFontSize,n.max=t.maxFontSize,i.append(n),G(n,"change",(e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fontSize:parseInt(e.currentTarget.value)},t),n.value=t.fontSize}))}if(t.hasColorSelection()){const i=document.createElement("div");i.className="fpd-cell-full",e.append(i);const n=rt(t,this.fpdInstance),s=jn(this.fpdInstance,{colors:n,patterns:Array.isArray(t.patterns)&&(t.isSVG()||"text"===t.getType())?t.patterns:null,onMove:e=>{t.changeColor(e)},onChange:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:e},t)},onPatternChange:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:e},t)}});s&&i.append(s)}}window.FPDTextLayersModule=hs;class ps extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-layouts" data-defaulttext="Layouts" data-title="modules.layouts"> <div class="fpd-scroll-area"> <div class="fpd-grid fpd-grid-contain fpd-padding"></div> </div> </div>'}}function gs(t,e){vs(t,e),e.add(t)}function ms(t,e,i){vs(t,e),e.set(t,i)}function vs(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bs(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,xs(t,e,"set"),i),i}function ys(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,xs(t,e,"get"))}function xs(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function ws(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-layouts",ps);var Cs=new WeakMap,Ss=new WeakMap,Ts=new WeakMap,Es=new WeakSet,As=new WeakSet;class Is extends EventTarget{constructor(t,e){super(),gs(this,As),gs(this,Es),ms(this,Cs,{writable:!0,value:0}),ms(this,Ss,{writable:!0,value:0}),ms(this,Ts,{writable:!0,value:!1}),this.fpdInstance=t,this.container=document.createElement("fpd-module-layouts"),e.append(this.container),this.gridElem=this.container.querySelector(".fpd-grid"),G(t,"layoutsSet",(e=>{this.layoutsData=t.currentLayouts,ws(this,As,ks).call(this)})),G(this.fpdInstance,"beforeElementAdd",ws(this,Es,Os).bind(this))}}function Os(t){const e=t.detail.element;if(ys(this,Ts)){var i;bs(this,Cs,(i=ys(this,Cs),++i));const t=e.title+"<br>"+String(ys(this,Cs))+"/"+ys(this,Ss);this.fpdInstance.mainLoader.querySelector(".fpd-loader-text").innerHTML=t}}function ks(){this.gridElem.innerHTML="",Array.isArray(this.layoutsData)&&this.layoutsData.forEach((e=>{const i=$({url:e.thumbnail,title:e.title,disablePrice:!0,disableDraggable:!0});G(i,"click",(i=>{if(!this.fpdInstance.productCreated)return;var n=t(this.fpdInstance.translator.getTranslation("modules","layouts_confirm_replacement","Yes, please!"),!1,"confirm",this.fpdInstance.container);const s=n.querySelector(".fpd-confirm");s.innerText=this.fpdInstance.translator.getTranslation("modules","layouts_confirm_button","Sure?"),G(s,"click",(()=>{bs(this,Cs,0),bs(this,Ss,e.elements.length),this.fpdInstance.globalCustomElements=[],this.fpdInstance.mainOptions.replaceInitialElements&&(this.fpdInstance.globalCustomElements=this.fpdInstance.getCustomElements()),this.fpdInstance.deselectElement(),this.fpdInstance.toggleSpinner(!0),bs(this,Ts,!0);const t={};N(e.options)&&Ht.relevantOptions.forEach((i=>{void 0!==e.options[i]&&(t[i]=e.options[i])})),this.fpdInstance.currentViewInstance.options={...this.fpdInstance.currentViewInstance.options,...t},this.fpdInstance.currentViewInstance.fabricCanvas.viewOptions=this.fpdInstance.currentViewInstance.options,this.fpdInstance.currentViewInstance.loadElements(e.elements,(()=>{bs(this,Ts,!1),this.fpdInstance.toggleSpinner(!1),this.fpdInstance.dispatchEvent(new CustomEvent("layoutElementsAdded",{detail:{layoutView:e}})),this.fpdInstance.currentViewInstance.fabricCanvas._renderPrintingBox(),this.fpdInstance.currentViewInstance.fabricCanvas.resetSize()})),n.remove()}))})),this.gridElem.append(i),this.fpdInstance.lazyBackgroundObserver.observe(i.querySelector("picture"))}))}window.FPDLayoutsModule=Is;class Ms extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div data-moduleicon="fpd-icon-name-number" data-defaulttext="Names & Numbers" data-title="modules.names_numbers"> <div class="fpd-head"> <span class="fpd-btn" data-defaulttext="Add New">modules.names_numbers_add_new</span> </div> <div class="fpd-scroll-area"> <div class="fpd-list"></div> </div> </div>'}}function Ps(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function _s(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-module-names-numbers",Ms);var Ds=new WeakSet,Ls=new WeakSet,Bs=new WeakSet,js=new WeakSet,Fs=new WeakSet,Rs=new WeakSet,Ns=new WeakSet;class Hs extends EventTarget{constructor(t,e){super(),Ps(this,Ns),Ps(this,Rs),Ps(this,Fs),Ps(this,js),Ps(this,Bs),Ps(this,Ls),Ps(this,Ds),this.fpdInstance=t,this.container=document.createElement("fpd-module-names-numbers"),e.append(this.container),this.listElem=this.container.querySelector(".fpd-list"),G(t,"viewSelect",(t=>{_s(this,Ls,Ws).call(this)})),G(this.container.querySelector(".fpd-btn"),"click",(e=>{const i=_s(this,Bs,Vs).call(this);_s(this,Ds,zs).call(this,i),t.currentViewInstance.names_numbers=this.getViewNamesNumbers(),t.mainOptions.namesNumbersEntryPrice&&t.currentViewInstance.changePrice(t.mainOptions.namesNumbersEntryPrice,"+")}))}getViewNamesNumbers(){let t=[];return this.container.querySelectorAll(".fpd-list .fpd-row").forEach((e=>{let i={};const n=e.querySelector(".fpd-number-col");n&&(i.number=n.querySelector("input").value);const s=e.querySelector(".fpd-name-col");s&&(i.name=s.querySelector("input").value);const r=e.querySelector(".fpd-select-col");r&&(i.select=r.querySelector("select").value),t.push(i)})),t}}function zs(t){t.querySelector("input").focus();const e=t.querySelector(".fpd-number-col");e&&_s(this,Ns,qs).call(this,e.querySelector("input").value||e.querySelector("input").placeholder);const i=t.querySelector(".fpd-name-col");i&&_s(this,Ns,qs).call(this,null,i.querySelector("input").value||i.querySelector("input").placeholder)}function Ws(){this.listElem.innerHTML="";const t=this.fpdInstance.currentViewInstance;t.fabricCanvas.textPlaceholder||t.fabricCanvas.numberPlaceholder?(t.names_numbers&&Array.isArray(t.names_numbers)?t.names_numbers.forEach((t=>{_s(this,Bs,Vs).call(this,t.number,t.name,t.select)})):_s(this,Bs,Vs).call(this),Z(this.container,["fpd-disabled"])):X(this.container,["fpd-disabled"])}function Vs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;const n=this.fpdInstance.currentViewInstance.fabricCanvas,s=document.createElement("div");s.className="fpd-row";const r=document.createElement("div");r.className="fpd-remove-col";const a=document.createElement("span");return a.innerText=this.fpdInstance.translator.getTranslation("modules","names_numbers_remove","Remove"),r.append(a),G(a,"click",(t=>{s.remove(),_s(this,Ds,zs).call(this,this.container.querySelector(".fpd-row:first-child")),this.fpdInstance.currentViewInstance.names_numbers=this.getViewNamesNumbers(),this.fpdInstance.mainOptions.namesNumbersEntryPrice&&this.fpdInstance.currentViewInstance.changePrice(this.fpdInstance.mainOptions.namesNumbersEntryPrice,"-")})),s.append(r),n.numberPlaceholder&&s.append(_s(this,js,Us).call(this,t)),n.textPlaceholder&&s.append(_s(this,Fs,Ys).call(this,e)),(this.fpdInstance.mainOptions.namesNumbersDropdown&&this.fpdInstance.mainOptions.namesNumbersDropdown.length>0||i)&&s.append(_s(this,Rs,Gs).call(this,i)),this.listElem.append(s),s}function Us(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=this.fpdInstance.currentViewInstance.fabricCanvas,i=document.createElement("div");i.className="fpd-number-col fpd-input-col";const n=document.createElement("input");return n.type="number",i.append(n),Array.isArray(e.numberPlaceholder.numberPlaceholder)&&(n.setAttribute("min",Number(e.numberPlaceholder.numberPlaceholder[0])),n.setAttribute("max",Number(e.numberPlaceholder.numberPlaceholder[1]))),n.setAttribute("placeholder",e.numberPlaceholder.originParams.text),n.value=t,G(n,["mouseup","keyup"],(t=>{Array.isArray(e.numberPlaceholder.numberPlaceholder)&&(n.value>Number(n.max)&&(n.value=Number(n.max)),n.value<Number(n.min)&&(n.value=Number(n.min))),n.value=_s(this,Ns,qs).call(this,n.value),this.fpdInstance.currentViewInstance.names_numbers=this.getViewNamesNumbers()})),i}function Ys(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=this.fpdInstance.currentViewInstance.fabricCanvas,i=document.createElement("div");i.className="fpd-name-col fpd-input-col";const n=document.createElement("input");return n.type="text",i.append(n),n.setAttribute("placeholder",e.textPlaceholder.originParams.text),n.value=t,G(n,["mouseup","keyup"],(t=>{n.value=_s(this,Ns,qs).call(this,null,n.value),this.fpdInstance.currentViewInstance.names_numbers=this.getViewNamesNumbers()})),i}function Gs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=document.createElement("div");e.className="fpd-select-col fpd-input-col";const i=document.createElement("select");e.append(i);let n=[t];return(this.fpdInstance.mainOptions.namesNumbersDropdown.length>0?this.fpdInstance.mainOptions.namesNumbersDropdown:n).forEach((e=>{const n=document.createElement("option");n.value=e,n.selected=t===e,n.innerText=e,i.append(n)})),G(i,"change",(t=>{this.fpdInstance.currentViewInstance.names_numbers=this.getViewNamesNumbers()})),e}function qs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=this.fpdInstance.currentViewInstance.fabricCanvas,n="string"==typeof t?i.numberPlaceholder:i.textPlaceholder;let s="string"==typeof t?t:e;const r=n.maxLength;return 0!=r&&s.length>r&&(s=s.substr(0,r)),s=s.replace(FancyProductDesigner.forbiddenTextChars,""),this.fpdInstance.mainOptions.disableTextEmojis&&(s=s.replace(FPDEmojisRegex,""),s=s.replace(String.fromCharCode(65039),"")),i.setElementOptions({text:s},n),s}window.FPDNamesNumbersModule=Hs;class Xs extends EventTarget{constructor(t,e,i){let n;if(super(),"products"===i)n=new We(t,e);else if("text"===i)n=new Ge(t,e);else if(i.includes("designs")){let r=null;if(i.includes("designs_")&&!Q(t.mainOptions.dynamicDesigns)){if(r=i.split("_").pop(),!r||!t.mainOptions.dynamicDesigns[r])return;{var s=t.mainOptions.dynamicDesigns[r];const e={};e["data-dynamic-designs-id"]=r,this.configs={icon:!Q(s.icon)&&s.icon.includes(".svg")?s.icon:"fpd-icon-design-library",defaultText:s.name,attrs:e}}}n=new hi(t,e,r)}else"images"===i?n=new Pn(t,e):"manage-layers"===i?n=new Qn(t,e):"save-load"===i?n=new Ce(t,e):"text-layers"===i?n=new hs(t,e):"layouts"===i?n=new Is(t,e):"names-numbers"===i&&(n=new Hs(t,e));if(FancyProductDesigner.additionalModules&&!n){const s=FancyProductDesigner.additionalModules[i];s&&(n=new s(t,e))}if(n&&(this.moduleInstance=n,t["moduleInstance_"+i]=n,!i.includes("designs_"))){const t=n.container.querySelector("div");this.configs={icon:t.dataset.moduleicon,langId:t.dataset.title,langKeys:t.dataset.title.split("."),defaultText:t.dataset.defaulttext}}}}function Zs(t,e){Qs(t,e),e.add(t)}function Js(t,e,i){Qs(t,e),e.set(t,i)}function Qs(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function $s(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}function tr(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ir(t,e,"get"))}function er(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,ir(t,e,"set"),i),i}function ir(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var nr=new WeakMap,sr=new WeakMap,rr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakMap,cr=new WeakMap,hr=new WeakMap,dr=new WeakMap,ur=new WeakSet,fr=new WeakSet,pr=new WeakSet,gr=new WeakSet,mr=new WeakSet,vr=new WeakSet;class br extends EventTarget{constructor(t){super(),Zs(this,vr),Zs(this,mr),Zs(this,gr),Zs(this,pr),Zs(this,fr),Zs(this,ur),Js(this,nr,{writable:!0,value:null}),Js(this,sr,{writable:!0,value:null}),Js(this,rr,{writable:!0,value:!1}),Js(this,ar,{writable:!0,value:0}),Js(this,or,{writable:!0,value:0}),Js(this,lr,{writable:!0,value:0}),Js(this,cr,{writable:!0,value:0}),Js(this,hr,{writable:!0,value:!1}),Js(this,dr,{writable:!0,value:!1}),Ks(this,"contentElem",null),Ks(this,"navElem",null),Ks(this,"currentModuleKey",""),Ks(this,"currentModules",[]),this.fpdInstance=t;const e=t.container;if(this.container=document.createElement("fpd-main-bar"),t.mainOptions.mainBarContainer&&!t.mainOptions.modalMode){const i=document.querySelector(t.mainOptions.mainBarContainer);i?(Z(e,["fpd-off-canvas","fpd-topbar"]),X(e,["fpd-main-bar-container-enabled","fpd-sidebar"]),X(i,["fpd-container","fpd-main-bar-container","fpd-sidebar"]),i.append(this.container)):e.append(this.container)}else e.append(this.container);if(this.contentElem=this.container.querySelector(".fpd-module-content"),this.navElem=this.container.querySelector(".fpd-navigation"),this.secContent=this.container.querySelector(".fpd-secondary-content"),er(this,nr,document.querySelector(this.fpdInstance.mainOptions.modalMode?".fpd-modal-product-designer":"body")),er(this,sr,document.querySelector(".fpd-draggable-dialog")),tr(this,nr).append(tr(this,sr)),G(tr(this,sr),["mousedown","touchstart"],$s(this,ur,yr).bind(this)),G(document,["mouseup","touchend"],$s(this,pr,wr).bind(this)),G(document,["mousemove","touchmove"],$s(this,fr,xr).bind(this)),G(tr(this,sr).querySelector(".fpd-close-dialog"),["click","touchstart"],$s(this,mr,Sr).bind(this)),G(this.container.querySelector(".fpd-close"),["click","touchmove"],$s(this,mr,Sr).bind(this)),G(t,"viewSelect",$s(this,vr,Tr).bind(this)),e.classList.contains("fpd-off-canvas")){let t=0,e=0,i=0;this.contentElem.addEventListener("touchstart",(i=>{t=i.touches[0].pageX,e=i.touches[0].pageY,X(this.container,["fpd-is-dragging"])})),this.contentElem.addEventListener("touchmove",(n=>{let s=n.touches[0].pageX,r=n.touches[0].pageY;i=t-s;let a=e-r;Math.abs(i)>Math.abs(a)&&(i=Math.abs(i)<0?0:Math.abs(i),this.contentElem.style.left=-i+"px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth-i+"px",n.preventDefault())})),this.contentElem.addEventListener("touchend",(t=>{Math.abs(i)>100?this.toggleContentDisplay(!1):(this.contentElem.style.left="0px",this.contentElem.previousElementSibling.style.left=this.contentElem.clientWidth+"px"),i=0,Z(this.container,["fpd-is-dragging"])}))}this.updateContentWrapper(),this.setup(t.mainOptions.mainBarModules),this.fpdInstance.translator.translateArea(this.container),tr(this,hr)&&this.fpdInstance.translator.translateArea(tr(this,sr))}callModule(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Z(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),Z(Array.from(this.contentElem.children),["fpd-active"]),i)e=X(this.navElem.querySelector('.fpd-nav-item[data-dynamic-designs-id="'+i+'"]'),["fpd-active"]),X(this.contentElem.querySelector('[data-dynamic-designs-id="'+i+'"]'),["fpd-active"]);else{e=X(this.navElem.querySelector('.fpd-nav-item[data-module="'+t+'"]'),["fpd-active"]);const i=this.contentElem.querySelector("fpd-module-"+t);X(i,["fpd-active"]),"text"==t&&i.querySelector("textarea").focus()}this.toggleContentDisplay(),this.currentModuleKey=t,this.fpdInstance.dispatchEvent(new CustomEvent("moduleCalled",{detail:{moduleName:t}}))}callSecondary(t){Z(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),X(this.secContent.querySelector(".fpd-"+t),["fpd-active"]),X([this.fpdInstance.container,tr(this,sr)],["fpd-secondary-visible"]),this.fpdInstance.dispatchEvent(new CustomEvent("secondaryModuleCalled",{detail:{moduleName:t}}))}get contentClosable(){const t=this.fpdInstance.container;return tr(this,dr)||tr(this,hr)||t.classList.contains("fpd-layout-small")}toggleContentDisplay(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Z([this.fpdInstance.container,tr(this,sr)],["fpd-secondary-visible"]),J([this.fpdInstance.container,tr(this,sr)],["fpd-module-visible"],t),this.contentClosable&&(t||Z(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"])),tr(this,dr)?(!t&&this.currentModuleKey.length&&this.fpdInstance.deselectElement(),this.contentElem.style.removeProperty("left"),this.contentElem.previousElementSibling.style.removeProperty("left"),this.container.style.setProperty("--fpd-content-height",this.fpdInstance.mainWrapper.container.clientHeight+"px"),J(this.container,["fpd-show"],t)):tr(this,hr)&&(t&&(tr(this,sr).querySelector(".fpd-dialog-title").innerText=this.navElem.querySelector(".fpd-nav-item.fpd-active .fpd-label").innerText),J(tr(this,sr),["fpd-show"],t)),!t&&this.contentClosable&&(this.currentModuleKey=""),!t&&this.fpdInstance.currentViewInstance&&(this.fpdInstance.currentViewInstance.currentUploadZone=null)}updateContentWrapper(){const t=this.fpdInstance.container;this.toggleContentDisplay(!1),er(this,dr,!1),er(this,hr,!1),Z(this.navElem.querySelectorAll(".fpd-nav-item"),["fpd-active"]),t.classList.contains("fpd-off-canvas")?(er(this,dr,!0),this.container.append(this.contentElem)):t.classList.contains("fpd-sidebar")?this.container.append(this.contentElem):(er(this,hr,!0),tr(this,sr).append(this.contentElem),tr(this,sr).append(this.secContent),this.fpdInstance.translator.translateArea(tr(this,sr))),this.fpdInstance.translator.translateArea(this.container)}toggleUploadZonePanel(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.fpdInstance.loadingCustomImage){if(t){tr(this,hr)&&(tr(this,sr).querySelector(".fpd-dialog-title").innerText=""),J(this.uploadZoneNavItems.find((t=>t.classList.contains("fpd-add-image"))),["fpd-hidden"],!Boolean(e.uploads)),J(this.uploadZoneNavItems.find((t=>t.classList.contains("fpd-add-text"))),["fpd-hidden"],!Boolean(e.texts)),J(this.uploadZoneNavItems.find((t=>t.classList.contains("fpd-add-design"))),["fpd-hidden"],!Boolean(e.designs)),this.fpdInstance.UZmoduleInstance_designs&&this.fpdInstance.UZmoduleInstance_designs.toggleCategories();const t=this.uploadZoneNavItems.find((t=>!t.classList.contains("fpd-hidden")));t&&t.click(),this.callSecondary("upload-zone-panel")}else this.fpdInstance.currentViewInstance.currentUploadZone=null;J([this.fpdInstance.container,tr(this,sr)],["fpd-secondary-visible"],t),tr(this,hr)&&J(tr(this,sr),["fpd-show"],t)}}setup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.currentModules=[];let e=this.fpdInstance.mainOptions.initialActiveModule?this.fpdInstance.mainOptions.initialActiveModule:"";const i=this.container.querySelector(".fpd-navigation");0!=t.length||this.fpdInstance.mainOptions.editorMode?1!=t.length||this.fpdInstance.container.classList.contains("fpd-topbar")||this.fpdInstance.mainOptions.editorMode?this.fpdInstance.container.classList.contains("fpd-sidebar")&&""==e?e=t[0]?t[0]:"":i.classList.remove("fpd-hidden"):(e=t[0]?t[0]:"",X(this.fpdInstance.container,["fpd-one-module-mode"])):X(this.fpdInstance.container,["fpd-no-modules-mode"]),i.innerHTML=this.contentElem.innerHTML="",FancyProductDesigner.additionalModules&&Object.keys(FancyProductDesigner.additionalModules).forEach((e=>{t.push(e)})),t.forEach((t=>{let e="";const n=new Xs(this.fpdInstance,this.contentElem,t);if(!n.moduleInstance||!n.configs)return;this.currentModules.push(t);const s=document.createElement("div");s.classList.add("fpd-nav-item"),s.dataset.module=t,s.addEventListener("click",$s(this,gr,Cr).bind(this)),i.appendChild(s);let r=document.createElement("span");if("string"==typeof n.configs.icon&&n.configs.icon.includes(".svg")?(a={url:n.configs.icon,onSuccess:t=>{r.innerHTML=t},onError:t=>{console.log(t)}},fetch(a.url).then((t=>{t.ok?t.text().then((t=>{a.onSuccess&&a.onSuccess(t)})):t.text().then((t=>{a.onError&&a.onError(t)}))}))):(r.classList.add("fpd-nav-icon"),r.classList.add(n.configs.icon)),s.append(r),n.configs.langKeys){const t=n.configs.langKeys;e=this.fpdInstance.translator.getTranslation(t[0],t[1],n.configs.defaultText)}else n.configs.defaultText&&(e=n.configs.defaultText);var a;const o=document.createElement("span");if(o.className="fpd-label",o.innerText=e,s.append(o),n.configs.attrs)for(const[t,e]of Object.entries(n.configs.attrs))s.setAttribute(t,e)}));const n=i.querySelector(`[data-module="${e}"]`);if(!this.contentClosable&&n&&n.click(),this.uploadZoneContent=this.secContent.querySelector(".fpd-upload-zone-content"),!this.fpdInstance.mainOptions.editorMode){const t=new Xs(this.fpdInstance,this.uploadZoneContent,"images");this.fpdInstance.UZmoduleInstance_images=t.moduleInstance;const e=new Xs(this.fpdInstance,this.uploadZoneContent,"text");this.fpdInstance.UZmoduleInstance_text=e.moduleInstance;const i=new Xs(this.fpdInstance,this.uploadZoneContent,"designs");this.fpdInstance.UZmoduleInstance_designs=i.moduleInstance}this.uploadZoneNavItems=Array.from(this.secContent.querySelectorAll(".fpd-upload-zone-panel .fpd-bottom-nav > div")),G(this.uploadZoneNavItems,"click",(t=>{Z(this.uploadZoneNavItems,["fpd-active"]),X(t.currentTarget,["fpd-active"]),Z(Array.from(this.uploadZoneContent.children),["fpd-active"]),X(this.uploadZoneContent.querySelector("fpd-module-"+t.currentTarget.dataset.module),["fpd-active"])})),this.fpdInstance.translator.translateArea(this.container)}}function yr(t){tr(this,sr).querySelector(".fpd-dialog-drag-handle").contains(t.target)&&(t.preventDefault(),er(this,rr,!0),er(this,ar,t.touches?event.touches[0].clientX:t.clientX),er(this,or,t.touches?event.touches[0].clientY:t.clientY),er(this,lr,tr(this,ar)-tr(this,sr).offsetLeft),er(this,cr,tr(this,or)-tr(this,sr).offsetTop))}function xr(t){if(!tr(this,rr))return;const e=tr(this,nr).clientWidth<window.innerWidth?window.innerWidth:tr(this,nr).clientWidth,i=tr(this,nr).clientHeight<window.innerHeight?window.innerHeight:tr(this,nr).clientHeight,n=e-tr(this,sr).clientWidth,s=i-tr(this,sr).clientHeight,r=t.touches?event.touches[0].clientX:t.clientX;let a=(t.touches?event.touches[0].clientY:t.clientY)-tr(this,cr),o=r-tr(this,lr);o<0&&(o=0),a<0&&(a=0),o>n&&(o=n),a>s&&(a=s),tr(this,sr).style.top=a+"px",tr(this,sr).style.left=o+"px"}function wr(t){er(this,rr,!1)}function Cr(t){t.stopPropagation(),this.fpdInstance.deselectElement(),this.fpdInstance.currentViewInstance&&(this.fpdInstance.currentViewInstance.currentUploadZone=null),t.currentTarget.classList.contains("fpd-active")&&this.contentClosable?this.toggleContentDisplay(!1):this.callModule(t.currentTarget.dataset.module,t.currentTarget.dataset.dynamicDesignsId),this.fpdInstance.dispatchEvent(new CustomEvent("navItemSelect",{detail:{item:t.currentTarget}}))}function Sr(t){if(t.preventDefault(),document.body.classList.contains("fpd-toolbar-visible")&&this.fpdInstance.container.classList.contains("fpd-sidebar"))return this.fpdInstance.toolbar.toggle(!1),void this.fpdInstance.deselectElement();this.fpdInstance.currentViewInstance&&this.fpdInstance.currentViewInstance.currentUploadZone&&this.fpdInstance.currentViewInstance.fabricCanvas.deselectElement(),this.toggleContentDisplay(!1)}function Tr(){const t=this.fpdInstance.currentViewInstance,e=t.options.customAdds;J(document.querySelectorAll('.fpd-nav-item[data-module^="designs"], fpd-module-designs'),["fpd-disabled"],!e.designs),J(document.querySelectorAll('.fpd-nav-item[data-module="images"], fpd-module-images'),["fpd-disabled"],!e.uploads),J(document.querySelectorAll('.fpd-nav-item[data-module="text-to-image"]'),["fpd-disabled"],!e.uploads),J(document.querySelectorAll('.fpd-nav-item[data-module="text"], fpd-module-text'),["fpd-disabled"],!e.texts),J(document.querySelectorAll('.fpd-nav-item[data-module="names-numbers"], fpd-module-names-numbers'),["fpd-disabled"],!t.fabricCanvas.textPlaceholder&&!t.fabricCanvas.numberPlaceholder),this.contentClosable||document.querySelectorAll('.fpd-nav-item[data-module="'+this.currentModuleKey+'"]').forEach((t=>{if(t.classList.contains("fpd-disabled")){const t=this.navElem.querySelector(".fpd-nav-item:not(.fpd-disabled)");t&&this.callModule(t.dataset.module)}})),this.toggleContentDisplay(!1)}Ks(br,"availableModules",["products","images","text","designs","manage-layers","text-layers","layouts","save-load","names-numbers"]),window.FPDMainBar=br;class Er extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-product-stage"></div> <div class="fpd-warnings"></div> <div class="fpd-advanced-image-editor fpd-hidden"> <canvas></canvas> <span class="fpd-close"><span class="fpd-icon-close"></span></span> <span class="fpd-done"><span class="fpd-icon-done"></span></span> </div>'}}customElements.define("fpd-main-wrapper",Er);class Ar{constructor(t){this.container=document.createElement("fpd-main-wrapper"),t.container.append(this.container)}}class Ir extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-view-edit-size fpd-hidden"> <label class="fpd-input"> <span>W</span> <input type="number" min="1" step="1" data-type="width" class="fpd-tooltip"> </label> <label class="fpd-input fpd-tooltip"> <span>H</span> <input type="number" min="1" step="1" data-type="height" class="fpd-tooltip"> </label> </div> <div class="fpd-view-locker"> <span class="fpd-icon-locked"></span> <span class="fpd-icon-unlocked fpd-hidden"></span> </div> <div class="fpd-view-prev"> <span class="fpd-icon-forward"></span> </div> <div class="fpd-show-views-grid"> <span class="fpd-icon-pages"></span> <span class="fpd-current-view">0</span> <span class="fpd-total-views">0</span> </div> <div class="fpd-view-next"> <span class="fpd-icon-forward"></span> </div> '}}function Or(t,e,i){kr(t,e),e.set(t,i)}function kr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e){var i=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e);return function(t,e){return e.get?e.get.call(t):e.value}(t,i)}function Pr(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-views-nav",Ir);var _r=new WeakMap,Dr=new WeakMap,Lr=new WeakSet;class Br extends EventTarget{constructor(t){var e;super(),kr(this,e=Lr),e.add(this),Or(this,_r,{writable:!0,value:1e3}),Or(this,Dr,{writable:!0,value:100}),this.fpdInstance=t,this.container=document.createElement("fpd-views-nav"),this.unitFormat=t.mainOptions.dynamicViewsOptions.unit,this.minWidth=parseInt(t.mainOptions.dynamicViewsOptions.minWidth),this.minHeight=parseInt(t.mainOptions.dynamicViewsOptions.minHeight),this.maxWidth=parseInt(t.mainOptions.dynamicViewsOptions.maxWidth),this.maxHeight=parseInt(t.mainOptions.dynamicViewsOptions.maxHeight),t.mainWrapper.container.append(this.container);let i=null;if(Boolean(t.mainOptions.enableDynamicViews)){i=this.container.querySelector(".fpd-view-edit-size"),Z(i,["fpd-hidden"]);const t=i.querySelector('[data-type="width"]');t.setAttribute("aria-label",this.minWidth+this.unitFormat+" - "+this.maxWidth+this.unitFormat),t.setAttribute("placeholder",this.minWidth+this.unitFormat+" - "+this.maxWidth+this.unitFormat);const e=i.querySelector('[data-type="height"]');e.setAttribute("aria-label",this.minHeight+this.unitFormat+" - "+this.maxHeight+this.unitFormat),e.setAttribute("placeholder",this.minHeight+this.unitFormat+" - "+this.maxHeight+this.unitFormat)}G(t,["viewCreate","viewRemove"],(e=>{this.container.querySelector(".fpd-total-views").innerText=t.viewInstances.length})),G(t,["viewSelect"],(e=>{if(J(this.container.querySelector(".fpd-view-locker"),["fpd-hidden"],!t.currentViewInstance.options.optionalView),this.container.querySelector(".fpd-current-view").innerText=t.currentViewIndex+1,Pr(this,Lr,jr).call(this,t.currentViewInstance),i){const e=t.currentViewInstance;let n=ct(e.options.stageWidth,this.unitFormat),s=ct(e.options.stageHeight,this.unitFormat);H(e.options.output,["width","height"])&&(n=e.options.output.width,s=e.options.output.height);const r=i.querySelector('[data-type="width"]'),a=i.querySelector('[data-type="height"]');r.min=this.minWidth,r.max=this.maxWidth,r.value=n,a.min=this.minHeight,a.max=this.maxHeight,a.value=s}})),G(this.container.querySelector(".fpd-view-prev"),"click",(e=>{t.selectView(t.currentViewIndex-1)})),G(this.container.querySelector(".fpd-view-next"),"click",(e=>{t.selectView(t.currentViewIndex+1)})),G(this.container.querySelector(".fpd-show-views-grid"),"click",(e=>{t.deselectElement(),J(t.viewsGrid.container,["fpd-show"],!0)})),G(this.container.querySelector(".fpd-view-locker"),"click",(e=>{t.currentViewInstance&&(t.deselectElement(),t.currentViewInstance.toggleLock(!t.currentViewInstance.locked),Pr(this,Lr,jr).call(this,t.currentViewInstance),t.currentViewInstance.locked||n(t.translator.getTranslation("misc","view_unlocked_info","The view is unlocked")))})),i&&G(i.querySelectorAll("input"),"change",(e=>{const n=e.currentTarget;this.checkDimensionLimits(n.dataset.type,n);const s=t.currentViewInstance;let r=lt(i.querySelector('[data-type="width"]').value,this.unitFormat),a=lt(i.querySelector('[data-type="height"]').value,this.unitFormat),o=this.calcPageOptions(r,a);s.options=z(s.options,o),s.fabricCanvas.viewOptions=s.options,s.fabricCanvas._renderPrintingBox(),s.fabricCanvas.resetSize(),this.doPricing(s)}))}checkDimensionLimits(t,e){let i=parseInt(e.value);return"width"==t?i<this.minWidth?i=this.minWidth:i>this.maxWidth&&(i=this.maxWidth):i<this.minHeight?i=this.minHeight:i>this.maxHeight&&(i=this.maxHeight),e.value=i,i}calcPageOptions(t,e){let i=Math.min((Mr(this,_r)-Mr(this,Dr))/t,(Mr(this,_r)-Mr(this,Dr))/e);const n=parseInt(t*i),s=parseInt(e*i);return{stageWidth:n+Mr(this,Dr),stageHeight:s+Mr(this,Dr),printingBox:{width:n,height:s,left:(n+Mr(this,Dr))/2-n/2,top:(s+Mr(this,Dr))/2-s/2,visibility:!0},usePrintingBoxAsBounding:!0,output:{width:ct(t,"mm"),height:ct(e,"mm")}}}doPricing(t){if(t&&this.fpdInstance.mainOptions.dynamicViewsOptions.pricePerArea){let e=ct(t.options.stageWidth,"cm"),i=ct(t.options.stageHeight,"cm");H(t.options.output,["width","height"])&&(e=t.options.output.width/10,i=t.options.output.height/10);let n=Math.ceil(e*i)*Number(this.fpdInstance.mainOptions.dynamicViewsOptions.pricePerArea);t.changePrice(0,"+",n)}}}function jr(t){const e=this.container.querySelector(".fpd-view-locker");J(e.querySelector(".fpd-icon-locked"),["fpd-hidden"],!t.locked),J(e.querySelector(".fpd-icon-unlocked"),["fpd-hidden"],t.locked)}class Fr extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-head"> <span class="fpd-btn fpd-add-blank fpd-hidden" data-defaulttext="Add Blank Page">misc.dynamic_views_add_blank</span> <span class="fpd-btn fpd-add-layout" data-defaulttext="Add Page from Layouts">misc.dynamic_views_add_from_layouts</span> <div class="fpd-close"> <span class="fpd-icon-close"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid"></div> </div> <div class="fpd-blank-page-modal fpd-shadow-1 fpd-hidden"> <div class="fpd-head"> <label class="fpd-input"> <span data-defaulttext="Width">misc.dynamic_views_width</span> <input type="number" min="1" step="1" data-type="width" class="fpd-tooltip"> </label> <label class="fpd-input"> <span data-defaulttext="Height">misc.dynamic_views_height</span> <input type="number" min="1" step="1" data-type="height" class="fpd-tooltip"> </label> <span class="fpd-btn" data-defaulttext="Add Page">misc.dynamic_views_add_view</span> <div class="fpd-close"> <span class="fpd-icon-close"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid"></div> </div> </div> <div class="fpd-layouts-modal fpd-shadow-1 fpd-hidden"> <div class="fpd-head"> <div class="fpd-close"> <span class="fpd-icon-close"></span> </div> </div> <div class="fpd-scroll-area"> <div class="fpd-grid"></div> </div> </div> '}}function Rr(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Nr(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}customElements.define("fpd-views-grid",Fr);var Hr=new WeakSet,zr=new WeakSet,Wr=new WeakSet;class Vr extends EventTarget{constructor(t){if(super(),Rr(this,Wr),Rr(this,zr),Rr(this,Hr),this.fpdInstance=t,this.formats=t.mainOptions.dynamicViewsOptions.formats,this.currentLayouts=[],this.container=document.createElement("fpd-views-grid"),t.container.append(this.container),J(t.container,["fpd-dynamic-views-enabled"],t.mainOptions.enableDynamicViews),this.gridElem=this.container.querySelector(".fpd-grid"),this.blankPageModal=this.container.querySelector(".fpd-blank-page-modal"),this.layoutsModal=this.container.querySelector(".fpd-layouts-modal"),t.mainOptions.enableDynamicViews){let e;this.blankPageCustomWidthInput=this.blankPageModal.querySelectorAll(".fpd-head input")[0],this.blankPageCustomHeightInput=this.blankPageModal.querySelectorAll(".fpd-head input")[1],this.blankPageCustomWidthInput.setAttribute("placeholder",this.fpdInstance.viewsNav.unitFormat),this.blankPageCustomHeightInput.setAttribute("placeholder",this.fpdInstance.viewsNav.unitFormat),Array.isArray(this.formats)&&this.formats.length&&(Z(this.container.querySelector(".fpd-btn.fpd-add-blank"),["fpd-hidden"]),this.formats.forEach((t=>{const e=t[0],i=t[1],n=150;let s,r;e>i?(s=n,r=n/e*i):(r=n,s=n/i*e);const a=document.createElement("div");a.className="fpd-shadow-1 fpd-item",a.innerHTML="<span>"+e+"x"+i+"<br>"+this.fpdInstance.viewsNav.unitFormat+"</span>",a.style.width=s+"px",a.style.height=r+"px",this.blankPageModal.querySelector(".fpd-grid").append(a),G(a,"click",(t=>{Nr(this,Hr,Ur).call(this,e,i)}))}))),Rn()("unrestricted",{container:this.gridElem,handle:"fpd-sort",item:"fpd-item",placeholder:"fpd-sortable-placeholder",activeItem:"fpd-sortable-dragged",closestItem:"fpd-sortable-closest",autoscroll:!0,animationMs:0,onStart:t=>{e=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(t);const i=window.pageYOffset||document.documentElement.scrollTop||0;window.onscroll=()=>{window.scrollTo({top:i})}},onEnd:i=>{const n=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(i);e!=n&&(Nr(this,Wr,Gr).call(this,t.viewInstances,e,n),t.productStage.innerHTML="",t.viewInstances.forEach((e=>{t.productStage.append(e.fabricCanvas.wrapperEl)})),q(t,"viewMove"),t.selectView(0)),window.onscroll=()=>{}}}),G(this.container.querySelectorAll(".fpd-btn.fpd-add-blank, .fpd-btn.fpd-add-layout"),"click",(t=>{X(this.container,["fpd-modal-visible"]),t.currentTarget.classList.contains("fpd-add-blank")?Z(this.blankPageModal,["fpd-hidden"]):Z(this.layoutsModal,["fpd-hidden"])})),G(this.container.querySelectorAll(".fpd-blank-page-modal .fpd-close, .fpd-layouts-modal .fpd-close"),"click",(()=>{Z(this.container,["fpd-modal-visible"]),X(this.blankPageModal,["fpd-hidden"]),X(this.layoutsModal,["fpd-hidden"])})),G(t,"layoutsSet",(()=>{J(this.container.querySelectorAll(".fpd-btn.fpd-add-layout"),["fpd-hidden"],!(t.currentLayouts&&t.currentLayouts.length>0)),t.currentLayouts&&t.currentLayouts.length&&t.currentLayouts.forEach((e=>{const i=document.createElement("div");i.className="fpd-shadow-1 fpd-item",i.innerHTML='<picture  style="background-image: url('+e.thumbnail+');"></picture><span>'+e.title+"</span>",this.layoutsModal.querySelector(".fpd-grid").append(i),G(i,"click",(i=>{t.addView(e),this.hideModals()}))}))})),G(this.blankPageModal.querySelector(".fpd-head .fpd-btn"),"click",(t=>{if(this.blankPageCustomWidthInput.value&&this.blankPageCustomHeightInput.value){const t=parseInt(Math.abs(this.blankPageCustomWidthInput.value)),e=parseInt(Math.abs(this.blankPageCustomHeightInput.value));Nr(this,Hr,Ur).call(this,t,e)}})),this.blankPageModal.querySelector('.fpd-input input[data-type="width"]').value=this.fpdInstance.viewsNav.minWidth,this.blankPageModal.querySelector('.fpd-input input[data-type="width"]').setAttribute("aria-label",this.fpdInstance.viewsNav.minWidth+this.fpdInstance.viewsNav.unitFormat+" - "+this.fpdInstance.viewsNav.maxWidth+this.fpdInstance.viewsNav.unitFormat),this.blankPageModal.querySelector('.fpd-input input[data-type="height"]').value=this.fpdInstance.viewsNav.minHeight,this.blankPageModal.querySelector('.fpd-input input[data-type="height"]').setAttribute("aria-label",this.fpdInstance.viewsNav.minHeight+this.fpdInstance.viewsNav.unitFormat+" - "+this.fpdInstance.viewsNav.maxHeight+this.fpdInstance.viewsNav.unitFormat),G(this.blankPageModal.querySelectorAll(".fpd-input input"),"change",(t=>{t.currentTarget.value=this.fpdInstance.viewsNav.checkDimensionLimits(t.currentTarget.dataset.type,t.currentTarget)}))}G(t,"viewCreate",(e=>{const i=e.detail.viewInstance,n=FancyProductDesigner.proxyFileServer?FancyProductDesigner.proxyFileServer+i.thumbnail:i.thumbnail,s=document.createElement("div");if(s.className="fpd-shadow-1 fpd-item",s.title=i.title,s.innerHTML='<picture style="background-image: url('+n+');"></picture><span>'+s.title+"</span>",this.gridElem.append(s),t.mainOptions.enableDynamicViews){const e=document.createElement("div");e.className="fpd-sort",e.innerHTML='<span class="fpd-icon-drag"></span>',s.append(e);const n=document.createElement("div");n.className="fpd-options",n.innerHTML="···",s.append(n);const r=document.createElement("div");r.className="fpd-dropdown-menu fpd-shadow-1",r.innerHTML=`\n                        <span data-option="edit-size">${t.translator.getTranslation("misc","view_edit_size")}</span>\n                        <span data-option="duplicate">${t.translator.getTranslation("misc","view_duplicate")}</span>\n                        <span data-option="delete">${t.translator.getTranslation("misc","view_delete")}</span>\n                    `,n.append(r);let a=ct(i.options.stageWidth,this.fpdInstance.viewsNav.unitFormat),o=ct(i.options.stageHeight,this.fpdInstance.viewsNav.unitFormat);H(i.options.output,["width","height"])&&(a=i.options.output.width,o=i.options.output.height);const l=document.createElement("div");l.className="fpd-edit-size-overlay",l.innerHTML=`\n                        <input type="number" data-type="width" step=1 class="fpd-tooltip" min=${this.fpdInstance.viewsNav.minWidth} max=${this.fpdInstance.viewsNav.maxWidth} value=${a} aria-label="${this.fpdInstance.viewsNav.minWidth+this.fpdInstance.viewsNav.unitFormat+" - "+this.fpdInstance.viewsNav.maxWidth+this.fpdInstance.viewsNav.unitFormat}" />\n                        <input type="number" data-type="height" step=1 class="fpd-tooltip" min=${this.fpdInstance.viewsNav.minHeight} max=${this.fpdInstance.viewsNav.maxHeight} value=${o} aria-label="${this.fpdInstance.viewsNav.minHeight+this.fpdInstance.viewsNav.unitFormat+" - "+this.fpdInstance.viewsNav.maxHeight+this.fpdInstance.viewsNav.unitFormat}" />\n                        <span class="fpd-btn"><span class="fpd-icon-done"></span></span>\n                        <span class="fpd-btn fpd-secondary"><span class="fpd-icon-close"></span></span>\n                    `,s.append(l),G(l.querySelectorAll(".fpd-btn"),"click",(t=>{if(!t.currentTarget.classList.contains("fpd-secondary")){let t=lt(l.querySelector('[data-type="width"]').value,this.fpdInstance.viewsNav.unitFormat),e=lt(l.querySelector('[data-type="height"]').value,this.fpdInstance.viewsNav.unitFormat),n=this.fpdInstance.viewsNav.calcPageOptions(t,e);i.options=z(i.options,n),i.fabricCanvas.viewOptions=i.options,i.fabricCanvas._renderPrintingBox(),i==this.fpdInstance.currentViewInstance&&i.fabricCanvas.resetSize(),this.fpdInstance.viewsNav.doPricing(i),this.reset()}Z(l,["fpd-show"])})),G(l.querySelectorAll("input"),"change",(t=>{const e=t.currentTarget;"width"==e.dataset.type?(this.fpdInstance.viewsNav.checkDimensionLimits("width",e),this.fpdInstance.viewsNav.checkDimensionLimits("height",e.nextElementSibling)):(this.fpdInstance.viewsNav.checkDimensionLimits("height",e),this.fpdInstance.viewsNav.checkDimensionLimits("width",e.previousElementSibling))})),G(n,"click",(t=>{t.stopPropagation();const e=n.querySelector(".fpd-dropdown-menu");J(e,["fpd-show"],!e.classList.contains("fpd-show"))})),G(r.querySelectorAll("span"),"click",(e=>{const n=e.currentTarget.dataset.option;if("edit-size"==n)X(l,["fpd-show"]);else if("duplicate"==n)Nr(this,zr,Yr).call(this,i);else if("delete"==n){const e=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(s);t.removeView(e)}})),this.fpdInstance.viewsNav.doPricing(i)}G(s.querySelector("picture"),"click",(e=>{const i=Array.from(this.gridElem.querySelectorAll(".fpd-item")).indexOf(s);t.selectView(i),this.reset()}))})),G(t,"viewRemove",(t=>{const e=this.gridElem.querySelectorAll(".fpd-item").item(t.detail.viewIndex);e&&e.remove()})),G(t,"clear",(()=>{this.gridElem.innerHTML=""})),G(this.container.querySelector(".fpd-close"),"click",this.reset.bind(this)),G(t,"navItemSelect",this.reset.bind(this))}hideModals(){Z(this.container,["fpd-modal-visible"]),X(this.blankPageModal,["fpd-hidden"]),X(this.layoutsModal,["fpd-hidden"])}reset(){this.hideModals(),Z(this.container,["fpd-show"])}}function Ur(t,e){if(!t||!e)return;const i=lt(Number(t),this.fpdInstance.viewsNav.unitFormat),n=lt(Number(e),this.fpdInstance.viewsNav.unitFormat);let s=this.fpdInstance.viewsNav.calcPageOptions(i,n);this.fpdInstance.addView({title:t+"x"+e,thumbnail:"",elements:[],options:s}),this.hideModals()}function Yr(t){let e=t.fabricCanvas.getObjects(),i=[];e.forEach((t=>{if(void 0!==t.title&&void 0!==t.source){const e={title:t.title,source:t.source,parameters:t.getElementJSON(),type:t.getType()};i.push(e)}})),this.fpdInstance.addView({title:t.title,thumbnail:t.thumbnail,elements:i,options:t.options})}function Gr(t,e,i){let n=t[e];t.splice(e,1),t.splice(i,0,n)}class qr extends HTMLElement{constructor(){super()}connectedCallback(){this.innerHTML='<div class="fpd-close-sub-panel"> <span class="fpd-icon-back"></span> <span class="fpd-label" data-defaulttext="Back">toolbar.sub_panel_back</span> </div> <div class="fpd-close"> <span class="fpd-icon-close"></span> </div> <div class="fpd-tools-nav fpd-scroll-area"> <div class="fpd-primary-tools"> <div class="fpd-tool-color" data-panel="color"> <span class="fpd-current-fill"></span> <span class="fpd-label" data-defaulttext="Color">toolbar.color</span> </div> <div class="fpd-tool-edit-text" data-panel="edit-text"> <span class="fpd-icon-text-input"></span> <span class="fpd-label" data-defaulttext="Edit Text">toolbar.edit_text</span> </div> <div class="fpd-tool-text-size" data-panel="text-size"> <input type="text" class="fpd-input"> <span class="fpd-icon-font-size"></span> <span class="fpd-label" data-defaulttext="Size & Spacing">toolbar.text_size_spacing</span> </div> <div class="fpd-tool-font-family" data-panel="font-family"> <fpd-dropdown placeholder=""></fpd-dropdown> <span class="fpd-icon-font"></span> <span class="fpd-label" data-defaulttext="Font">toolbar.font</span> </div> </div> <div class="fpd-secondary-tools fpd-scroll-area"> <div class="fpd-tool-text-format" data-panel="text-format"> <span class="fpd-icon-text-format"></span> <span class="fpd-label" data-defaulttext="Format">toolbar.text_format</span> </div> <div class="fpd-tool-transform" data-panel="transform"> <span class="fpd-icon-transform"></span> <span class="fpd-label" data-defaulttext="Transform">toolbar.transform</span> </div> <div class="fpd-tool-position" data-panel="position"> <span class="fpd-icon-position"></span> <span class="fpd-label" data-defaulttext="Position">toolbar.position</span> </div> <div class="fpd-tool-curved-text" data-panel="curved-text"> <span class="fpd-icon-curved-text"></span> <span class="fpd-label" data-defaulttext="Curved Text">toolbar.curved_text</span> </div> <div class="fpd-tool-advanced-editing" data-panel="advanced-editing"> <span class="fpd-icon-effects"></span> <span class="fpd-label" data-defaulttext="Edit Image">toolbar.advanced_editing</span> </div> <div class="fpd-tool-remove-bg"> <span class="fpd-icon-remove-bg"></span> <span class="fpd-label" data-defaulttext="Remove Background">toolbar.remove_background</span> </div> <div class="fpd-tool-reset"> <span class="fpd-icon-reset"></span> <span class="fpd-label" data-defaulttext="Reset">toolbar.reset</span> </div> <div class="fpd-tool-duplicate"> <span class="fpd-icon-copy"></span> <span class="fpd-label" data-defaulttext="Duplicate">toolbar.duplicate</span> </div> <div class="fpd-tool-remove"> <span class="fpd-icon-bin"></span> <span class="fpd-label" data-defaulttext="Remove">toolbar.remove</span> </div> </div> </div> <div class="fpd-sub-panel"> <div class="fpd-panel-color"> <div class="fpd-panel-tabs"> <span data-tab="fill" data-defaulttext="Fill" class="fpd-active">toolbar.fill</span> <span data-tab="stroke" data-defaulttext="Stroke" class="fpd-tool-text-stroke">toolbar.stroke</span> <span data-tab="shadow" data-defaulttext="Shadow" class="fpd-tool-text-shadow">toolbar.shadow</span> </div> <div class="fpd-panel-tabs-content fpd-scroll-area"> <div data-id="fill" class="fpd-active"> <div class="fpd-color-wrapper"></div> <div class="fpd-tool-fill-opacity fpd-input"> <span class="fpd-label" data-defaulttext="Transparency">toolbar.transparency</span> <fpd-range-slider class="fpd-progress" value="1" step="0.01" min="0" max="1" data-control="opacity"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="1" step="0.01" min="0" max="1" data-control="opacity"/> </div> </div> <div data-id="stroke"> <div class="fpd-stroke-color-wrapper"></div> <div class="fpd-tool-stroke-width fpd-input"> <span class="fpd-label" data-defaulttext="Stroke Width">toolbar.stroke_width</span> <fpd-range-slider class="fpd-progress" value="0" step="1" min="0" max="20" data-control="strokeWidth"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="0" step="1" min="0" max="20" data-control="strokeWidth"/> </div> </div> <div data-id="shadow"> <div class="fpd-shadow-color-wrapper"></div> <div class="fpd-tool-shadow-blur fpd-input"> <span class="fpd-label" data-defaulttext="Blur">toolbar.shadow_blur</span> <fpd-range-slider class="fpd-progress" value="0" step="1" min="0" max="200" data-control="shadowBlur"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="0" step="1" min="0" max="200" data-control="shadowBlur"/> </div> <div class="fpd-tool-shadow-offsetX fpd-input"> <span class="fpd-label" data-defaulttext="Offset X">toolbar.shadow_offset_x</span> <fpd-range-slider class="fpd-progress" value="0" step="1" min="-100" max="100" data-control="shadowOffsetX"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="0" step="1" min="-100" max="100" data-control="shadowOffsetX"/> </div> <div class="fpd-tool-shadow-offsetY fpd-input"> <span class="fpd-label" data-defaulttext="Offset Y">toolbar.shadow_offset_y</span> <fpd-range-slider class="fpd-progress" value="0" step="1" min="-100" max="100" data-control="shadowOffsetY"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="0" step="1" min="-100" max="100" data-control="shadowOffsetY"/> </div> <div class="fpd-btn fpd-secondary fpd-remove-shadow" data-defaulttext="Remove Shadow">toolbar.remove_shadow</div> </div> </div> </div> <div class="fpd-panel-edit-text fpd-padding"> <textarea data-control="text"></textarea> </div> <div class="fpd-panel-text-size fpd-padding"> <div class="fpd-tool-text-size fpd-input"> <span class="fpd-label" data-defaulttext="Font Size">toolbar.font_size</span> <fpd-range-slider class="fpd-progress" value="12" step="1" min="1" max="200" data-control="fontSize"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="12" step="1" min="1" max="200" data-control="fontSize"/> </div> <div class="fpd-tool-text-line-spacing fpd-input"> <span class="fpd-label" data-defaulttext="Line Spacing">toolbar.line_spacing</span> <fpd-range-slider class="fpd-progress" value="1" step="0.1" min="-2" max="3" data-control="lineHeight"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="1" step="0.1" min="-2" max="3" data-control="lineHeight"/> </div> <div class="fpd-tool-text-letter-spacing fpd-input"> <span class="fpd-label" data-defaulttext="Letter Spacing">toolbar.letter_spacing</span> <fpd-range-slider class="fpd-progress" value="0" step="1" min="-30" max="30" data-control="letterSpacing"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="0" step="1" min="-30" max="30" data-control="letterSpacing"/> </div> </div> <div class="fpd-panel-text-format fpd-padding"> <div class="fpd-tools-group"> <div class="fpd-tool-text-bold fpd-toggle" data-defaulttext="Bold" data-control="fontWeight" data-enabled="bold" data-disabled="normal" title="toolbar.bold"> <span class="fpd-icon-format-bold"></span> </div> <div class="fpd-tool-text-italic fpd-toggle" data-defaulttext="Italic" data-control="fontStyle" data-enabled="italic" data-disabled="normal" title="toolbar.italic"> <span class="fpd-icon-format-italic"></span> </div> <div class="fpd-tool-text-underline fpd-toggle" data-defaulttext="Underline" data-control="textDecoration" data-enabled="underline" data-disabled="normal" title="toolbar.underline"> <span class="fpd-icon-format-underline"></span> </div> <div class="fpd-tool-text-transform fpd-btn-options" data-control="textTransform" data-options=\'{"none": "fpd-icon-text-transform", "uppercase": "fpd-icon-uppercase", "lowercase": "fpd-icon-lowercase"}\' data-defaulttext="Text Transform" title="toolbar.text_transform"> <span class="fpd-icon-text-transform"></span> </div> </div> <div class="fpd-tool-text-align fpd-btn-group" data-control="textAlign"> <span class="fpd-icon-format-align-left" data-option="left"></span> <span class="fpd-icon-format-align-center" data-option="center"></span> <span class="fpd-icon-format-align-right" data-option="right"></span> <span class="fpd-icon-format-align-justify" data-option="justify"></span> </div> </div> <div class="fpd-panel-font-family fpd-padding" data-control="fontFamily"> <input type="text" data-defaulttext="Search Fonts" placeholder="toolbar.font_family_search"/> <div class="fpd-scroll-area"> <div class="fpd-fonts-list"></div> </div> </div> <div class="fpd-panel-curved-text fpd-padding"> <div class="fpd-curved-options"> <span data-value="normal"> <svg width="48" height="14" viewBox="0 0 48 14" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M2.04787 13.327H0L4.60146 0.673004H6.83039L11.4318 13.327H9.38398L5.76899 2.97148H5.6691L2.04787 13.327ZM2.39126 8.37167H9.03434V9.97814H2.39126V8.37167Z" fill="#485563"/> <path d="M13.2784 13.327V0.673004H17.961C18.8684 0.673004 19.6197 0.821293 20.2149 1.11787C20.8101 1.41033 21.2555 1.80783 21.551 2.31036C21.8465 2.80878 21.9943 3.37104 21.9943 3.99715C21.9943 4.5244 21.8965 4.96926 21.7008 5.33175C21.5052 5.69011 21.243 5.97845 20.9142 6.19677C20.5895 6.41096 20.2315 6.56749 19.8403 6.66635V6.78992C20.2648 6.81052 20.679 6.94645 21.0827 7.19772C21.4906 7.44487 21.8278 7.79705 22.0942 8.25428C22.3606 8.7115 22.4938 9.26759 22.4938 9.92253C22.4938 10.5692 22.3398 11.15 22.0317 11.6649C21.7279 12.1757 21.2575 12.5814 20.6207 12.8821C19.9839 13.1787 19.1701 13.327 18.1795 13.327H13.2784ZM15.2076 11.6896H17.9922C18.9162 11.6896 19.578 11.5125 19.9776 11.1583C20.3772 10.804 20.577 10.3612 20.577 9.82985C20.577 9.43029 20.475 9.06369 20.2711 8.73004C20.0671 8.39639 19.7758 8.1307 19.397 7.93298C19.0224 7.73527 18.577 7.63641 18.0609 7.63641H15.2076V11.6896ZM15.2076 6.14734H17.7924C18.2253 6.14734 18.6145 6.06496 18.9599 5.90019C19.3096 5.73542 19.5864 5.50475 19.7903 5.20817C19.9984 4.90748 20.1025 4.55323 20.1025 4.14544C20.1025 3.62231 19.9173 3.18362 19.5468 2.82937C19.1764 2.47513 18.6082 2.298 17.8424 2.298H15.2076V6.14734Z" fill="#485563"/> <path d="M35.4022 4.78802H33.4542C33.3793 4.37611 33.2399 4.01362 33.0359 3.70057C32.8319 3.38752 32.5822 3.12183 32.2867 2.90352C31.9912 2.6852 31.6602 2.52044 31.294 2.40922C30.9318 2.298 30.5468 2.2424 30.1389 2.2424C29.4022 2.2424 28.7425 2.4257 28.1597 2.7923C27.5812 3.1589 27.1233 3.69645 26.7862 4.40494C26.4532 5.11343 26.2867 5.97845 26.2867 7C26.2867 8.02979 26.4532 8.89892 26.7862 9.60741C27.1233 10.3159 27.5832 10.8514 28.166 11.2139C28.7487 11.5764 29.4043 11.7576 30.1327 11.7576C30.5364 11.7576 30.9194 11.7041 31.2815 11.597C31.6478 11.4857 31.9787 11.323 32.2742 11.1088C32.5697 10.8946 32.8195 10.6331 33.0234 10.3241C33.2315 10.0111 33.3751 9.65273 33.4542 9.24905L35.4022 9.25523C35.2981 9.87722 35.0963 10.4498 34.7966 10.9729C34.501 11.4919 34.1202 11.9409 33.654 12.3199C33.192 12.6947 32.6634 12.9851 32.0682 13.1911C31.4729 13.397 30.8236 13.5 30.1202 13.5C29.013 13.5 28.0265 13.2405 27.1608 12.7215C26.295 12.1984 25.6124 11.4507 25.1129 10.4786C24.6176 9.5065 24.3699 8.34696 24.3699 7C24.3699 5.64892 24.6197 4.48939 25.1191 3.52139C25.6186 2.54927 26.3012 1.80371 27.167 1.2847C28.0328 0.761565 29.0172 0.5 30.1202 0.5C30.7986 0.5 31.4313 0.5968 32.0182 0.7904C32.6093 0.97988 33.14 1.25998 33.6103 1.6307C34.0806 1.99731 34.4698 2.44629 34.7778 2.97766C35.0858 3.50491 35.294 4.10837 35.4022 4.78802Z" fill="#485563"/> <path d="M41.8502 13.327H37.7107V0.673004H41.9813C43.2341 0.673004 44.3101 0.926331 45.2092 1.43299C46.1082 1.93552 46.7971 2.65843 47.2758 3.60171C47.7586 4.54087 48 5.66746 48 6.98146C48 8.29959 47.7565 9.43235 47.2695 10.3798C46.7867 11.3272 46.0874 12.0562 45.1717 12.567C44.256 13.0737 43.1488 13.327 41.8502 13.327ZM39.64 11.6587H41.744C42.718 11.6587 43.5276 11.4775 44.1727 11.115C44.8179 10.7484 45.3007 10.2191 45.6212 9.52709C45.9417 8.83096 46.102 7.98241 46.102 6.98146C46.102 5.98875 45.9417 5.14639 45.6212 4.45437C45.3049 3.76236 44.8325 3.23717 44.204 2.8788C43.5754 2.52044 42.795 2.34125 41.8626 2.34125H39.64V11.6587Z" fill="#485563"/> </svg> </span> <span data-value="curved"> <svg width="60" height="26" viewBox="0 0 60 26" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.30362 19.2601L2.8934 20.2466L0 9.08293L1.5349 8.00919L10.7657 14.7396L9.35546 15.7261L1.90512 10.1456L1.83632 10.1938L4.30362 19.2601ZM2.16616 15.591L6.74076 12.3909L7.51036 13.5267L2.93577 16.7269L2.16616 15.591Z" fill="#485563"/> <path d="M17.9225 11.7765L15.7371 1.14353L19.5693 0.330317C20.3119 0.172734 20.9524 0.166864 21.4907 0.312707C22.0283 0.455088 22.4615 0.711755 22.7901 1.08271C23.1181 1.4502 23.3361 1.897 23.4442 2.42311C23.5353 2.86615 23.5321 3.25695 23.4346 3.59552C23.3364 3.93062 23.1716 4.21845 22.9401 4.459C22.7114 4.69537 22.4455 4.88907 22.1424 5.04008L22.1637 5.14392C22.5147 5.0875 22.8772 5.1298 23.251 5.27081C23.6275 5.40765 23.9642 5.64504 24.2612 5.98298C24.5582 6.32091 24.7632 6.76505 24.8763 7.31539C24.988 7.85881 24.9623 8.37359 24.7991 8.85974C24.6387 9.34171 24.3238 9.76433 23.8546 10.1276C23.3846 10.4874 22.7443 10.7533 21.9336 10.9254L17.9225 11.7765ZM19.2186 10.0656L21.4975 9.58204C22.2537 9.42157 22.7648 9.1578 23.0306 8.79074C23.2964 8.42367 23.3835 8.01689 23.2917 7.57039C23.2227 7.23465 23.0759 6.9443 22.8514 6.69936C22.6268 6.45442 22.3425 6.28177 21.9984 6.18141C21.6576 6.08032 21.2761 6.0746 20.8537 6.16423L18.5186 6.65975L19.2186 10.0656ZM18.2614 5.4085L20.3768 4.95961C20.7311 4.88443 21.0353 4.74762 21.2896 4.54917C21.5473 4.35 21.734 4.1081 21.8497 3.82347C21.9681 3.53466 21.9921 3.21892 21.9216 2.87625C21.8313 2.43667 21.6039 2.10021 21.2396 1.86688C20.8752 1.63355 20.3797 1.58338 19.7529 1.71639L17.5966 2.17395L18.2614 5.4085Z" fill="#485563"/> <path d="M43.1012 4.5657L41.5023 4.25126C41.5069 3.89201 41.4506 3.56401 41.3335 3.26726C41.2163 2.9705 41.054 2.70627 40.8464 2.47458C40.6389 2.24288 40.3938 2.05061 40.111 1.89775C39.8316 1.74557 39.5245 1.63655 39.1897 1.57071C38.5849 1.45179 38.014 1.49978 37.4768 1.71468C36.9431 1.93025 36.481 2.30938 36.0905 2.85206C35.7035 3.39541 35.428 4.09755 35.264 4.95849C35.0987 5.82637 35.0958 6.58574 35.2554 7.23659C35.4184 7.88811 35.71 8.41365 36.1301 8.81321C36.5502 9.21276 37.0592 9.47133 37.6571 9.58891C37.9885 9.65408 38.3114 9.67076 38.6258 9.63896C38.9443 9.60435 39.2421 9.52064 39.519 9.38783C39.796 9.25501 40.043 9.07488 40.26 8.84744C40.481 8.6172 40.6564 8.33836 40.7861 8.01091L42.3841 8.33056C42.1988 8.83796 41.9412 9.28792 41.6112 9.68042C41.2854 10.0701 40.9007 10.3871 40.4572 10.6312C40.0178 10.8725 39.5373 11.0319 39.0157 11.1094C38.494 11.1869 37.9445 11.1689 37.3671 11.0553C36.4584 10.8766 35.6903 10.4987 35.063 9.92152C34.4363 9.34089 33.996 8.60062 33.7421 7.70072C33.4916 6.80149 33.4745 5.78428 33.6907 4.64909C33.9076 3.51043 34.2987 2.57351 34.8641 1.83833C35.4301 1.09968 36.1101 0.581522 36.904 0.283862C37.6986 -0.0172703 38.5486 -0.0788126 39.454 0.0992351C40.0109 0.208751 40.5146 0.392457 40.9653 0.650354C41.42 0.90545 41.8107 1.22718 42.1372 1.61554C42.4644 2.00042 42.7118 2.44164 42.8793 2.93918C43.0475 3.43326 43.1215 3.97543 43.1012 4.5657Z" fill="#485563"/> <path d="M51.5599 16.7757L48.7094 14.7817L54.7715 5.8346L57.7123 7.89185C58.5751 8.49539 59.1947 9.19283 59.5711 9.98417C59.9494 10.7726 60.0775 11.6156 59.9552 12.5131C59.8378 13.4097 59.4643 14.3226 58.8348 15.2517C58.2033 16.1837 57.493 16.8673 56.7038 17.3025C55.9174 17.7398 55.0866 17.9185 54.2113 17.8385C53.338 17.7556 52.4542 17.4013 51.5599 16.7757ZM50.8371 14.5315L52.2861 15.5451C52.9568 16.0143 53.6011 16.2761 54.219 16.3306C54.8389 16.3822 55.425 16.2405 55.9772 15.9056C56.5314 15.5678 57.0483 15.0451 57.5278 14.3373C58.0034 13.6354 58.2966 12.9626 58.4074 12.319C58.5211 11.6773 58.4473 11.0784 58.1862 10.5222C57.9251 9.96604 57.4735 9.4634 56.8314 9.01425L55.3008 7.94352L50.8371 14.5315Z" fill="#485563"/> <path d="M57.0036 24.5816C53.8499 20.4523 49.8075 17.1117 45.1862 14.816C40.565 12.5203 35.4877 11.3305 30.3437 11.3379C25.1997 11.3453 20.1257 12.5496 15.5109 14.8585C10.896 17.1675 6.86285 20.5196 3.7207 24.658L5.4326 25.1704C8.37306 21.2977 12.1473 18.1607 16.466 16C20.7846 13.8393 25.5329 12.7123 30.3467 12.7054C35.1605 12.6984 39.9119 13.8119 44.2366 15.9602C48.5612 18.1085 52.3442 21.2347 55.2954 25.0989L57.0036 24.5816Z" fill="#485563"/> </svg> </span> <span data-value="curveReverse"> <svg width="54" height="25" viewBox="0 0 54 25" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M54.0007 1.3373C50.9302 5.23068 46.9944 8.38039 42.495 10.5449C37.9956 12.7094 33.0522 13.8312 28.0439 13.8242C23.0356 13.8173 18.0954 12.6818 13.6023 10.5048C9.10912 8.32778 5.18233 5.16714 2.12305 1.26525L3.78979 0.747006C6.65271 4.39845 10.3275 7.35622 14.5322 9.39348C18.737 11.4307 23.36 12.4934 28.0469 12.4999C32.7337 12.5064 37.3598 11.4566 41.5704 9.43103C45.781 7.40546 49.4642 4.45791 52.3376 0.814432L54.0007 1.3373Z" fill="#485563"/> <path d="M1.37302 16.3375L0 15.4074L8.98733 9.06152L10.4818 10.0739L7.66465 20.5998L6.29163 19.6696L8.69804 11.1241L8.63106 11.0787L1.37302 16.3375ZM3.91457 13.19L8.36853 16.2073L7.61922 17.2783L3.16527 14.2609L3.91457 13.19Z" fill="#485563"/> <path d="M15.9304 23.9401L18.0582 13.9146L21.7893 14.6814C22.5123 14.83 23.086 15.0705 23.5104 15.4029C23.9355 15.7321 24.2236 16.1199 24.3745 16.5665C24.5262 17.0097 24.5494 17.4794 24.4441 17.9754C24.3554 18.3932 24.2027 18.7296 23.9859 18.9848C23.7697 19.2367 23.5123 19.4222 23.2136 19.5413C22.9189 19.6578 22.6073 19.7232 22.279 19.7375L22.2582 19.8354C22.593 19.9212 22.9001 20.0967 23.1796 20.3619C23.4631 20.6245 23.6725 20.9588 23.8079 21.3646C23.9432 21.7705 23.9559 22.2329 23.8457 22.7518C23.737 23.2641 23.5166 23.6991 23.1846 24.0566C22.8566 24.4115 22.4136 24.6559 21.8556 24.7899C21.2983 24.9206 20.625 24.9048 19.8356 24.7426L15.9304 23.9401ZM17.7429 22.9587L19.9617 23.4147C20.698 23.566 21.2551 23.534 21.6331 23.3188C22.011 23.1036 22.2447 22.7855 22.334 22.3645C22.4012 22.0479 22.3816 21.7408 22.2752 21.443C22.1688 21.1453 21.9813 20.8871 21.7128 20.6684C21.4475 20.4504 21.1093 20.2992 20.698 20.2147L18.4245 19.7475L17.7429 22.9587ZM18.6749 18.5677L20.7345 18.991C21.0794 19.0618 21.4033 19.0603 21.7063 18.9863C22.0126 18.913 22.272 18.7756 22.4843 18.574C22.7007 18.3699 22.8432 18.1062 22.9118 17.7832C22.9998 17.3687 22.9259 16.9908 22.6903 16.6495C22.4547 16.3082 22.0318 16.0748 21.4215 15.9494L19.3222 15.518L18.6749 18.5677Z" fill="#485563"/> <path d="M39.1873 17.1784L37.6305 17.4749C37.5063 17.159 37.3382 16.8922 37.1263 16.6744C36.9144 16.4567 36.6732 16.2836 36.403 16.1551C36.1327 16.0266 35.8425 15.9461 35.5323 15.9134C35.2256 15.8802 34.9092 15.8946 34.5832 15.9567C33.9944 16.0688 33.4958 16.3148 33.0874 16.6948C32.6824 17.0742 32.4005 17.571 32.2418 18.1853C32.0864 18.799 32.0885 19.5117 32.2482 20.3235C32.4091 21.1417 32.678 21.807 33.0549 22.3194C33.4351 22.831 33.8863 23.1865 34.4087 23.3859C34.931 23.5852 35.4832 23.6295 36.0654 23.5186C36.388 23.4572 36.6857 23.3563 36.9583 23.2161C37.2337 23.072 37.4727 22.8923 37.6754 22.6772C37.8781 22.462 38.0368 22.2161 38.1515 21.9396C38.2689 21.6592 38.3277 21.3525 38.3278 21.0197L39.8855 20.7282C39.8995 21.2383 39.8277 21.724 39.67 22.1853C39.5149 22.6427 39.2807 23.0574 38.9674 23.4295C38.6567 23.7977 38.2797 24.1089 37.8362 24.3631C37.3927 24.6174 36.8899 24.798 36.3277 24.9051C35.4429 25.0736 34.614 25.0175 33.841 24.7369C33.0673 24.4529 32.4049 23.9627 31.8538 23.2663C31.3061 22.5692 30.9269 21.6855 30.7164 20.6152C30.5052 19.5416 30.5236 18.5822 30.7715 17.737C31.0187 16.8885 31.4477 16.1921 32.0585 15.648C32.6686 15.1005 33.4144 14.7428 34.2959 14.575C34.8381 14.4717 35.3589 14.4523 35.8581 14.5168C36.3601 14.5775 36.828 14.7193 37.2618 14.9423C37.695 15.162 38.0762 15.4595 38.4054 15.8349C38.7339 16.207 38.9946 16.6548 39.1873 17.1784Z" fill="#485563"/> <path d="M51.4414 18.6799L48.666 20.5601L42.7638 12.1242L45.6271 10.1845C46.4671 9.61549 47.3066 9.29566 48.1457 9.22507C48.9829 9.15173 49.782 9.32077 50.5429 9.7322C51.3046 10.139 51.992 10.7804 52.6049 11.6564C53.2197 12.5351 53.5848 13.4009 53.7002 14.2536C53.8183 15.1045 53.6896 15.9082 53.3139 16.6646C52.9362 17.4183 52.3121 18.0901 51.4414 18.6799ZM49.1814 18.5717L50.5921 17.616C51.2451 17.1736 51.7034 16.6851 51.9668 16.1504C52.2284 15.613 52.3052 15.0408 52.1973 14.4339C52.0875 13.8242 51.7992 13.1858 51.3323 12.5185C50.8693 11.8567 50.3689 11.3679 49.8313 11.0521C49.2964 10.7345 48.7347 10.5989 48.1461 10.6455C47.5576 10.6921 46.9508 10.9271 46.3256 11.3506L44.8354 12.3601L49.1814 18.5717Z" fill="#485563"/> </svg> </span> </div> <div class="fpd-tool-curved-text-radius fpd-input"> <span class="fpd-label" data-defaulttext="Radius">toolbar.radius</span> <fpd-range-slider class="fpd-progress" value="80" step="1" min="0" max="400" data-control="curveRadius"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="80" step="1" min="0" max="400" data-control="curveRadius"/> </div> </div> <div class="fpd-panel-transform fpd-padding"> <div class="fpd-tool-angle fpd-input"> <span class="fpd-label" data-defaulttext="Rotate">toolbar.rotate</span> <fpd-range-slider class="fpd-progress" value="1" step="1" min="0" max="359" data-control="angle"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="1" step="1" min="0" max="359" data-control="angle"/> </div> <div class="fpd-tool-scaleX fpd-tool-scale fpd-input"> <span class="fpd-label" data-defaulttext="Scale X">toolbar.scaleX</span> <fpd-range-slider class="fpd-progress" value="1" step="0.01" min="0" max="5" data-control="scaleX"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="1" step="0.01" min="0" max="5" data-control="scaleX"/> </div> <div class="fpd-tool-uniscaling-locker fpd-tool-scale fpd-toggle" data-control="lockUniScaling" data-enabled="true" data-disabled="false"> <span class="fpd-icon-unlocked"></span> </div> <div class="fpd-tool-scaleY fpd-tool-scale fpd-input"> <span class="fpd-label" data-defaulttext="Scale Y">toolbar.scaleY</span> <fpd-range-slider class="fpd-progress" value="1" step="0.01" min="0" max="5" data-control="scaleY"></fpd-range-slider> <input class="fpd-slider-number fpd-number" type="number" value="1" step="0.01" min="0" max="5" data-control="scaleY"/> </div> <div class="fpd-tool-flip fpd-tools-group"> <div data-do="flip-x"> <span class="fpd-icon-flip-horizontal"></span> <span data-defaulttext="Flip Horizontal">toolbar.flip_h</span> </div> <div data-do="flip-y"> <span class="fpd-icon-flip-vertical"></span> <span data-defaulttext="Flip Vertical">toolbar.flip_v</span> </div> </div> </div> <div class="fpd-panel-position"> <div class="fpd-panel-tabs"> <span data-tab="align" data-defaulttext="Align">toolbar.align</span> <span data-tab="arrange" data-defaulttext="Arrange" class="fpd-active">toolbar.arrange</span> </div> <div class="fpd-panel-tabs-content fpd-scroll-area"> <div data-id="align"> <div class="fpd-tool-position-align fpd-tools-group"> <div data-do="align-top"> <span class="fpd-icon-align-top"></span> <span data-defaulttext="Top">toolbar.align_top</span> </div> <div data-do="align-middle"> <span class="fpd-icon-align-horizontal-middle"></span> <span data-defaulttext="Middle">toolbar.center_h</span> </div> <div data-do="align-bottom"> <span class="fpd-icon-align-bottom"></span> <span data-defaulttext="Bottom">toolbar.align_bottom</span> </div> <div data-do="align-left"> <span class="fpd-icon-align-left"></span> <span data-defaulttext="Left">toolbar.align_left</span> </div> <div data-do="align-center"> <span class="fpd-icon-align-vertical-middle"></span> <span data-defaulttext="Center">toolbar.center_v</span> </div> <div data-do="align-right"> <span class="fpd-icon-align-right"></span> <span data-defaulttext="Right">toolbar.align_right</span> </div> </div> </div> <div data-id="arrange"> <div class="fpd-tool-layer-depth fpd-tools-group"> <div data-do="layer-up"> <span class="fpd-icon-move-up"></span> <span data-defaulttext="Move Up">toolbar.move_up</span> </div> <div data-do="layer-down"> <span class="fpd-icon-move-down"></span> <span data-defaulttext="Move Down">toolbar.move_down</span> </div> </div> </div> </div> </div> <div class="fpd-panel-advanced-editing"> <div class="fpd-panel-tabs"> <span data-tab="filters" data-defaulttext="Filters" class="fpd-active">toolbar.filters</span> <span data-tab="crop" data-defaulttext="Crop">toolbar.crop</span> </div> <div class="fpd-panel-tabs-content"> <div data-id="filters"> <div class="fpd-tool-filters fpd-grid fpd-scroll-area fpd-padding"></div> </div> <div data-id="crop"> <div class="fpd-tool-crop-masks fpd-grid fpd-scroll-area fpd-padding"></div> </div> </div> </div> </div>'}}customElements.define("fpd-element-toolbar",qr);const Xr={none:{name:"None",preview:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABGhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDozNDlGNUFEOERDNDhFNDExOThFMDgyRUM1NERENjU5QTwvc3RSZWY6aW5zdGFuY2VJRD4KICAgICAgICAgICAgPHN0UmVmOmRvY3VtZW50SUQ+QzA2NTAzMzhGRDBGRjNDNTQ2NjQ5MTdERjU4RTZBOUY8L3N0UmVmOmRvY3VtZW50SUQ+CiAgICAgICAgIDwveG1wTU06RGVyaXZlZEZyb20+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6NDJBOTU5NjZBQTVFMTFFNDg3MTc5QzUzNEZBREI5NjI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6NDJBOTU5NjVBQTVFMTFFNDg3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"},grayscale:{name:"Grayscale",preview:"data:image/png;base64,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"},sepia:{name:"Sepia",preview:"data:image/png;base64,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"},vintage:{name:"Vintage",preview:"data:image/png;base64,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"},kodachrome:{name:"Kodachrome",preview:"data:image/png;base64,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"},technicolor:{name:"Technicolor",preview:"data:image/png;base64,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"},black_white:{name:"Black & White",preview:"data:image/png;base64,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"},cold:{name:"Cold",array:[1,0,0,0,0,0,1,0,0,0,-.2,.2,.1,.4,0,0,0,0,1,0],preview:"data:image/png;base64,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"},old:{name:"Old",array:[1,0,0,0,0,-.4,1.3,-.4,.2,-.1,0,0,1,0,0,0,0,0,1,0],preview:"data:image/png;base64,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"},milk:{name:"Milk",array:[0,1,0,0,0,0,1,0,0,0,0,.6,1,0,0,0,0,0,1,0],preview:"data:image/png;base64,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"},purple:{name:"Purple",array:[1,-.2,0,0,0,0,1,0,-.1,0,0,1.2,1,.1,0,0,0,1.7,1,0],preview:"data:image/png;base64,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"},yellow:{name:"Yellow",array:[1,0,0,0,0,-.2,1,.3,.1,0,-.1,0,1,0,0,0,0,0,1,0],preview:"data:image/png;base64,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"}};function Zr(t,e){Jr(t,e),e.add(t)}function Jr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qr(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Kr(t,e,"get"))}function Kr(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function $r(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var ta=new WeakMap,ea=new WeakSet,ia=new WeakSet,na=new WeakSet,sa=new WeakSet,ra=new WeakSet,aa=new WeakSet,oa=new WeakSet,la=new WeakSet,ca=new WeakSet,ha=new WeakSet,da=new WeakSet,ua=new WeakSet,fa=new WeakSet,pa=new WeakSet,ga=new WeakSet,ma=new WeakSet;class va extends EventTarget{constructor(t){var e,i;if(super(),Zr(this,ma),Zr(this,ga),Zr(this,pa),Zr(this,fa),Zr(this,ua),Zr(this,da),Zr(this,ha),Zr(this,ca),Zr(this,la),Zr(this,oa),Zr(this,aa),Zr(this,ra),Zr(this,sa),Zr(this,na),Zr(this,ia),Zr(this,ea),function(t,e,i){(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"currentPlacement",""),i={writable:!0,value:void 0},Jr(this,e=ta),e.set(this,i),this.fpdInstance=t,this.container=document.createElement("fpd-element-toolbar"),$r(this,pa,Pa).call(this),Object.keys(t.mainOptions.maxValues).forEach((e=>{const i=this.container.querySelector('[data-control="'+e+'"]');i&&i.setAttribute("max",t.mainOptions.maxValues[e])})),Array.isArray(t.mainOptions.fonts)&&t.mainOptions.fonts.length){const e=this.subPanel.querySelector(".fpd-fonts-list");t.mainOptions.fonts.forEach((i=>{let n="object"==typeof i?i.name:i;const s=document.createElement("span");s.className="fpd-item",s.dataset.value=n,s.innerText=n,s.style.fontFamily=n,e.append(s),G(s,"click",(i=>{Z(Array.from(e.children),["fpd-active"]),X(s,["fpd-active"]),t.currentViewInstance.fabricCanvas.setElementOptions({fontFamily:n}),$r(this,ea,ba).call(this,t.currentElement)}))})),G(this.subPanel.querySelector(".fpd-panel-font-family input"),"keyup",(t=>{const i=t.currentTarget.value;e.querySelectorAll(".fpd-item").forEach((t=>{0==i.length?t.classList.remove("fpd-hidden"):t.classList.toggle("fpd-hidden",!t.innerText.toLowerCase().includes(i.toLowerCase()))}))}))}else this.navElem.querySelector(".fpd-tool-font-family").style.display="none";const s=this.subPanel.querySelector(".fpd-tool-filters");for(const e in Xr){const i=document.createElement("div"),n=Xr[e];i.className="fpd-item",i.setAttribute("aria-label",n.name),i.style.backgroundImage=`url(${n.preview})`,s.append(i),G(i,"click",(i=>{t.currentViewInstance.fabricCanvas.setElementOptions({filter:n.array||e})}))}const r=this.subPanel.querySelector(".fpd-tool-crop-masks");Array.isArray(t.mainOptions.cropMasks)&&t.mainOptions.cropMasks.forEach((e=>{const i=document.createElement("div");i.className="fpd-item",i.setAttribute("aria-label",nt(e)),i.style.backgroundImage=`url(${e})`,r.append(i),G(i,"click",(i=>{this.toggle(!1),t.advancedImageEditor.loadImage(t.currentElement,e)}))})),G(t,"elementSelect",(()=>{const e=t.currentElement;$r(this,da,Oa).call(this,e)?($r(this,ua,ka).call(this,e),$r(this,fa,Ma).call(this),"text"==e.getType()&&(e.off("changed",$r(this,fa,Ma).bind(this)),e.on("changed",$r(this,fa,Ma).bind(this))),$r(this,ea,ba).call(this,e)):this.toggle(!1)})),G(t,"elementChange",(()=>{"smart"==this.currentPlacement&&this.toggle(!1)})),G(t,"elementModify",(t=>{const{options:e}=t.detail;void 0!==e.fontSize&&($r(this,ga,_a).call(this,"fontSize",e.fontSize),this.navElem.querySelector(".fpd-tool-text-size > input").value=e.fontSize),void 0!==e.fontFamily&&(this.navElem.querySelector(".fpd-tool-font-family fpd-dropdown > input").value=e.fontFamily),void 0!==e.scaleX&&$r(this,ga,_a).call(this,"scaleX",parseFloat(Number(e.scaleX).toFixed(2))),void 0!==e.scaleY&&$r(this,ga,_a).call(this,"scaleY",parseFloat(Number(e.scaleY).toFixed(2))),void 0!==e.angle&&$r(this,ga,_a).call(this,"angle",parseInt(e.angle)),void 0!==e.text&&$r(this,ga,_a).call(this,"text",e.text)})),G(document.body,["mouseup","touchend"],(()=>{this.fpdInstance.currentElement&&$r(this,fa,Ma).call(this)})),G(this.subPanel.querySelectorAll(".fpd-number"),"change",(e=>{const i=e.currentTarget;let n={};i.value>Number(i.max)&&(i.value=Number(i.max)),i.value<Number(i.min)&&(i.value=Number(i.min));let s=Number(i.value);i.classList.contains("fpd-slider-number")&&(i.previousElementSibling.setAttribute("value",s),"scaleX"===i.dataset.control&&t.currentElement&&t.currentElement.lockUniScaling&&(n.scaleY=s,$r(this,ga,_a).call(this,"scaleY",s))),n[i.dataset.control]=s,t.currentViewInstance&&t.currentViewInstance.fabricCanvas.setElementOptions(n)})),G(this.subPanel.querySelectorAll("fpd-range-slider"),"onInput",(e=>{const i=e.currentTarget,n=e.detail;if(t.currentViewInstance&&t.currentElement){var s={},r=i.dataset.control;s[r]=n,"scaleX"===r&&t.currentElement&&t.currentElement.lockUniScaling&&(s.scaleY=n,$r(this,ga,_a).call(this,"scaleY",n)),t.currentViewInstance.fabricCanvas.setElementOptions(s)}const a=e.currentTarget.nextElementSibling;a&&a.classList.contains("fpd-slider-number")&&(a.value=n)})),G(this.subPanel.querySelectorAll(".fpd-panel-tabs > span"),"click",(t=>{const e=t.currentTarget,i=e.parentNode,n=i.nextElementSibling;Z(i.querySelectorAll("span"),["fpd-active"]),X(e,["fpd-active"]);const s=Array.from(n.children);Z(s,["fpd-active"]),X(s.filter((t=>t.dataset.id==e.dataset.tab)),["fpd-active"])})),G(this.subPanel.querySelectorAll(".fpd-toggle"),"click",(e=>{const i=e.currentTarget;let n={};J(i,["fpd-enabled"],!i.classList.contains("fpd-enabled")),n[i.dataset.control]=i.classList.contains("fpd-enabled")?i.dataset.enabled:i.dataset.disabled,["true","false"].includes(n[i.dataset.control])&&(n[i.dataset.control]="true"===n[i.dataset.control]),i.classList.contains("fpd-tool-uniscaling-locker")&&$r(this,ca,Aa).call(this,n[i.dataset.control]),t.currentViewInstance.fabricCanvas.setElementOptions(n)})),G(this.subPanel.querySelectorAll(".fpd-btn-options"),"click",(e=>{e.preventDefault();const i=e.currentTarget,n=JSON.parse(i.dataset.options),s=Object.keys(n),r=t.currentElement?t.currentElement[i.dataset.control]:s[0],a=s.indexOf(r)==s.length-1?s[0]:s[s.indexOf(r)+1],o={};o[i.dataset.control]=a,i.querySelector("span").className=n[a],t.currentViewInstance.fabricCanvas.setElementOptions(o)})),G(this.subPanel.querySelectorAll(".fpd-btn-group [data-option]"),"click",(e=>{e.preventDefault();const i=e.currentTarget,n=i.dataset.option;Z(Array.from(i.parentNode.children),["fpd-active"]),X(i,["fpd-active"]);const s={};s[i.parentNode.dataset.control]=n,t.currentViewInstance.fabricCanvas.setElementOptions(s)})),G(this.subPanel.querySelectorAll(".fpd-tools-group > [data-do]"),"click",(e=>{const i=e.currentTarget.dataset.do;if("align-left"==i)t.currentElement.alignToPosition("left");else if("align-right"==i)t.currentElement.alignToPosition("right");else if("align-top"==i)t.currentElement.alignToPosition("top");else if("align-bottom"==i)t.currentElement.alignToPosition("bottom");else if("align-middle"==i)t.currentElement.centerElement(!1,!0);else if("align-center"==i)t.currentElement.centerElement(!0,!1);else if("layer-up"==i||"layer-down"==i){let e=t.currentElement.getZIndex();e="layer-up"==i?e+1:e-1,e=e<0?0:e,t.currentViewInstance.fabricCanvas.setElementOptions({z:e})}else if("flip-x"==i||"flip-y"==i){const e={};"flip-x"==i?e.flipX=!t.currentElement.flipX:e.flipY=!t.currentElement.flipY,t.currentViewInstance.fabricCanvas.setElementOptions(e)}})),G(this.subPanel.querySelector('textarea[data-control="text"]'),"keyup",(e=>{e.stopPropagation,e.preventDefault();var i=e.currentTarget.selectionStart,n=e.currentTarget.selectionEnd;t.currentViewInstance.fabricCanvas.setElementOptions({text:e.currentTarget.value}),e.currentTarget.selectionStart=i,e.currentTarget.selectionEnd=n})),G(this.subPanel.querySelectorAll(".fpd-curved-options > span"),"click",(e=>{const i=e.currentTarget;let n={};"normal"==i.dataset.value?n.curved=!1:(n.curved=!0,n.curveReverse="curveReverse"==i.dataset.value),t.currentViewInstance.fabricCanvas.setElementOptions(n),$r(this,ha,Ia).call(this,n)})),G(this.navElem.querySelector(".fpd-tool-reset"),"click",(e=>{let i=t.currentElement.originParams;delete i.clipPath,delete i.path,t.currentElement.boundingBox&&(t.currentElement.scaleX=1,i.boundingBox=t.currentElement.boundingBox),t.currentViewInstance.fabricCanvas.setElementOptions(i),t.deselectElement()})),G(this.navElem.querySelector(".fpd-tool-duplicate"),"click",(e=>{t.currentViewInstance.fabricCanvas.duplicateElement(t.currentElement)})),G(this.navElem.querySelector(".fpd-tool-remove"),"click",(e=>{t.currentViewInstance.fabricCanvas.removeElement(t.currentElement)})),G(this.subPanel.querySelector(".fpd-panel-color .fpd-remove-shadow"),"click",(e=>{t.currentViewInstance.fabricCanvas.setElementOptions({shadowColor:null})})),G(this.navElem.querySelector(".fpd-tool-remove-bg"),"click",(e=>{let i=t.currentElement;t.deselectElement(),t.toggleSpinner(!0,t.translator.getTranslation("misc","loading_image")),Ut({url:t.mainOptions.aiService.serverURL,body:{service:"removeBG",image:i.source},onSuccess:e=>{e&&e.new_image?i.setSrc(e.new_image,(()=>{i.source=e.new_image,i.canvas.renderAll(),n(t.translator.getTranslation("misc","ai_remove_bg_success"))}),{crossOrigin:"anonymous"}):t.aiRequestError(e.error),t.toggleSpinner(!1)},onError:t.aiRequestError.bind(t)})})),G(this.navElem.querySelectorAll("[class^=fpd-tool-]"),"click",(t=>{const e=t.currentTarget;if(e.dataset.panel){Z(this.navElem.querySelectorAll("[class^=fpd-tool-]"),["fpd-active"]),X(e,["fpd-active"]);const t=Array.from(this.subPanel.children),i=t.filter((t=>t.classList.contains("fpd-panel-"+e.dataset.panel)));Z(t,["fpd-active"]),X(i,["fpd-active"]),"smart"==this.currentPlacement&&(X(this.container,["fpd-panel-visible"]),$r(this,fa,Ma).call(this))}})),G(this.container.querySelector(".fpd-close"),"click",(e=>{this.toggle(!1),t.deselectElement()})),G(this.container.querySelector(".fpd-close-sub-panel"),"click",(t=>{Z(Array.from(this.subPanel.children),["fpd-active"]),Z(this.container,["fpd-panel-visible"])}))}toggle(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];J(this.container,["fpd-show"],t),J(document.body,["fpd-toolbar-visible"],t)}}function ba(t){if(t.hasOwnProperty("fontFamily")&&($r(this,ia,ya).call(this,!1,!1),Array.isArray(this.fpdInstance.mainOptions.fonts)&&this.fpdInstance.mainOptions.fonts.length)){const e=this.fpdInstance.mainOptions.fonts.find((e=>e.name==t.fontFamily));e?.url&&e.url.toLowerCase().includes(".ttf")?e.variants?$r(this,ia,ya).call(this,Boolean(e.variants.n7),Boolean(e.variants.i4)):$r(this,ia,ya).call(this,!1,!1):"google"===e?.url&&e.variants&&$r(this,ia,ya).call(this,Boolean(e.variants.includes("bold")),Boolean(e.variants.includes("italic")))}}function ya(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];J(this.subPanel.querySelector(".fpd-tool-text-bold"),["fpd-disabled"],!t),J(this.subPanel.querySelector(".fpd-tool-text-italic"),["fpd-disabled"],!e)}function xa(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this.navElem.querySelectorAll(".fpd-tools-nav .fpd-tool-"+t);return J(i,["fpd-hidden"],!Boolean(e)),i}function wa(t,e,i){i=Boolean(i);const n=this.subPanel.querySelector(".fpd-panel-"+t);return J(n.querySelectorAll(".fpd-tool-"+e),["fpd-hidden"],!i),t}function Ca(t,e,i){const n=this.subPanel.querySelector(".fpd-panel-"+t);J(n.querySelectorAll('.fpd-panel-tabs [data-tab="'+e+'"]'),["fpd-hidden"],!i)}function Sa(t,e){"png"!==t.isColorizable()&&t.changeColor(e)}function Ta(t,e){this.navElem.querySelector(".fpd-current-fill").style.background=e,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:e},t)}function Ea(t,e,i){const n=t.changeObjectColor(e,i);this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:n},t)}function Aa(t){this.subPanel.querySelector(".fpd-tool-uniscaling-locker > span").className=t?"fpd-icon-locked":"fpd-icon-unlocked",J(this.subPanel.querySelector(".fpd-tool-scaleY"),["fpd-disabled"],t)}function Ia(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.subPanel.querySelector(".fpd-curved-options");Z(e.querySelectorAll("[data-value]"),["fpd-active"]),t.curved?t.curveReverse?X(e.querySelectorAll('[data-value="curveReverse"]'),["fpd-active"]):X(e.querySelectorAll('[data-value="curved"]'),["fpd-active"]):X(e.querySelectorAll('[data-value="normal"]'),["fpd-active"]),J(this.subPanel.querySelector(".fpd-tool-curved-text-radius"),["fpd-hidden"],!t.curved)}function Oa(t){return t&&!t._ignore&&!t.uploadZone}function ka(t){let e;if($r(this,ma,Da).call(this),Z(this.container,["fpd-type-image"]),t.hasColorSelection()){let i=rt(t,this.fpdInstance);if("group"===t.type&&t.getObjects().length>1){const n=Array.isArray(t.colors)&&t.colors.length>1;e=Bn({colors:i,colorNames:this.fpdInstance.mainOptions.hexNames,palette:t.colors,subPalette:n,enablePicker:!!this.fpdInstance.mainOptions.editorMode||!n,onChange:(e,i)=>{$r(this,la,Ea).call(this,t,i,e)},onMove:(e,i)=>{t.changeObjectColor(i,e)}})}else e=jn(this.fpdInstance,{initialColor:t.fill,colors:i,patterns:Array.isArray(t.patterns)&&(t.isSVG()||"text"===t.getType())?t.patterns:null,onMove:e=>{$r(this,aa,Sa).call(this,t,e)},onChange:e=>{$r(this,oa,Ta).call(this,t,e)},onPatternChange:e=>{this.navElem.querySelector(".fpd-current-fill").style.background=`url("${e}")`,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:e},t)}});e&&Qr(this,ta).append(e);const n=this.subPanel.querySelector(".fpd-stroke-color-wrapper");n.innerHTML="";const s=jn(this.fpdInstance,{colors:Array.isArray(t.strokeColors)&&t.strokeColors.length>0?t.strokeColors:[t.stroke?t.stroke:"#000"],onMove:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({stroke:e},t)},onChange:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({stroke:e},t)}});n.append(s);const r=this.subPanel.querySelector(".fpd-shadow-color-wrapper");r.innerHTML="";const a=Dn({initialColor:o(t.shadowColor).isValid()?t.shadowColor:"#000000",colorNames:this.fpdInstance.mainOptions.hexNames,palette:this.fpdInstance.mainOptions.colorPickerPalette,onMove:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({shadowColor:e},t)},onChange:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({shadowColor:e},t)}});r.append(a),$r(this,na,xa).call(this,"color"),$r(this,ra,Ca).call(this,"color","fill",!0),$r(this,ra,Ca).call(this,"color","stroke","text"===t.getType()),$r(this,ra,Ca).call(this,"color","shadow",!0)}!e&&(t.isSVG()||"text"===t.getType())&&t.patterns&&t.patterns.length&&(e=jn(this.fpdInstance,{colors:[],patterns:t.patterns,onPatternChange:e=>{this.navElem.querySelector(".fpd-current-fill").style.background=`url("${e}")`,this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:e},t)}}),Qr(this,ta).append(e),$r(this,na,xa).call(this,"color"),$r(this,ra,Ca).call(this,"color","fill",!0));let i=Boolean(t.resizable&&"image"===t.getType()||t.uniScalingUnlockable||t.__editorMode);(i||t.rotatable)&&($r(this,na,xa).call(this,"transform"),$r(this,sa,wa).call(this,"transform","scale",i),$r(this,ca,Aa).call(this,t.lockUniScaling),$r(this,sa,wa).call(this,"transform","uniscaling-locker",Boolean(t.uniScalingUnlockable||t.__editorMode)),$r(this,sa,wa).call(this,"transform","angle",Boolean(t.rotatable||t.__editorMode)),$r(this,sa,wa).call(this,"transform","flip",Boolean(i||t.__editorMode))),(t.draggable||t.zChangeable||t.__editorMode)&&($r(this,na,xa).call(this,"position"),$r(this,ra,Ca).call(this,"position","arrange",Boolean(t.zChangeable||t.__editorMode)),$r(this,ra,Ca).call(this,"position","align",Boolean(t.draggable||t.__editorMode))),"text"===t.getType()&&(t.editable||t.__editorMode)?($r(this,na,xa).call(this,"edit-text"),$r(this,na,xa).call(this,"text-size",Boolean(t.resizable||t.__editorMode)&&!t.widthFontSize),$r(this,na,xa).call(this,"font-family"),$r(this,na,xa).call(this,"text-format"),t.curvable&&($r(this,na,xa).call(this,"curved-text"),$r(this,ha,Ia).call(this,t),this.subPanel.querySelector('fpd-range-slider[data-control="curveRadius"]').setAttribute("max",t.maxCurveRadius)),this.subPanel.querySelector('textarea[data-control="text"]').value=t.text,$r(this,na,xa).call(this,"edit-text",!t.textPlaceholder&&!t.numberPlaceholder)):"text"!==t.getType()&&X(this.container,["fpd-type-image"]),t.advancedEditing&&t.source&&st(t.source)&&($r(this,na,xa).call(this,"advanced-editing"),$r(this,ra,Ca).call(this,"advanced-editing","filters",!0),$r(this,ra,Ca).call(this,"advanced-editing","crop",Boolean(Array.isArray(this.fpdInstance.mainOptions.cropMasks)&&this.fpdInstance.mainOptions.cropMasks.length)),$r(this,na,xa).call(this,"remove-bg",Boolean(this.fpdInstance.mainOptions.aiService.serverURL&&this.fpdInstance.mainOptions.aiService.removeBG))),$r(this,sa,wa).call(this,"text-size","text-line-spacing",!t.curved),$r(this,na,xa).call(this,"reset"),$r(this,na,xa).call(this,"duplicate",t.copyable||t.__editorMode),$r(this,na,xa).call(this,"remove",t.removable||t.__editorMode),this.subPanel.querySelectorAll(".fpd-panel-tabs").forEach((t=>{const e=t.querySelectorAll("[data-tab]:not(.fpd-hidden)");J(t,["fpd-hidden"],e.length<=1),e.item(0)&&e.item(0).click()})),this.container.querySelectorAll("[data-control]").forEach((e=>{const i=e.dataset.control;if(e.classList.contains("fpd-number")){if(void 0!==t[i]){var n=e.step&&e.step.length>1?parseFloat(t[i]).toFixed(2):parseInt(t[i]);if(e.value=n,e.classList.contains("fpd-slider-number")){const s=e.previousElementSibling;"fontSize"==i?(s.setAttribute("min",t.minFontSize),s.setAttribute("max",t.maxFontSize)):"scaleX"!=i&&"scaleY"!=i||s.setAttribute("min",t.minScaleLimit),s.setAttribute("value",n)}}}else if(e.classList.contains("fpd-toggle"))J(e,["fpd-enabled"],t[i]===e.dataset.enabled);else if(e.classList.contains("fpd-btn-options")){const n=JSON.parse(e.dataset.options);e.querySelector("span").className=n[t[i]]}else if(e.classList.contains("fpd-btn-group")){Z(Array.from(e.children),["fpd-active"]);const i=e.dataset.control;X(e.querySelector('[data-option="'+t[i]+'"]'),["fpd-active"])}else"fontFamily"==i?(this.navElem.querySelector(".fpd-tool-font-family fpd-dropdown > input").value=t[i],void 0!==t[i]&&(Z(this.subPanel.querySelectorAll(".fpd-fonts-list .fpd-item"),["fpd-active"]),X(this.subPanel.querySelector('.fpd-fonts-list .fpd-item[data-value="'+t[i]+'"]'),["fpd-active"]))):"fontSize"==i&&(this.navElem.querySelector(".fpd-tool-text-size > input").value=t[i]);const s=at(t);s&&(this.navElem.querySelector(".fpd-current-fill").style.background=s)})),"sidebar"==this.currentPlacement&&this.navElem.querySelector("[data-panel]:not(.fpd-hidden)").click(),this.toggle(),this.container.querySelectorAll(".fpd-scroll-area").forEach((t=>{t.scrollLeft=t.scrollTop=0})),this.container.dataset.fabricType=t.type,this.container.dataset.elementType=t.getType()}function Ma(){if("smart"===this.currentPlacement&&$r(this,da,Oa).call(this,this.fpdInstance.currentElement)&&!this.fpdInstance.container.classList.contains("fpd-aie-visible")&&(this.toggle(Boolean(this.fpdInstance.currentElement)),this.fpdInstance.currentElement)){const t=this.fpdInstance.currentElement,e=this.fpdInstance.container.getBoundingClientRect(),i=t.getBoundingRect(),n=i.top+i.height+t.controls.mtr.offsetY+t.cornerSize;let s=this.fpdInstance.productStage.getBoundingClientRect().top+n;s>e.height+e.top&&(s=e.height+e.top),s>window.innerHeight-this.container.clientHeight&&(s=window.innerHeight-this.container.clientHeight);const r=t.oCoords,a=this.container.offsetWidth/2;let o=this.fpdInstance.currentViewInstance.fabricCanvas.wrapperEl.getBoundingClientRect().left+r.mt.x;o=o<a?a:o,o=o>window.innerWidth-a?window.innerWidth-a:o,this.container.style.top=s+"px",this.container.style.left=o+"px"}}function Pa(){const t=this.fpdInstance.container.dataset.layout;var e,i,n;this.container.className="fpd-layout-"+t,this.fpdInstance.container.classList.contains("fpd-sidebar")||(this.fpdInstance.mainOptions.toolbarPlacement="smart"),"smart"==this.fpdInstance.mainOptions.toolbarPlacement||this.fpdInstance.container.classList.contains("fpd-layout-small")?("smart"!=this.currentPlacement&&("body"==this.fpdInstance.mainOptions.toolbarDynamicContext?document.body.appendChild(this.container):document.querySelector(this.fpdInstance.mainOptions.toolbarDynamicContext).appendChild(this.container)),this.currentPlacement="smart",this.container.className+=" fpd-container fpd-smart"):("sidebar"!=this.currentPlacement&&this.fpdInstance.mainBar.container.appendChild(this.container),this.currentPlacement="sidebar",this.container.className+=" fpd-container fpd-sidebar"),this.navElem=this.container.querySelector(".fpd-tools-nav"),this.subPanel=this.container.querySelector(".fpd-sub-panel"),e=this,i=ta,n=this.subPanel.querySelector(".fpd-color-wrapper"),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(e,Kr(e,i,"set"),n),Z(this.fpdInstance.container,["fpd-toolbar-smart","fpd-toolbar-sidebar"]),X(this.fpdInstance.container,["fpd-toolbar-"+this.currentPlacement])}function _a(t,e){this.subPanel.querySelectorAll('[data-control="'+t+'"]').forEach((t=>{t.value=e,t.setAttribute("value",e)}))}function Da(){Qr(this,ta).innerHTML="",Z(this.container,["fpd-panel-visible"]),X(this.navElem.querySelectorAll("[class^=fpd-tool-]"),["fpd-hidden"]),Z(this.navElem.querySelectorAll("[class^=fpd-tool-]"),["fpd-active"]),Z(Array.from(this.subPanel.children),["fpd-active"]),X(this.subPanel.querySelectorAll(".fpd-panel-tabs > span"),["fpd-hidden"]),Z(this.subPanel.querySelectorAll(".fpd-panel-tabs-content > *, .fpd-panel-tabs > *"),["fpd-active"])}class La{constructor(t){this.fpdInstance=t}start(){if(this.fpdInstance.mainOptions.guidedTour&&Object.keys(this.fpdInstance.mainOptions.guidedTour).length){const t=Object.keys(this.fpdInstance.mainOptions.guidedTour)[0];this.selectStep(t)}}selectStep=t=>{const e=document.body.querySelector(".fpd-gt-step");e&&e.remove();let i=Object.keys(this.fpdInstance.mainOptions.guidedTour).indexOf(t),n=t.split(":"),s=null;if("module"===n[0]?s=this.fpdInstance.mainBar.container.querySelector('.fpd-navigation > [data-module="'+n[1]+'"]'):"action"===n[0]?s=document.body.querySelector('.fpd-btn[data-action="'+n[1]+'"]'):1===n.length&&(s=document.body.querySelector(n[0])),s){if(0===s.length)return void(Object.keys(this.fpdInstance.mainOptions.guidedTour)[i+1]&&this.selectStep(Object.keys(this.fpdInstance.mainOptions.guidedTour)[i+1]));const e=document.createElement("div");e.className="fpd-container fpd-gt-step",e.innerHTML=`<div class="fpd-gt-pointer">\n                <span class="fpd-icon-arrow-dropdown"></span>\n            </div>\n            <div class="fpd-gt-close">\n                <span class="fpd-icon-close"></span>\n            </div>\n            <div class="fpd-gt-text">${this.fpdInstance.mainOptions.guidedTour[t]}</div>\n            <div class="fpd-gt-actions">\n                <div class="fpd-gt-next fpd-btn fpd-primary">${this.fpdInstance.translator.getTranslation("misc","guided_tour_next","Next")}</div>\n                <div class="fpd-gt-back fpd-btn fpd-primary">${this.fpdInstance.translator.getTranslation("misc","guided_tour_back","Back")}</div>\n                <span class="fpd-gt-counter">${String(i+1)+"/"+Object.keys(this.fpdInstance.mainOptions.guidedTour).length}</span>\n            </div>`,document.body.append(e);let n=s.getBoundingClientRect(),r=.5*n.width,a=n.left+r,o=n.top+n.height;a<24&&(a=24),e.style.left=a+"px",e.style.top=o+"px";const l=e.getBoundingClientRect();l.width+l.left>window.innerWidth&&(r=window.innerWidth-(l.width+a),e.style.left=a+r+"px",e.querySelector(".fpd-gt-pointer").style.marginLeft=Math.abs(r)+"px"),o>window.innerHeight-l.height&&(o-=l.height,e.style.top=o+"px",X(e,["fpd-reverse"]));const c=e.querySelector(".fpd-gt-back"),h=Object.keys(this.fpdInstance.mainOptions.guidedTour)[i-1];h?G(c,"click",(t=>{this.selectStep(h)})):X(c,["fpd-hidden"]);const d=e.querySelector(".fpd-gt-next"),u=Object.keys(this.fpdInstance.mainOptions.guidedTour)[i+1];u?G(d,"click",(t=>{this.selectStep(u)})):X(d,["fpd-hidden"]),G(e.querySelector(".fpd-gt-close"),"click",(t=>{K()&&window.localStorage.setItem("fpd-gt-closed","yes"),e.remove()}))}}}function Ba(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function ja(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Fa=new WeakSet,Ra=new WeakSet;class Na extends EventTarget{constructor(t){if(super(),Ba(this,Ra),Ba(this,Fa),e=this,n=!1,(i=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(i="enabled"))in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,this.fpdInstance=t,this.variations=t.mainOptions.bulkVariations,t.mainOptions.bulkVariationsPlacement&&"object"==typeof this.variations&&(this.container=document.querySelector(t.mainOptions.bulkVariationsPlacement),this.container)){this.enabled=!0;const e=document.createElement("div");e.className="fpd-head",this.container.append(e);const i=document.createElement("div");i.className="fpd-headline",i.innerText=t.translator.getTranslation("misc","bulk_add_variations_title","Bulk Order"),e.append(i);const n=document.createElement("span");n.className="fpd-btn",n.innerText=t.translator.getTranslation("misc","bulk_add_variations_add","Add"),e.append(n),G(n,"click",(t=>{ja(this,Fa,Ha).call(this)})),this.listElem=document.createElement("div"),this.listElem.className="fpd-variations-list",this.container.append(this.listElem),X(this.container,["fpd-bulk-variations","fpd-container"]),ja(this,Fa,Ha).call(this),G(t,"getOrder",(()=>{t._order.bulkVariations=this.getOrderVariations()}))}var e,i,n}getOrderVariations(){if(!this.listElem)return!1;let t=[];return this.listElem.querySelectorAll(".fpd-row").forEach((e=>{var i={};e.querySelectorAll("select").forEach((e=>{Q(e.value)&&(t=!1,X(e,["fpd-error"])),i[e.name]=e.value})),!1!==t?t.push({variation:i,quantity:parseInt(e.querySelector(".fpd-quantity").value)}):n(this.fpdInstance.translator.getTranslation("misc","bulk_add_variations_term"))})),t}setup(t){Array.isArray(t)&&(this.listElem.innerHTML="",t.forEach((t=>{ja(this,Fa,Ha).call(this,t)}))),ja(this,Ra,za).call(this)}}function Ha(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=document.createElement("div");e.className="fpd-row",this.listElem.append(e);const i=t.variation||{};for(const t in this.variations){const n=document.createElement("select");n.name=t,n.innerHTML=`<option value='' disabled selected>${t}</option>`,e.append(n),this.variations[t].forEach((e=>{const s=document.createElement("option");s.value=e,s.innerText=e,i[t]==e&&(s.selected=!0),n.append(s)})),G(n,["change"],(t=>{Z(n,["fpd-error"])}))}const n=document.createElement("input");n.className="fpd-quantity",n.type="number",n.min=1,n.step=1,n.value=t.quantity||1,e.append(n),G(n,"change",(t=>{n.value<Number(n.min)&&(n.value=Number(n.min)),""==n.inputElem&&(n.value=1),ja(this,Ra,za).call(this)}));const s=document.createElement("span");s.className="fpd-icon-close",e.append(s),G(s,"click",(t=>{e.remove(),ja(this,Ra,za).call(this)})),ja(this,Ra,za).call(this)}function za(){let t=0;this.listElem.querySelectorAll(".fpd-quantity").forEach((e=>{t+=parseInt(e.value)})),this.fpdInstance.setOrderQuantity(parseInt(t))}function Wa(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Va(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Ua=new WeakSet,Ya=new WeakSet,Ga=new WeakSet,qa=new WeakSet,Xa=new WeakSet;class Za extends EventTarget{constructor(t){super(),Wa(this,Xa),Wa(this,qa),Wa(this,Ga),Wa(this,Ya),Wa(this,Ua),this.fpdInstance=t,Q(t.mainOptions.colorSelectionPlacement)||(this.container=document.querySelector(t.mainOptions.colorSelectionPlacement),this.container&&(X(this.container,["fpd-color-selection","fpd-container"]),G(t,"productCreate",Va(this,Ua,Ja).bind(this)),G(t,"elementAdd",Va(this,Ua,Ja).bind(this)))),G(t,"elementRemove",(t=>{const{element:e}=t.detail;if(e&&e.showInColorSelection){const t=this.container.querySelector('.fpd-cs-item[data-id="'+e.id+'"]');t&&t.remove()}}))}}function Ja(){this.container.innerHTML="";const t=this.fpdInstance.getElements(0).filter((t=>t.showInColorSelection));J(this.container,["fpd-hidden"],0==t.length),t.forEach((t=>{Va(this,Ya,Qa).call(this,t)}))}function Qa(t){if(t.hasColorSelection()){const e=document.createElement("div");e.className="fpd-cs-item",e.dataset.id=t.id,e.innerHTML=`<div class="fpd-title">${t.title}</div>`,this.container.append(e);let i,n=rt(t,this.fpdInstance);if("group"===t.type&&t.getObjects().length>1){const e=Array.isArray(t.colors)&&t.colors.length>1;i=Bn({colors:n,colorNames:this.fpdInstance.mainOptions.hexNames,palette:t.colors,subPalette:e,enablePicker:!e,onChange:(e,i)=>{Va(this,Ga,Ka).call(this,t,i,e)},onMove:(e,i)=>{t.changeObjectColor(i,e)}})}else i=jn(this.fpdInstance,{colors:n,patterns:Array.isArray(t.patterns)&&(t.isSVG()||"text"===t.getType())?t.patterns:null,onMove:e=>{Va(this,qa,$a).call(this,t,e)},onChange:e=>{Va(this,Xa,to).call(this,t,e)},onPatternChange:e=>{this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({pattern:e},t)}});i&&e.append(i)}}function Ka(t,e,i){const n=t.changeObjectColor(e,i);this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:n},t)}function $a(t,e){"png"!==t.isColorizable()&&t.changeColor(e)}function to(t,e){this.fpdInstance.currentViewInstance.fabricCanvas.setElementOptions({fill:e},t)}window.FPDColorSelection=Za;var eo=new WeakSet;class io{constructor(t){if(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,i=eo),i.add(e),this.fpdInstance=t,t.mainOptions.viewThumbnailsWrapper){let e;"main-wrapper"==t.mainOptions.viewThumbnailsWrapper?(e=document.createElement("div"),this.fpdInstance.mainWrapper.container.append(e)):e=t.mainOptions.viewThumbnailsWrapper,this.container="string"==typeof e?document.querySelector(e):e,this.container&&(X(this.container,["fpd-view-thumbnails-wrapper"]),G(this.fpdInstance,["viewCreate","viewRemove","viewMove"],function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}(this,eo,no).bind(this)))}var e,i}}function no(t){this.container.innerHTML="",this.fpdInstance.viewInstances.forEach(((t,e)=>{const i=document.createElement("div");i.className="fpd-item fpd-tooltip fpd-shadow-1",i.setAttribute("aria-label",t.title),i.style.backgroundImage=`url("${t.thumbnail}")`,this.container.append(i),G(i,"click",(()=>{this.fpdInstance.selectView(e)}))})),J(this.container,["fpd-hidden"],this.fpdInstance.viewInstances.length<2)}class so extends EventTarget{constructor(t){super(),this.fpdInstance=t,this.container=t.mainWrapper.container.querySelector(".fpd-advanced-image-editor"),this.currentElement=null,this.fImg=null,this.mask=null,this.fabricCanvas=new fabric.Canvas(this.container.querySelector("canvas"),{containerClass:"fpd-aie-canvas",selection:!1}),this.fabricCanvas.setBackgroundColor("#fff",this.fabricCanvas.renderAll.bind(this.fabricCanvas)),G(this.container.querySelector(".fpd-close"),"click",(()=>{this.fabricCanvas.clear(),this.toggle(!1)})),G(this.container.querySelector(".fpd-done"),"click",(()=>{this.mask.set("fill","transparent"),this.fabricCanvas.clipPath=this.mask;let e={format:"png",top:this.fImg.top,left:this.fImg.left,width:this.fImg.getScaledWidth(),height:this.fImg.getScaledHeight(),multiplier:this.fImg.width/this.fabricCanvas.width};const i=this.fabricCanvas.toDataURL(e);t._downloadRemoteImage(i,"mask",{},(e=>{e.url?this.currentElement.setSrc(e.url,(()=>{this.currentElement.source=e.url,this.currentElement.canvas.renderAll(),q(t,"viewCanvasUpdate",{viewInstance:t.currentViewInstance})}),{crossOrigin:"anonymous"}):e.error&&n(e.error),Z(t.viewsNav.container,["fpd-disabled"]),t.loadingCustomImage=!1,t.toggleSpinner(!1)})),this.toggle(!1)}))}toggle(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.fabricCanvas.clipPath=null,this.fabricCanvas.clear(),J(this.container,["fpd-hidden"],!t),J(this.fpdInstance.container,["fpd-aie-visible"],t)}loadImage(t,e){this.mask=null,this.currentElement=t,this.toggle(),this.fabricCanvas.setDimensions({width:this.container.offsetWidth,height:this.container.offsetHeight}),fabric.Image.fromURL(t.originParams.source,(t=>{this.fImg=t,t.evented=!1,t.width>t.height?t.scaleToWidth(this.fabricCanvas.width):t.scaleToHeight(this.fabricCanvas.height),this.fabricCanvas.add(t),t.center(),fabric.loadSVGFromURL(e,((t,e)=>{t&&(this.mask=t?fabric.util.groupSVGElements(t,e):null,this.mask.setOptions({selectable:!0,evented:!0,resizable:!0,rotatable:!0,lockUniScaling:!1,lockRotation:!1,borderColor:"transparent",fill:"rgba(184,233,134,0.4)",centeredScaling:!0,transparentCorners:!0,absolutePositioned:!1,cornerSize:24,objectCaching:!1}),this.fabricCanvas.width<this.fabricCanvas.height?this.mask.scaleToWidth(this.fabricCanvas.width-100):this.mask.scaleToHeight(this.fabricCanvas.height-100),this.fabricCanvas.add(this.mask),this.mask.center(),this.fabricCanvas.setActiveObject(this.mask))}))}),{crossOrigin:"anonymous"})}}function ro(t,e){ao(t,e),e.add(t)}function ao(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oo(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,lo(t,e,"get"))}function lo(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function co(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var ho=new WeakMap,uo=new WeakSet,fo=new WeakSet,po=new WeakSet;class go extends EventTarget{constructor(t){var e,i;super(),ro(this,po),ro(this,fo),ro(this,uo),i={writable:!0,value:0},ao(this,e=ho),e.set(this,i),function(t,e,i){(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"currentLayout",""),this.fpdInstance=t}init(){if(this.fpdInstance.mainOptions.modalMode){this.fpdInstance.mainOptions.maxCanvasHeight=.75,this.fpdInstance.mainOptions.canvasHeight="auto",this.fpdInstance.mainOptions.fabricCanvasOptions.allowTouchScrolling=!1;let t=!1;X(document.body,["fpd-modal-mode-active"]),Z(this.fpdInstance.container,["fpd-off-canvas","fpd-topbar"]),X(this.fpdInstance.container,["fpd-sidebar"]);const e=document.createElement("div");e.className="fpd-modal-product-designer fpd-modal-overlay fpd-fullscreen",document.body.append(e),this.fpdInstance.modalWrapper=e;const i=document.createElement("div");i.className="fpd-modal-inner",i.append(this.fpdInstance.container),e.append(i);const n=document.querySelector(this.fpdInstance.mainOptions.modalMode);G(n,"click",(i=>{i.preventDefault(),X(document.body,["fpd-overflow-hidden","fpd-modal-designer-visible"]),X(e,["fpd-show"]),this.fpdInstance.selectView(0),this.fpdInstance.currentViewInstance&&(this.fpdInstance.currentViewInstance.fabricCanvas.resetZoom(),t||this.fpdInstance.doAutoSelect()),t=!0,q(this.fpdInstance,"modalDesignerOpen",{}),q(window,"fpdModalDesignerOpen",{})})),G(this.fpdInstance,"modalDesignerClose",(()=>{Z(document.body,["fpd-overflow-hidden","fpd-modal-designer-visible"])})),G(this.fpdInstance,"priceChange",(()=>{e.querySelector("fpd-actions-bar .fpd-total-price").innerHTML=this.fpdInstance.formatPrice(this.fpdInstance.currentPrice)}))}this.fpdInstance.container.classList.add("fpd-container"),this.fpdInstance.container.classList.add("fpd-wrapper");const t=document.createElement("div");t.innerHTML='<div class="fpd-loader-wrapper"> <div class="fpd-loader"> <div class="fpd-loader-circle"></div> <span class="fpd-loader-text" data-defaulttext="Initializing Product Designer">misc.initializing</span> </div> </div>',this.fpdInstance.container.appendChild(t.firstChild.cloneNode(!0)),this.fpdInstance.mainLoader=this.fpdInstance.container.querySelector(".fpd-loader-wrapper"),this.fpdInstance.actionsBar=new Ie(this.fpdInstance),this.fpdInstance.mainBar=new br(this.fpdInstance),this.fpdInstance.mainWrapper=new Ar(this.fpdInstance),this.fpdInstance.productStage=this.fpdInstance.mainWrapper.container.querySelector(".fpd-product-stage"),this.fpdInstance.viewsNav=new Br(this.fpdInstance),this.fpdInstance.viewsGrid=new Vr(this.fpdInstance),this.fpdInstance.advancedImageEditor=new so(this.fpdInstance),this.fpdInstance.bulkVariations=new Na(this.fpdInstance),this.fpdInstance.colorSelection=new Za(this.fpdInstance),this.fpdInstance.viewThumbnails=new io(this.fpdInstance),this.fpdInstance.guidedTour=new La(this.fpdInstance),this.fpdInstance.translator.translateArea(this.fpdInstance.container),this.dispatchEvent(new CustomEvent("ready")),window.addEventListener("resize",co(this,uo,mo).bind(this)),co(this,uo,mo).call(this),co(this,fo,vo).call(this),co(this,po,bo).call(this)}updateToolbarWrapper(){const t=document.querySelector("fpd-element-toolbar");t&&t.remove(),this.fpdInstance.toolbar=new va(this.fpdInstance),this.fpdInstance.translator.translateArea(this.fpdInstance.toolbar.container)}}function mo(){const t=this.fpdInstance.mainOptions.responsiveBreakpoints;let e;var i,n,s;i=this,n=ho,s=window.innerWidth,function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(i,lo(i,n,"set"),s),oo(this,ho)<t.small?(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-small"),e="small"):oo(this,ho)<t.medium?(this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.remove("fpd-layout-large"),this.fpdInstance.container.classList.add("fpd-layout-medium"),e="medium"):(this.fpdInstance.container.classList.remove("fpd-layout-medium"),this.fpdInstance.container.classList.remove("fpd-layout-small"),this.fpdInstance.container.classList.add("fpd-layout-large"),e="large"),this.fpdInstance.container.dataset.layout=e,e!=this.currentLayout&&(this.currentLayout=e,this.updateToolbarWrapper(),this.fpdInstance.dispatchEvent(new CustomEvent("uiLayoutChange",{detail:{layout:e}})))}function vo(){const t=document.body;let e;e=document.createElement("div"),e.className="fpd-thumbnail-preview fpd-shadow-1 fpd-hidden",e.innerHTML="<picture></picture>";const i=document.createElement("div");i.className="fpd-preview-title",e.append(i),t.append(e),G(t,["mouseover","mouseout","mousemove","click"],(t=>{if(this.fpdInstance.draggedPlaceholder)return void e.classList.add("fpd-hidden");const n=t.target;if(n.classList.contains("fpd-hover-thumbnail")&&e.classList.contains("fpd-hidden")&&"mouseover"===t.type&&n.dataset.source){e.querySelector(".fpd-price")&&e.querySelector(".fpd-price").remove(),e.querySelector(".fpd-image-quality-ratings")&&e.querySelector(".fpd-image-quality-ratings").remove(),e.querySelector("picture").style.backgroundImage=`url("${n.dataset.source}")`,n.dataset.title&&(i.innerText=n.dataset.title),J(i,["fpd-hidden"],!n.dataset.title),J(e,["fpd-title-enabled"],n.dataset.title);const t=n.querySelector(".fpd-price");t&&e.append(t.cloneNode(!0));const s=n.querySelector(".fpd-image-quality-ratings");if(s){const t=s.cloneNode(!0),i=document.createElement("span");i.className="fpd-image-quality-rating-label",i.innerText=s.dataset.qualityLabel,t.prepend(i),e.append(t)}e.classList.remove("fpd-hidden")}if(e.classList.contains("fpd-hidden")||"mousemove"!==t.type&&"mouseover"!==t.type)"mouseout"!==t.type&&"click"!=t.type||e.classList.add("fpd-hidden");else{const i=t.pageX+10+e.offsetWidth>window.innerWidth?window.innerWidth-e.offsetWidth:t.pageX+10;e.style.left=i+"px",e.style.top=t.pageY+10+"px"}}))}function bo(){const t=document.body,e=document.createElement("div");e.className="fpd-main-tooltip",t.append(e),this.fpdInstance.mainTooltip=e,t.addEventListener("mouseover",(t=>{const i=t.target;if(i.classList.contains("fpd-tooltip")){let t=i.getAttribute("aria-label");null===t&&(t=i.getAttribute("title")),e.innerHTML=t;const n=5,{x:s,y:r,width:a,height:o}=i.getBoundingClientRect();let l=Math.floor(r-e.clientHeight-n),c=Math.floor(s+a/2-e.clientWidth/2);l<0&&(l=Math.floor(r+o+n)),c<0?c=0:c>window.outerWidth-e.clientWidth&&(c=window.outerWidth-e.clientWidth-n),e.style.left=`${c}px`,e.style.top=`${l}px`,e.classList.add("fpd-show")}else e.classList.remove("fpd-show")})),t.addEventListener("touchstart",(t=>{e.classList.remove("fpd-show")}))}class yo{constructor(t){const e=document.querySelector(t.mainOptions.editorMode);e&&(X(e,["fpd-editor-box-wrapper","fpd-container"]),this.titleElem=document.createElement("div"),this.titleElem.className="fpd-eb-title",e.append(this.titleElem),this.gridElem=document.createElement("div"),this.gridElem.className="fpd-eb-grid",e.append(this.gridElem),t.mainOptions.editorBoxParameters.forEach((t=>{const e=document.createElement("div");e.innerHTML="<span>"+t+'</span><input type="text" readonly data-prop="'+t+'" />',this.gridElem.append(e)}))),G(t,["elementSelect","elementChange"],(i=>{e&&(t.currentElement?(this.titleElem.innerText=t.currentElement.title,t.mainOptions.editorBoxParameters.forEach((e=>{let i=t.currentElement[e];if(void 0!==i){i="number"==typeof i?i.toFixed(2):i,i="object"==typeof i&&i.source?i.source.src:i,"fill"===e&&"group"===t.currentElement.type&&(i=t.currentElement.svgFill);const n=this.gridElem.querySelector('input[data-prop="'+e+'"]');n&&(n.value=i)}}))):this.titleElem.innerText="",J(this.gridElem,["fpd-hidden"],!t.currentElement))}))}}function xo(t,e){Co(t,e),e.add(t)}function wo(t,e,i){Co(t,e),e.set(t,i)}function Co(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function So(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function To(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Ao(t,e,"get"))}function Eo(t,e,i){return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=i}}(t,Ao(t,e,"set"),i),i}function Ao(t,e,i){if(!e.has(t))throw new TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function Io(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var Oo=new WeakMap,ko=new WeakMap,Mo=new WeakSet,Po=new WeakSet,_o=new WeakSet,Do=new WeakSet,Lo=new WeakSet,Bo=new WeakSet,jo=new WeakSet,Fo=new WeakSet,Ro=new WeakSet,No=new WeakSet,Ho=new WeakSet;class zo extends EventTarget{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),xo(this,Ho),xo(this,No),xo(this,Ro),xo(this,Fo),xo(this,jo),xo(this,Bo),xo(this,Lo),xo(this,Do),xo(this,_o),xo(this,Po),xo(this,Mo),So(this,"container",null),So(this,"mainOptions",{}),So(this,"currentViewInstance",null),So(this,"currentViewIndex",0),So(this,"products",[]),So(this,"designs",[]),So(this,"modalContainer",document.body),So(this,"currentCategoryIndex",0),So(this,"currentProductIndex",0),So(this,"viewInstances",[]),So(this,"productViews",null),So(this,"currentElement",null),So(this,"productCreated",!1),So(this,"colorLinkGroups",{}),So(this,"globalCustomElements",[]),So(this,"doUnsavedAlert",!1),So(this,"currentPrice",0),So(this,"singleProductPrice",0),So(this,"pricingRulesPrice",0),So(this,"watermarkImg",null),So(this,"currentLayouts",[]),So(this,"orderQuantity",1),So(this,"bulkVariations",null),So(this,"industryType",null),So(this,"loadingCustomImage",!1),So(this,"lazyBackgroundObserver",null),So(this,"draggedPlaceholder",null),So(this,"mouseOverCanvas",!1),So(this,"firstProductCreated",!1),wo(this,Oo,{writable:!0,value:0}),wo(this,ko,{writable:!0,value:0}),So(this,"inTextField",!1),So(this,"_order",{}),!t)return void console.log("No DOM element found for FPD.");this.lazyBackgroundObserver=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){t.classList.add("fpd-on-loading");var i=new Image;i.src=e||t.dataset.img,i.onload=function(){t.dataset.originwidth=this.width,t.dataset.originheight=this.height,t.classList.remove("fpd-on-loading"),t.style.backgroundImage='url("'+this.src+'")'},i.onerror=function(){t.parentNode.remove()}}}(t.target),this.lazyBackgroundObserver.unobserve(t.target))}))})),this.container=t,this.container.instance=this,this.mainOptions=dt.merge(dt.defaults,e);let i={};Object.keys(this.mainOptions.hexNames).forEach((t=>{i[t.toLowerCase()]=this.mainOptions.hexNames[t]})),this.mainOptions.hexNames=i,this.mainOptions.textParameters.direction=window.getComputedStyle(document.body||document.documentElement).direction,"rtl"==this.mainOptions.textParameters.direction&&(this.mainOptions.textParameters.textAlign="right"),"advanced"==this.mainOptions.cornerControlsStyle&&At(),(t.classList.contains("fpd-off-canvas")||t.classList.contains("fpd-topbar"))&&(this.mainOptions.toolbarPlacement="smart"),Array.isArray(this.mainOptions.pricingRules)&&this.mainOptions.pricingRules.length&&(this.pricingRulesInstance=new bt(this)),this.mainOptions.editorMode&&X(document.body,["fpd-editor-mode"]),this.translator=new Yt,this.translator.loadLangJSON(this.mainOptions.langJSON,Io(this,Mo,Wo).bind(this))}setupProducts(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.products=[],t.forEach((t=>{t.hasOwnProperty("category")?t.products.forEach((e=>{this.addProduct(e,t.category)})):this.addProduct(t)})),this.mainOptions.loadFirstProductInStage&&t.length>0?this.selectProduct(0):this.toggleSpinner(!1),q(this,"productsSet",{})}setupDesigns(t){this.designs=t,q(this,"designsSet",{})}addProduct(t,e){var i=Io(this,Do,Yo).call(this,e);void 0===e?this.products.push(t):(!1===i&&(i=this.products.length,this.products[i]={category:e,products:[]}),this.products[i].products.push(t)),q(this,"productAdd",{views:t,category:e,catIndex:i})}selectProduct(t,e){let i;Eo(this,Oo,Eo(this,ko,0)),this.currentCategoryIndex=void 0===e?this.currentCategoryIndex:e,i=this.products&&this.products.length&&this.products[0].category?this.products[this.currentCategoryIndex].products:this.products,this.currentProductIndex=t,t<0?this.currentProductIndex=0:t>i.length-1&&(this.currentProductIndex=i.length-1);const n=i[this.currentProductIndex];this.loadProduct(n,this.mainOptions.replaceInitialElements)}loadProduct(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(q(this,"productSelect",{product:t}),this.toggleSpinner(!0),this.productCreated=!1,this.colorLinkGroups={},this.globalCustomElements=[],e?this.globalCustomElements=this.getCustomElements():this.doUnsavedAlert=!1,this.fixedElements=this.getFixedElements(),this.reset(),t.forEach(((t,e)=>{i&&(t.options=dt.merge(this.mainOptions,t.options));const n={};N(t.options)&&Ht.relevantOptions.forEach((e=>{void 0!==t.options[e]&&(n[e]=t.options[e])})),t.options=n})),this.productViews=t,Eo(this,Oo,Eo(this,ko,0)),t.forEach(((t,e)=>{Eo(this,Oo,To(this,Oo)+t.elements.length)})),G(this,"viewCreate",Io(this,Lo,Go)),t&&this.addView(t[0]))}addView(t){let e={};Ht.relevantOptions.forEach((t=>{let i=this.mainOptions[t];e[t]=N(i)?{...i}:i})),t.options=N(t.options)?z(e,t.options):e,document.body.dataset.fpdIndustryType="",this.industryType=null,0==this.viewInstances.length&&t.options.industry&&t.options.industry.type&&(this.industryType=t.options.industry.type,document.body.dataset.fpdIndustryType=this.industryType);let i=new Ht(this.productStage,t,Io(this,Fo,Zo).bind(this),this.mainOptions.fabricCanvasOptions);i.fabricCanvas.on({"mouse:move":t=>{this.mouseOverCanvas=!t.target||t.target},"mouse:out":t=>{this.mouseOverCanvas=!1},beforeElementAdd:t=>{if(t.params,this.mainBar&&this.uiManager&&"small"==this.uiManager.currentLayout&&this.mainBar.toggleContentDisplay(!1),!this.productCreated){var e;Eo(this,ko,(e=To(this,ko),++e));const i=t.title+"<br>"+String(To(this,ko))+"/"+To(this,Oo);this.mainLoader.querySelector(".fpd-loader-text").innerHTML=i}q(this,"beforeElementAdd",{element:t})},elementAdd:t=>{let{element:e}=t;if(e){if(this.productCreated&&"image"==e.getType()&&e.isCustom&&this.toggleSpinner(!1),!this.mainOptions.editorMode&&e.replace&&e.replaceInAllViews&&this.viewInstances.forEach(((t,i)=>{this.currentViewIndex!=i&&t.fabricCanvas.getElementByReplace(e.replace)&&!e._replaceAdded&&t.fabricCanvas.addElement(e.getType(),e.source,e.title,{...e.originParams,_replaceAdded:!0})})),e.colorLinkGroup&&e.colorLinkGroup.length>0&&!this.mainOptions.editorMode){var n=this.getViewIndexByWrapper(i.fabricCanvas.wrapperEl);if(this.colorLinkGroups.hasOwnProperty(e.colorLinkGroup))if(this.colorLinkGroups[e.colorLinkGroup].elements.push({id:e.id,viewIndex:n}),"object"==typeof e.colors){const t=this.mainOptions.replaceColorsInColorGroup?e.colors:this.colorLinkGroups[e.colorLinkGroup].colors.concat(e.colors);this.colorLinkGroups[e.colorLinkGroup].colors=U(t)}else 1!==e.colors&&!0!==e.colors||(this.colorLinkGroups[e.colorLinkGroup].colors=["#000"]);else this.colorLinkGroups[e.colorLinkGroup]={elements:[{id:e.id,viewIndex:n}],colors:[]},"object"==typeof e.colors?this.colorLinkGroups[e.colorLinkGroup].colors=e.colors:1!==e.colors&&!0!==e.colors||(this.colorLinkGroups[e.colorLinkGroup].colors=["#000"])}this.productCreated&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1),q(this,"elementAdd",{element:e}),q(this,"viewCanvasUpdate",{viewInstance:i})}else this.toggleSpinner(!1)},elementRemove:t=>{let{element:e}=t;const n=this.fixedElements.findIndex((t=>t.element.title==e.title));-1!=n&&this.fixedElements.splice(n,1),q(this,"elementRemove",{element:e}),q(this,"viewCanvasUpdate",{viewInstance:i})},elementSelect:t=>{let{element:e}=t;if(this.currentElement=e,Io(this,Ro,Jo).call(this),e&&!e._ignore&&this.currentViewInstance){if(e.uploadZone&&!this.mainOptions.editorMode){let t=z(this.currentViewInstance.options.customAdds,e.customAdds||{});return void setTimeout((()=>{this.currentViewInstance.currentUploadZone=e.title,this.mainBar.toggleUploadZonePanel(!0,t)}),100)}this.currentViewInstance.currentUploadZone&&this.mainBar.toggleUploadZonePanel(!1)}q(this,"elementSelect",{}),this.mainOptions.openTextInputOnSelect&&e&&"text"===e.getType()&&e.editable&&this.toolbar&&this.toolbar.container.querySelector(".fpd-tool-edit-text").click(),Io(this,No,Qo).call(this)},multiSelect:t=>{let{activeSelection:e}=t;q(this,"multiSelect",{activeSelection:e})},elementCheckContainemt:t=>{let{target:e,boundingBoxMode:i}=t;"inside"===i&&Io(this,Ro,Jo).call(this)},elementFillChange:t=>{let{element:e,colorLinking:n}=t;if(this.productCreated&&n&&e.colorLinkGroup&&e.colorLinkGroup.length>0){const t=this.colorLinkGroups[e.colorLinkGroup];t&&t.elements&&t.elements.forEach((t=>{if(e.id!=t.id){const i=this.viewInstances[t.viewIndex].fabricCanvas.getElementByID(t.id);i&&i.changeColor(e.fill,!1)}}))}q(this,"elementFillChange",{element:e,colorLinking:n}),q(this,"viewCanvasUpdate",{viewInstance:i}),this.applyTextLinkGroup(e,{fill:e.fill})},elementChange:t=>{let{element:e,type:i}=t;Io(this,Ro,Jo).call(this),"scaling"===i&&Io(this,No,Qo).call(this,e),q(this,"elementChange",{type:i,element:e})},elementModify:t=>{let{element:e,options:n}=t;Io(this,Ro,Jo).call(this),this.applyTextLinkGroup(e,n),Io(this,No,Qo).call(this,e),q(this,"elementModify",{options:n,element:e}),q(this,"viewCanvasUpdate",{viewInstance:i})},"text:changed":t=>{let{target:e}=t;this.applyTextLinkGroup(e,{text:e.text})},"history:append":()=>{Io(this,Bo,qo).call(this,"append")},"history:clear":()=>{Io(this,Bo,qo).call(this,"clear")},"history:undo":()=>{Io(this,Bo,qo).call(this,"undo")},"history:redo":()=>{Io(this,Bo,qo).call(this,"redo")}}),G(i,"priceChange",(t=>{this.calculatePrice()})),i.init()}doAutoSelect(){if(this.currentViewInstance.locked)return;let t=null;this.currentViewInstance.fabricCanvas.getObjects().forEach((e=>{e.autoSelect&&!e.hasUploadZone&&(t=e)})),t&&setTimeout((()=>{this.currentViewInstance.fabricCanvas.setActiveObject(t).renderAll()}),500)}aiRequestError(t){n(t),this.toggleSpinner(!1)}calcElementDPI(t){return t&&!t.uploadZone&&t.isBitmap()&&H(this.currentViewInstance.options.output,["width","height"])&&H(this.currentViewInstance.options.printingBox,["left","top","width","height"])?Math.ceil(25.4*this.currentViewInstance.options.printingBox.width/this.currentViewInstance.options.output.width/t.scaleX):null}calcDisplaySize(t){let e=this.mainOptions.rulerUnit,i="cm"==e?10:1,n=1,s=1,r=null;H(this.currentViewInstance.options.printingBox,["left","top","width","height"])&&H(this.currentViewInstance.options.output,["width","height"])?(r=this.calcElementDPI(t),"px"!=e&&(n=this.currentViewInstance.options.output.width/this.currentViewInstance.options.printingBox.width,s=this.currentViewInstance.options.output.height/this.currentViewInstance.options.printingBox.height)):(i=1,e="px");let a=parseInt(t.width*t.scaleX*n);a=parseInt(a/i);let o=parseInt(t.height*t.scaleY*s);return o=parseInt(o/i),{width:a,height:o,unit:e,dpi:r}}applyTextLinkGroup(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&!Q(t.textLinkGroup)){const i=this.mainOptions.textLinkGroupProps||[];this.viewInstances.forEach((n=>{n.fabricCanvas.getObjects().forEach((s=>{s!==t&&"text"===s.getType()&&s.textLinkGroup===t.textLinkGroup&&("string"==typeof e.text&&(s.set("text",t.text),s.fire("changed"),q(this,"textLinkApply",{element:s,options:{text:t.text}})),Object.keys(t).filter((t=>i.includes(t))).forEach((e=>{s.set(e,t[e]),q(this,"textLinkApply",{element:s,options:{[e]:t[e]}})})),n.fabricCanvas.renderAll())}))}))}}getViewIndexByWrapper(t){return Array.from(this.productStage.querySelectorAll(".fpd-view-stage")).indexOf(t)}toggleSpinner(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return!!this.mainLoader&&(this.mainLoader.querySelector(".fpd-loader-text").innerText=e,this.mainLoader.classList.toggle("fpd-hidden",!t),this.mainLoader)}selectView(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.viewInstances.length<=0)return;this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&this.currentViewInstance.fabricCanvas.resetZoom(),this.currentViewIndex=t,t<0?this.currentViewIndex=0:t>this.viewInstances.length-1&&(this.currentViewIndex=this.viewInstances.length-1),this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&this.currentViewInstance.fabricCanvas.clearHistory(),this.currentViewInstance=this.viewInstances[this.currentViewIndex],this.deselectElement();const e=this.productStage.querySelectorAll(".fpd-view-stage");X(e,["fpd-hidden"]),Z(e.item(this.currentViewIndex),["fpd-hidden"]),J(document.body.querySelectorAll('.fpd-btn[data-action="previous-view"], .fpd-btn[data-action="next-view"]'),["fpd-hidden"],this.viewInstances.length<=1),J(document.body.querySelectorAll("fpd-views-nav"),["fpd-hidden"],this.viewInstances.length<=1&&!this.mainOptions.enableDynamicViews),J(document.body.querySelectorAll('.fpd-btn[data-action="previous-view"], .fpd-view-prev'),["fpd-disabled"],0==this.currentViewIndex),J(document.body.querySelectorAll('.fpd-btn[data-action="next-view"], .fpd-view-next'),["fpd-disabled"],this.currentViewIndex===this.viewInstances.length-1),Io(this,jo,Xo).call(this),this.currentViewInstance.fabricCanvas.snapToGrid=!1,this.currentViewInstance.fabricCanvas.enableRuler=this.mainOptions.rulerFixed,this.currentViewInstance.fabricCanvas.resetSize(),q(this,"viewSelect")}getElements(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=void 0===t||isNaN(t)?-1:t,i&&this.deselectElement();let n=[];if(-1===t)for(var s=0;s<this.viewInstances.length;++s)n=n.concat(this.viewInstances[s].fabricCanvas.getElements(e,i));else{if(!this.viewInstances[t])return[];n=this.viewInstances[t].fabricCanvas.getElements(e,i)}return n}getCustomElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=[];return this.getElements(e,t,i).forEach((t=>{if(t.isCustom){const e=this.getViewIndexByWrapper(t.canvas.wrapperEl);n.push({element:t,viewIndex:e})}})),n}getFixedElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=[];return this.getElements(e,t,i).forEach((t=>{if(t.fixed){const e=this.getViewIndexByWrapper(t.canvas.wrapperEl);n.push({element:t,viewIndex:e})}})),n}reset(){null!==this.productViews&&(this.removeEventListener("viewCreate",Io(this,Lo,Go)),this.deselectElement(),this.currentViewInstance&&this.currentViewInstance.fabricCanvas.resetZoom(),this.currentViewIndex=this.currentPrice=this.singleProductPrice=this.pricingRulesPrice=0,this.currentViewInstance=this.productViews=this.currentElement=null,this.viewInstances.forEach((t=>{t.fabricCanvas.dispose()})),this.productStage.innerHTML="",this.viewInstances=[],q(this,"clear"),q(this,"priceChange"))}deselectElement(){this.currentViewInstance&&this.currentViewInstance.fabricCanvas&&(this.currentViewInstance.fabricCanvas.deselectElement(),this.currentElement=null)}addCustomImage(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;s=void 0===s?this.currentViewIndex:s;const r=new Image;r.crossOrigin="anonymous",r.src=t,this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),X(this.viewsNav.container,["fpd-disabled"]),r.onload=()=>{this.loadingCustomImage=!1;let n=r.height,a=r.width,o=this.currentViewInstance.options.customImageParameters;if(!et(this,a,n))return this.toggleSpinner(!1),!1;let l={isCustom:!0,isCustomImage:!0};r.src.includes(".svg")&&!o.colors&&(l.colors=!0);let c=z(o,l);c=z(c,i),this.viewInstances[s].fabricCanvas.addElement("image",t,e,c,s),Z(this.viewsNav.container,["fpd-disabled"])},r.onerror=()=>{Z(this.viewsNav.container,["fpd-disabled"]),n("Image could not be loaded!")}}_addGridItemToCanvas(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.currentViewInstance)return;i=void 0===i?this.currentViewIndex:i;const s=z({_addToUZ:this.currentViewInstance.currentUploadZone},e);this.productCreated&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1),this._addCanvasImage(t.dataset.source,t.dataset.title,s,i,n)}_addCanvasImage(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.currentViewInstance&&(n=void 0===n?this.currentViewIndex:n,zo.uploadsToServer&&s?this._downloadRemoteImage(t,e,i):(this.loadingCustomImage=!0,this.addCustomImage(t,e,i,n)))}_downloadRemoteImage(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.mainOptions.fileServerURL)return void alert("You need to set the fileServerURL in the option, otherwise file uploading does not work!");this.loadingCustomImage=!0,this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),X(this.viewsNav.container,["fpd-disabled"]);const r=new FormData;r.append("url",t);const a=t=>{Z(this.viewsNav.container,["fpd-disabled"]),this.toggleSpinner(!1),n(t)};Ut({url:this.getFileServerURL(),body:r,onSuccess:t=>{t&&t.image_src?s?s({url:t.image_src}):this.addCustomImage(t.image_src,t.filename?t.filename:e,i):s?s({error:t.image_src}):a(t.error)},onError:a})}addCanvasDesign(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.currentViewInstance&&(this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),i=z(this.currentViewInstance.options.customImageParameters,i),i.isCustom=!0,this.currentViewInstance.currentUploadZone&&(i._addToUZ=this.currentViewInstance.currentUploadZone),this.productCreated&&this.mainOptions.hideDialogOnAdd&&this.mainBar&&this.mainBar.toggleContentDisplay(!1),Array.isArray(i.relatedViewImages)&&i.relatedViewImages.length>0?(i.replaceInAllViews=!1,this.viewInstances[0].fabricCanvas.addElement("image",t,e,i),i.relatedViewImages.forEach((t=>{!Q(t.viewIndex)&&!Q(t.url)&&!Q(t.title)&&t.viewIndex>0&&this.viewInstances[t.viewIndex]&&this.viewInstances[t.viewIndex].fabricCanvas.addElement("image",t.url,t.title,{replaceInAllViews:!1,replace:i.replace})}))):this.currentViewInstance.fabricCanvas.addElement("image",t,e,i))}toggleResponsive(t){return t=void 0===t?this.container.classList.contains("fpd-not-responsive"):t,J(this.container,["fpd-not-responsive"],!t),this.viewInstances.forEach(((e,i)=>{e.options.responsive=t,i==this.currentViewIndex&&e.fabricCanvas.resetSize()})),t}getProduct(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!1,s="all"==this.mainOptions.customizationRequiredRule?"every":"some";if(i=this.viewInstances[s]((t=>t.fabricCanvas.isCustomized)),e&&!i)return n(this.translator.getTranslation("misc","customization_required_info")),!1;this.deselectElement(),this.currentViewInstance.fabricCanvas.resetZoom(),this.doUnsavedAlert=!1;let r=[];return this.getElements().forEach((t=>{t.isOut&&"inside"===t.boundingBoxMode&&!t.__editorMode&&(n(t.title+": "+this.translator.getTranslation("misc","out_of_bounding_box")),r=!1)})),!1!==r&&(this.viewInstances.forEach(((e,i)=>{const n={title:e.title,thumbnail:e.thumbnail,elements:e.fabricCanvas.getElementsJSON(t),options:e.options,names_numbers:e.names_numbers,mask:e.mask,locked:e.locked};0==i&&this.productViews[0].hasOwnProperty("productTitle")&&(n.productTitle=this.productViews[0].productTitle),r.push(n)})),r)}getProductDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e.onlyExportable=void 0!==e.onlyExportable&&e.onlyExportable,e.enableRetinaScaling=void 0!==e.enableRetinaScaling&&e.enableRetinaScaling,e.watermarkImg=this.watermarkImg,0===this.viewInstances.length)return void t("");this.currentViewInstance.fabricCanvas.resetZoom();const n=document.createElement("canvas");let s=new fabric.Canvas(n,{containerClass:"fpd-hidden fpd-hidden-canvas",enableRetinaScaling:!1}),r=0,a=e.multiplier?e.multiplier:1,o=2==i.length?this.viewInstances.slice(i[0],i[1]):this.viewInstances;const l=i=>{i.toDataURL((n=>{fabric.Image.fromURL(n,(n=>{s.add(n),r>0&&(n.set("top",s.getHeight()),s.setDimensions({height:s.getHeight()+i.options.stageHeight*a})),r++,r<o.length?l(o[r]):(delete e.multiplier,setTimeout((function(){t(s.toDataURL(e)),s.dispose(),this.currentViewInstance&&this.currentViewInstance.fabricCanvas.resetSize()}),100))}),{crossOrigin:"anonymous"})}),e),i.options.stageWidth*a>s.getWidth()&&s.setDimensions({width:i.options.stageWidth*a})},c=o[0];s.setDimensions({width:c.options.stageWidth*a,height:c.options.stageHeight*a}),l(c)}getViewsDataURL(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.watermarkImg=this.watermarkImg;let i=[];this.currentViewInstance.fabricCanvas.resetZoom();for(var n=0;n<this.viewInstances.length;++n)this.viewInstances[n].toDataURL((e=>{i.push(e),i.length===this.viewInstances.length&&t(i)}),e)}print(){this.getViewsDataURL((t=>{let e=[],i=0;for(var n=0;n<t.length;++n){let s=new Image;s.src=t[n],s.onload=()=>{if(e.push(s),i++,i==t.length){const i=window.open("","","width="+e[0].width+",height="+e[0].height*t.length+",location=no,menubar=no,scrollbars=yes,status=no,toolbar=no");ot(i,this.translator.getTranslation("misc","popup_blocker_alert")),i.document.title="Print Image";for(var n=0;n<e.length;++n)i.document.body.append(e[n]);setTimeout((()=>{i.print()}),1e3)}}}}))}getUsedFonts(){let t=[],e=[];return this.getElements(-1,"all",!1).forEach((i=>{if("text"===i.getType()&&-1===t.indexOf(i.fontFamily)){var n={name:i.fontFamily},s=this.mainOptions.fonts.find((t=>t.name==i.fontFamily));s&&(s.url&&(n.url=s.url),s.variants&&Object.keys(s.variants).forEach((n=>{var r=i.fontFamily;"n7"==n?r+=" Bold":"i4"==n?r+=" Italic":"i7"==n&&(r+=" Bold Italic"),t.push(r),e.push({name:r,url:s.variants[n]})}))),t.push(i.fontFamily),e.push(n)}})),e}getViewsSVG(t){let e=[];for(var i=0;i<this.viewInstances.length;++i)e.push(this.viewInstances[i].toSVG(t,this.getUsedFonts()));return e}getUsedColors(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;var e=[];return this.getElements(t,"all",!1).forEach((t=>{const i=t.isColorizable();i&&("svg"===i&&"group"===t.type?t.getObjects().forEach((t=>{o(t.fill).isValid()&&e.push(o(t.fill).toHexString())})):o(t.fill).isValid()&&e.push(o(t.fill).toHexString()))})),U(e)}removeView(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.viewInstances[t].fabricCanvas.wrapperEl.remove(),this.viewInstances.splice(t,1),this.viewInstances.length>0&&(t==this.currentViewIndex?this.selectView(0):this.selectView(t)),q(this,"viewRemove",{viewIndex:t}),this.calculatePrice()}setOrderQuantity(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t=""==t||t<0?1:t,this.orderQuantity=t,this.calculatePrice()}getOrder(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._order.product=this.getProduct(t.onlyEditableElements,t.customizationRequired),this._order.usedFonts=this.getUsedFonts(),this._order.usedColors=[],this.getUsedColors().forEach((t=>{let e=this.mainOptions.hexNames[t.replace("#","").toLowerCase()],i={hex:t};e&&(i.name=e),this._order.usedColors.push(i)})),q(this,"getOrder",{}),this._order}getPrintOrderData(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e={used_fonts:this.getUsedFonts(),svg_data:[],custom_images:[]};return t&&this.viewInstances.forEach((t=>{e.svg_data.push({svg:t.toSVG({respectPrintingBox:!0}),output:t.options.output})})),this.getCustomElements("image").forEach((t=>{e.custom_images.includes(t.element.source)||e.custom_images.push(t.element.source)})),e}calculatePrice(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Io(this,Ho,Ko).call(this);let i=this.singleProductPrice;return this.currentPrice=i,i+=this.pricingRulesPrice,t&&(i*=this.orderQuantity),i%1!=0&&(i=Number(i.toFixed(2))),this.currentPrice=i,e&&q(this,"priceChange"),this.currentPrice}formatPrice(t){return ht(t,this.mainOptions.priceFormat)}getFileServerURL(){let t=new URL(this.mainOptions.fileServerURL);if("engraving"==W(this.viewInstances[0].options,"industry.type")){W(this.viewInstances[0].options,"industry.opts.negative")?t.searchParams.set("filter","threshold_negative"):t.searchParams.set("filter","threshold");const e=W(this.viewInstances[0].options,"industry.opts");N(e)&&Object.keys(e).forEach((i=>{t.searchParams.set(i,e[i])}))}return t.href}}function Wo(){Lt(this,(t=>{this.mainOptions.fonts=t,setTimeout((()=>{this.uiManager=new go(this),this.uiManager.addEventListener("ready",Io(this,Po,Vo).bind(this)),this.uiManager.init()}),1)}))}function Vo(){q(this,"ready",{}),this.warningsWrapper=this.container.querySelector(".fpd-warnings"),this.mainOptions.productsJSON&&("object"==typeof this.mainOptions.productsJSON?this.setupProducts(this.mainOptions.productsJSON):Vt({url:this.mainOptions.productsJSON,onSuccess:t=>{this.setupProducts(t)},onError:()=>{alert("Products JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.productsJSON)}})),this.mainOptions.designsJSON&&("object"==typeof this.mainOptions.designsJSON?this.setupDesigns(this.mainOptions.designsJSON):Vt({url:this.mainOptions.designsJSON,onSuccess:t=>{this.setupDesigns(t)},onError:()=>{alert("Design JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.designsJSON)}})),this.mainOptions.keyboardControl&&G(document,"keydown",(t=>{if(this.currentViewInstance&&this.currentViewInstance.fabricCanvas){const e=this.currentViewInstance,i=t.target.nodeName,n=e.fabricCanvas.getActiveObject();if(n&&!["TEXTAREA","INPUT"].includes(i)){switch(t.which){case 8:n.removable&&e.fabricCanvas.removeElement(n);break;case 37:n.draggable&&e.fabricCanvas.setElementOptions({left:n.left-1});break;case 38:n.draggable&&e.fabricCanvas.setElementOptions({top:n.top-1});break;case 39:n.draggable&&e.fabricCanvas.setElementOptions({left:n.left+1});break;case 40:n.draggable&&e.fabricCanvas.setElementOptions({top:n.top+1});break;default:return}t.preventDefault()}}})),this.mainOptions.watermark&&fabric.Image.fromURL(this.mainOptions.watermark,((t,e)=>{e||(this.watermarkImg=t)}),{crossOrigin:"anonymous"}),this.mainOptions.unsavedProductAlert&&(window.onbeforeunload=()=>{if(this.doUnsavedAlert)return""});let t=0;if(window.addEventListener("resize",(e=>{window.innerWidth===t||this.inTextField||(t=window.innerWidth,this.currentElement&&!["INPUT","TEXTAREA"].includes(document.activeElement)&&this.deselectElement(),this.currentViewInstance&&setTimeout((()=>{this.currentViewInstance.fabricCanvas.resetSize()}),100))})),G(this,["productCreate","layoutElementsAdded"],Io(this,_o,Uo).bind(this)),G(this,["productCreate","modalDesignerOpen"],(t=>{(!this.firstProductCreated&&!this.mainOptions.modalMode||!this.firstProductCreated&&"modalDesignerOpen"===t.type)&&(this.mainOptions.autoOpenInfo&&this.actionsBar&&this.actionsBar.doAction("info"),this.guidedTour&&(K()?"yes"!==window.localStorage.getItem("fpd-gt-closed")&&this.guidedTour.start():this.guidedTour.start())),this.firstProductCreated=this.mainOptions.modalMode&&"modalDesignerOpen"===t.type})),G(document.body,["focusin","blur"],(t=>{["TEXTAREA","INPUT"].includes(t.target.nodeName)&&(this.inTextField="focusin"==t.type)}),!0),G(document.body,["mouseup","touchend"],(t=>{let e=Array.from(document.querySelectorAll(".fpd-container"));!Boolean(e.find((e=>e.contains(t.target))))&&this.mainOptions.deselectActiveOnOutside&&this.deselectElement()}),!0),this.mainOptions.dragDropImagesToUploadZones){let t=null;G(document.body,["mousedown","touchstart"],(e=>{if(1==e.which){const i=e.target;i.classList.contains("fpd-draggable")&&(t=i,this.draggedPlaceholder=document.createElement("div"),this.draggedPlaceholder.className="fpd-dragged-image fpd-shadow-1 fpd-hidden",this.draggedPlaceholder.style.backgroundImage=`url("${i.querySelector("picture").dataset.img}")`,document.body.append(this.draggedPlaceholder))}})),G(document.body,["mousemove"],(e=>{this.draggedPlaceholder&&(this.draggedPlaceholder.style.left=e.pageX-.5*t.offsetWidth+"px",this.draggedPlaceholder.style.top=e.pageY-.5*t.offsetHeight+"px",Z(this.draggedPlaceholder,["fpd-hidden"]),setTimeout((()=>{this.draggedPlaceholder&&X(this.draggedPlaceholder,["fpd-animate"])}),1),e.stopPropagation(),e.preventDefault())})),G(document.body,["mouseup"],(e=>{this.draggedPlaceholder&&(this.draggedPlaceholder.remove(),this.draggedPlaceholder=null),!this.loadingCustomImage&&t&&this.mouseOverCanvas&&this._addGridItemToCanvas(t,this.mouseOverCanvas.uploadZone?{_addToUZ:this.mouseOverCanvas.title}:{}),t=null,this.mouseOverCanvas=!1}))}"string"==typeof this.mainOptions.editorMode&&new yo(this)}function Uo(){const t=this.globalCustomElements.concat(this.fixedElements);if(!t.length)return;let e=0;const i=t=>{const e=this.viewInstances[t.viewIndex];if(e){const i=t.element;if(!e.fabricCanvas.getElementByTitle(i.title)){let t=Object.keys(this.mainOptions.elementParameters);t="text"===i.getType()?t.concat(Object.keys(this.mainOptions.textParameters)):t.concat(Object.keys(this.mainOptions.imageParameters));let n=i.getElementJSON(!1,t);n._printingBox&&delete n.boundingBox,e.fabricCanvas.addElement(i.getType(),i.source,i.title,n)}}else n()},n=()=>{e++,e<t.length?i(t[e]):this.removeEventListener("elementAdd",n)};G(this,"elementAdd",n),t[0]&&i(t[0])}function Yo(t){var e=this.products.findIndex((e=>e.category===t));return-1!==e&&e}function Go(){if(this.viewInstances.length<this.productViews.length)this.addView(this.productViews[this.viewInstances.length]);else{this.removeEventListener("viewCreate",Io(this,Lo,Go)),this.toggleSpinner(!1),this.selectView(0),!this.mainOptions.editorMode&&this.currentViewInstance&&this.currentViewInstance.fabricCanvas.wrapperEl.offsetParent&&this.doAutoSelect(),this.productCreated=!0;const t=this.productViews[0].options.layouts;"string"==typeof t?Vt({url:t,onSuccess:t=>{this.currentLayouts=t,q(this,"layoutsSet",{})},onError:()=>{alert("Layouts JSON could not be loaded. Please check that your URL is correct! URL: "+this.mainOptions.layouts)}}):Array.isArray(t)&&(this.currentLayouts=t,q(this,"layoutsSet",{})),q(this,"productCreate")}}function qo(t){["undo","redo"].includes(t)&&this.currentViewInstance.fabricCanvas._renderPrintingBox(),q(this,"historyAction",{type:t}),Io(this,jo,Xo).call(this)}function Xo(){if(this.currentViewInstance){const t=this.currentViewInstance.fabricCanvas.historyUndo,e=this.currentViewInstance.fabricCanvas.historyRedo;t.length&&(this.doUnsavedAlert=!0),t&&(J(document.body.querySelectorAll('.fpd-btn[data-action="undo"]'),["fpd-disabled"],0==t.length),J(document.body.querySelectorAll('.fpd-btn[data-action="redo"]'),["fpd-disabled"],0==e.length))}}function Zo(t){t.fabricCanvas.wrapperEl.parentNode&&(this.viewInstances.push(t),t.fabricCanvas.on("sizeUpdate",(t=>{let{canvasHeight:e}=t,i=e+"px";this.productStage.style.height=i,this.container.classList.contains("fpd-sidebar")&&(this.mainBar.container.style.height=i,e!=this.mainWrapper.container.offsetHeight&&(this.mainBar.container.style.height=this.mainWrapper.container.offsetHeight+"px"))})),t.names_numbers&&t.names_numbers.length>1&&t.changePrice((t.names_numbers.length-1)*t.options.namesNumbersEntryPrice,"+"),q(this,"viewCreate",{viewInstance:t}),t.fabricCanvas.onHistory(),t.fabricCanvas.clearHistory())}function Jo(){if(!this.mainTooltip)return;const t=this.currentElement;if(this.productCreated&&t&&!t.uploadZone&&!t.__editorMode){if(t.isOut&&"inside"===t.boundingBoxMode){const t=this.translator.getTranslation("misc","out_of_bounding_box","Move element inside the boundary!");this.mainTooltip.innerHTML=t,this.mainTooltip.classList.add("fpd-show")}else if(this.mainOptions.sizeTooltip){const e=this.calcDisplaySize(t);let i=e.width+"x"+e.height+e.unit;e.dpi&&(i+=" | DPI:"+e.dpi),this.mainTooltip.innerHTML=i,this.mainTooltip.classList.add("fpd-show")}else this.mainTooltip.classList.remove("fpd-show");if(this.mainTooltip.classList.contains("fpd-show")){const e=t.oCoords,i=this.currentViewInstance.fabricCanvas.wrapperEl.getBoundingClientRect();let n=i.left+e.mt.x-this.mainTooltip.clientWidth/2,s=i.top+e.mt.y-this.mainTooltip.clientHeight-20;const r=this.container.getBoundingClientRect();s<r.top&&(s=r.top-this.mainTooltip.clientHeight),s=s<0?0:s,this.mainTooltip.style.left=n+"px",this.mainTooltip.style.top=s+"px"}}else this.mainTooltip.classList.remove("fpd-show")}function Qo(){if(!this.warningsWrapper||this.mainOptions.editorMode)return;this.warningsWrapper.innerHTML="";const t=this.currentElement;if(this.productCreated&&t){const e=this.calcElementDPI(t);if(t.isCustomImage&&null!==e&&e<this.mainOptions.customImageParameters.minDPI){const i=document.createElement("div");if(i.className="fpd-size-warning",i.innerHTML="<span>"+this.translator.getTranslation("misc","dpi_warning","Low resolution!")+"</span>",this.warningsWrapper.append(i),this.mainOptions.aiService.serverURL&&this.mainOptions.aiService.superRes){const e=document.createElement("span");e.className="fpd-btn",e.innerText=this.translator.getTranslation("misc","ai_upscale_btn"),i.append(e),G(e,"click",(e=>{const i=this.calcDisplaySize(t),s="mm"==i.unit?25.4:2.54;let r=parseInt(this.mainOptions.customImageParameters.minDPI*i.width/s)/t.width;r=Math.ceil(r),r=r>4?4:r,console.log("AI SuperRes - Scale:",r),this.deselectElement(),this.toggleSpinner(!0,this.translator.getTranslation("misc","loading_image")),Ut({url:this.mainOptions.aiService.serverURL,body:{service:"superRes",image:t.source,scale:r},onSuccess:e=>{if(e&&e.new_image){let i=t.getScaledWidth();t.setSrc(e.new_image,(()=>{t.source=e.new_image,t.scaleToWidth(i),t.scaleToWidth(i),t.canvas.renderAll(),n(this.translator.getTranslation("misc","ai_upscale_success")),q(this,"elementModify",{options:{scaleX:t.scaleX},element:t})}),{crossOrigin:"anonymous"})}else this.aiRequestError(e.error);this.toggleSpinner(!1)},onError:this.aiRequestError.bind(this)})}))}q(this,"imageDPIWarningOn",{element:t,dpi:e})}else q(this,"imageDPIWarningOff",{element:t,dpi:e})}}function Ko(){this.currentPrice=this.singleProductPrice=0,this.viewInstances.forEach((t=>{t.locked||(this.singleProductPrice+=t.truePrice)}))}So(zo,"version","6.3.6"),So(zo,"forbiddenTextChars",/<|>/g),So(zo,"proxyFileServer",""),So(zo,"uploadsToServer",!0),So(zo,"additionalModules",{}),window.FancyProductDesigner=zo,window.FPDEmojisRegex=/(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F/g})()})();
/*!
 * vanilla-picker v2.12.2
 * https://vanilla-picker.js.org
 *
 * Copyright 2017-2023 Andreas Borgen (https://github.com/Sphinxxxx), Adam Brooks (https://github.com/dissimulate)
 * Released under the ISC license.
 */

/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */
